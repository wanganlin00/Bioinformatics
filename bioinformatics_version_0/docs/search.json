[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bioinformatics",
    "section": "",
    "text": "参考资料\n\nOrchestrating Single-Cell Analysis with Bioconductor\nSeurat\nDESeq2\nclusterProfiler、Disease Ontology Semantic and Enrichment analysis\nmonocle2\nhttps://cole-trapnell-lab.github.io/monocle3/\n系统发育树",
    "crumbs": [
      "参考资料"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html",
    "href": "DEGs_Analysis.html",
    "title": "\n5  差异表达基因分析\n",
    "section": "",
    "text": "5.1 数据\n肺腺癌\nLung Adenocarcinoma (LUAD) gene expression RNAseq HTSeq - Counts （n=585） GDC 中心 和Phenotype (n=877)",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#assays",
    "href": "DEGs_Analysis.html#assays",
    "title": "\n5  差异表达基因分析\n",
    "section": "\n5.2 Assays",
    "text": "5.2 Assays\n\n5.2.1 对数计数矩阵\n\nCodelibrary(arrow, warn.conflicts = FALSE)\nlogCount &lt;- read_tsv_arrow(\"data/TCGA-LUAD.htseq_counts.tsv.gz\")\n# 读取计数矩阵 log2(count+1)  # 60488 个gene ×  586 个sample\n\n\nlogCount[1:6,1:3]\n\n\n\n\nEnsembl_ID\nTCGA-97-7938-01A\nTCGA-55-7574-01A\n\n\n\nENSG00000000003.13\n10.989394\n9.967226\n\n\nENSG00000000005.5\n4.000000\n0.000000\n\n\nENSG00000000419.11\n10.253847\n9.541097\n\n\nENSG00000000457.12\n9.776433\n9.131857\n\n\nENSG00000000460.15\n7.971544\n8.348728\n\n\nENSG00000000938.11\n8.724514\n9.703904\n\n\n\n\n\n\n\n5.2.2 基因编码文件\n我想要分析总的转录本，不需要把mRNA、lncRNA等挑出来，所以下载的这个自带注释文件ID/Gene Mapping\n\nCodegtf_v22_transcripts &lt;- read_delim(\"data/gencode.v22.annotation.gene.probeMap\")\n\n\n如果只想用蛋白质编码（protein_coding）相关基因，用全基因编码注释文件 gencode.v46.annotation.gtf.gz\n\nCode# 全基因编码  BiocManager::install(\"rtracklayer\")\ngtf_v22 &lt;- rtracklayer::import('data/gencode.v22.annotation.gtf.gz') |&gt;\n as_tibble()\n\ndistinct(gtf_v22,gene_type)\ndistinct(gtf_v22,gene_name)\n\n# 选择 蛋白编码mRNA相关基因\ngtf_v22_mRNA &lt;- dplyr::select(gtf_v22,\n                              c(\"gene_id\",\"gene_type\", \"gene_name\"))|&gt; \n    dplyr::filter(gene_type == \"protein_coding\") |&gt;  \n    distinct()\n\nhead(gtf_v22_mRNA )\nwrite.csv(gtf_v22_mRNA,\"data/gtf_v22_mRNA.csv\")\n\n\n\n5.2.3 根据 ENSEBML 编码内连接\n\nCodegene_logCount &lt;- logCount |&gt; \n  inner_join(gtf_v22_transcripts, by = c(\"Ensembl_ID\" = \"id\")) |&gt; \n  dplyr::select(gene, starts_with(\"TCGA\") )\n\n\n\nCodedim(gene_logCount)\n#&gt; [1] 60483   586\ngene_logCount[1:6,1:3]\n\n\n\n\ngene\nTCGA-97-7938-01A\nTCGA-55-7574-01A\n\n\n\nTSPAN6\n10.989394\n9.967226\n\n\nTNMD\n4.000000\n0.000000\n\n\nDPM1\n10.253847\n9.541097\n\n\nSCYL3\n9.776433\n9.131857\n\n\nC1orf112\n7.971544\n8.348728\n\n\nFGR\n8.724514\n9.703904\n\n\n\n\n\n\n\n5.2.4 还原原始数据\n先去对数 log2(count+1)\n\nCodelibrary(Rcpp)\nRcpp::sourceCpp(\"data/exponential_base2_transform.cpp\")\n\n# 该函数将 `log2(count + 1)` 转换为原始计数\ngene_Count &lt;- gene_logCount %&gt;%\n  mutate_if(is.numeric, ~ exponential_base2_transform(.))\n\n\n基因名是有重复的，查看重复情况\n\nCodegene_Count |&gt; distinct(gene) |&gt; dim()\n#&gt; [1] 58387     1\nrepeat_n &lt;- gene_Count |&gt; summarise(n=n(),.by = gene) |&gt; ungroup() |&gt; \n  summarise(重复n次的基因个数=n(),.by =n ) |&gt; arrange(n)\n# 唯一基因个数\nsum(repeat_n$重复n次的基因个数)\n#&gt; [1] 58387\n\n\n根据基因名分组，重复则取平均值去重，去掉重复的行\n\nCodelibrary(data.table)\nsetDT(gene_Count)\nCounts &lt;- gene_Count[,lapply(.SD,mean),by=gene, .SDcols=patterns(\"^(TCGA)\")]\n\n\n\nCodeCounts &lt;- Counts |&gt; column_to_rownames(\"gene\")\ndim(Counts)\n#&gt; [1] 58387   585\n\n\n\n\n\n\n\n\n\nCodedf &lt;- tibble(\n    g=c('A','B','A','C','C'),\n    x=c(1:5),\n    y=c(3:7),\n    \n)\ndf\n\n\n\n\ng\nx\ny\n\n\n\nA\n1\n3\n\n\nB\n2\n4\n\n\nA\n3\n5\n\n\nC\n4\n6\n\n\nC\n5\n7\n\n\n\n\n\nCode# 数据多太慢了\ndf|&gt; group_by(g) |&gt; summarise_all(list(mean))\n\n\n\n\ng\nx\ny\n\n\n\nA\n2.0\n4.0\n\n\nB\n2.0\n4.0\n\n\nC\n4.5\n6.5\n\n\n\n\n\nCode\n\n# 转化成data.table\n# library(data.table) 非常快\n\nsetDT(df)\n# 对基因g进行分组，并对x和y列计算均值\ndf[, lapply(.SD, mean), by = g, .SDcols = patterns(\"x|y\")]\n\n\n\n\ng\nx\ny\n\n\n\nA\n2.0\n4.0\n\n\nB\n2.0\n4.0\n\n\nC\n4.5\n6.5\n\n\n\n\n\n\n\n\n\n提取lncRNA、miRNA等也是类似的操作",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#sample-metadata",
    "href": "DEGs_Analysis.html#sample-metadata",
    "title": "\n5  差异表达基因分析\n",
    "section": "\n5.3 Sample metadata",
    "text": "5.3 Sample metadata\n\n5.3.1 表型注释文件\n\nCode#首先载入下载好胆管癌的样本信息文件\n# 877 个sample × 125 个样本变量\nlibrary(data.table)\ncolData &lt;- fread(\"data/TCGA-LUAD.GDC_phenotype.tsv.gz\", sep = \"\\t\", header = TRUE)\n\n\n# 选择样本  放疗与kras基因\ntable(colData$radiation_therapy,colData$kras_mutation_found)\n#&gt;      \n#&gt;            NO YES\n#&gt;       230   1   3\n#&gt;   NO  491  41  24\n#&gt;   YES  72  11   4\n\npf &lt;- colData |&gt; dplyr::filter(kras_mutation_found!= \"\") |&gt; \n  dplyr::filter(radiation_therapy!= \"\") |&gt; \n  dplyr::select(submitter_id.samples,submitter_id,radiation_therapy,kras_mutation_found)\n\n\nxtabs(formula = ~radiation_therapy+kras_mutation_found,data = pf,subset = NULL)\n#&gt;                  kras_mutation_found\n#&gt; radiation_therapy NO YES\n#&gt;               NO  41  24\n#&gt;               YES 11   4\n\n\n到这里，就从877个样本中挑出了80个样本，但是，我们只要这80个样本中成对样本的表达数据，即同一个病人既有癌旁正常细胞的表达蛋白，又有肿瘤细胞的异常表达蛋白。\n\n5.3.2 colData的成对样本\n\nCodeID &lt;- pf$submitter_id  # 前1~12字符\n\n\n# 21对配对样本\ntable(ID)[table(ID)==2] |&gt; length()\n#&gt; [1] 21\n\nPairedSample &lt;- pf |&gt; summarise(n=n(),.by = \"submitter_id\")|&gt; dplyr::filter(n==2)\nPairedSample \n\n\n\n\nsubmitter_id\nn\n\n\n\nTCGA-50-8457\n2\n\n\nTCGA-55-7913\n2\n\n\nTCGA-55-8089\n2\n\n\nTCGA-44-6148\n2\n\n\nTCGA-50-6593\n2\n\n\nTCGA-99-8028\n2\n\n\nTCGA-50-8459\n2\n\n\nTCGA-50-6594\n2\n\n\nTCGA-50-5936\n2\n\n\nTCGA-55-8205\n2\n\n\nTCGA-49-6744\n2\n\n\nTCGA-50-8460\n2\n\n\nTCGA-49-6742\n2\n\n\nTCGA-99-8033\n2\n\n\nTCGA-49-6745\n2\n\n\nTCGA-91-6848\n2\n\n\nTCGA-50-5066\n2\n\n\nTCGA-50-5935\n2\n\n\nTCGA-J2-8192\n2\n\n\nTCGA-44-6145\n2\n\n\nTCGA-55-7914\n2\n\n\n\n\n\nCodesample &lt;-  left_join(PairedSample,pf,by=join_by(\"submitter_id\"))\nsample\n\n\n\n\n\n\n\n\n\n\n\nsubmitter_id\nn\nsubmitter_id.samples\nradiation_therapy\nkras_mutation_found\n\n\n\nTCGA-50-8457\n2\nTCGA-50-8457-01A\nNO\nYES\n\n\nTCGA-50-8457\n2\nTCGA-50-8457-11A\nNO\nYES\n\n\nTCGA-55-7913\n2\nTCGA-55-7913-01B\nNO\nNO\n\n\nTCGA-55-7913\n2\nTCGA-55-7913-11A\nNO\nNO\n\n\nTCGA-55-8089\n2\nTCGA-55-8089-01A\nNO\nNO\n\n\nTCGA-55-8089\n2\nTCGA-55-8089-11A\nNO\nNO\n\n\nTCGA-44-6148\n2\nTCGA-44-6148-01A\nNO\nNO\n\n\nTCGA-44-6148\n2\nTCGA-44-6148-11A\nNO\nNO\n\n\nTCGA-50-6593\n2\nTCGA-50-6593-01A\nYES\nNO\n\n\nTCGA-50-6593\n2\nTCGA-50-6593-11A\nYES\nNO\n\n\nTCGA-99-8028\n2\nTCGA-99-8028-01A\nNO\nYES\n\n\nTCGA-99-8028\n2\nTCGA-99-8028-11A\nNO\nYES\n\n\nTCGA-50-8459\n2\nTCGA-50-8459-01A\nNO\nYES\n\n\nTCGA-50-8459\n2\nTCGA-50-8459-11A\nNO\nYES\n\n\nTCGA-50-6594\n2\nTCGA-50-6594-01A\nNO\nNO\n\n\nTCGA-50-6594\n2\nTCGA-50-6594-11A\nNO\nNO\n\n\nTCGA-50-5936\n2\nTCGA-50-5936-01A\nNO\nYES\n\n\nTCGA-50-5936\n2\nTCGA-50-5936-11A\nNO\nYES\n\n\nTCGA-55-8205\n2\nTCGA-55-8205-01A\nNO\nNO\n\n\nTCGA-55-8205\n2\nTCGA-55-8205-11A\nNO\nNO\n\n\nTCGA-49-6744\n2\nTCGA-49-6744-01A\nNO\nYES\n\n\nTCGA-49-6744\n2\nTCGA-49-6744-11A\nNO\nYES\n\n\nTCGA-50-8460\n2\nTCGA-50-8460-01A\nYES\nNO\n\n\nTCGA-50-8460\n2\nTCGA-50-8460-11A\nYES\nNO\n\n\nTCGA-49-6742\n2\nTCGA-49-6742-01A\nNO\nNO\n\n\nTCGA-49-6742\n2\nTCGA-49-6742-11A\nNO\nNO\n\n\nTCGA-99-8033\n2\nTCGA-99-8033-01A\nYES\nNO\n\n\nTCGA-99-8033\n2\nTCGA-99-8033-11A\nYES\nNO\n\n\nTCGA-49-6745\n2\nTCGA-49-6745-01A\nNO\nNO\n\n\nTCGA-49-6745\n2\nTCGA-49-6745-11A\nNO\nNO\n\n\nTCGA-91-6848\n2\nTCGA-91-6848-01A\nNO\nNO\n\n\nTCGA-91-6848\n2\nTCGA-91-6848-11A\nNO\nNO\n\n\nTCGA-50-5066\n2\nTCGA-50-5066-01A\nNO\nNO\n\n\nTCGA-50-5066\n2\nTCGA-50-5066-02A\nNO\nNO\n\n\nTCGA-50-5935\n2\nTCGA-50-5935-01A\nYES\nYES\n\n\nTCGA-50-5935\n2\nTCGA-50-5935-11A\nYES\nYES\n\n\nTCGA-J2-8192\n2\nTCGA-J2-8192-01A\nNO\nNO\n\n\nTCGA-J2-8192\n2\nTCGA-J2-8192-11A\nNO\nNO\n\n\nTCGA-44-6145\n2\nTCGA-44-6145-01A\nNO\nNO\n\n\nTCGA-44-6145\n2\nTCGA-44-6145-11A\nNO\nNO\n\n\nTCGA-55-7914\n2\nTCGA-55-7914-01A\nNO\nYES\n\n\nTCGA-55-7914\n2\nTCGA-55-7914-11A\nNO\nYES\n\n\n\n\n\nCodetable(sample$radiation_therapy,sample$kras_mutation_found)\n#&gt;      \n#&gt;       NO YES\n#&gt;   NO  22  12\n#&gt;   YES  6   2\n\n\n\n5.3.3 匹配 assays的成对样本\n并且colData 中出现的成对样本（21对）要匹配到assays 中的成对样本（60对）。（取交集）\n\nCode# 表达矩阵  \npatient_of_counts &lt;- str_sub(colnames(Counts),1,12)\n\n\npaired_patient &lt;- table(patient_of_counts)[table(patient_of_counts)==2]|&gt; \n names()  # 筛选出60对成对数据\npaired_patient |&gt; length()\n#&gt; [1] 60\n\n\n取sample和paired_patient的交集，有8对成对数据\n\nCode# 取交集\nfinal_sample &lt;- lubridate::intersect(sample$submitter_id,paired_patient)\nfinal_sample\n#&gt; [1] \"TCGA-44-6148\" \"TCGA-50-5936\" \"TCGA-49-6744\" \"TCGA-49-6742\" \"TCGA-49-6745\"\n#&gt; [6] \"TCGA-50-5066\" \"TCGA-50-5935\" \"TCGA-44-6145\"\n\nsample &lt;- sample |&gt;\n  dplyr::filter(sample$submitter_id %in% final_sample) |&gt;\n  dplyr::select(-submitter_id, -n) |&gt;\n  dplyr::rename(\"sample_id\" = \"submitter_id.samples\") |&gt;\n  arrange(sample_id)\n\nsample\n\n\n\n\nsample_id\nradiation_therapy\nkras_mutation_found\n\n\n\nTCGA-44-6145-01A\nNO\nNO\n\n\nTCGA-44-6145-11A\nNO\nNO\n\n\nTCGA-44-6148-01A\nNO\nNO\n\n\nTCGA-44-6148-11A\nNO\nNO\n\n\nTCGA-49-6742-01A\nNO\nNO\n\n\nTCGA-49-6742-11A\nNO\nNO\n\n\nTCGA-49-6744-01A\nNO\nYES\n\n\nTCGA-49-6744-11A\nNO\nYES\n\n\nTCGA-49-6745-01A\nNO\nNO\n\n\nTCGA-49-6745-11A\nNO\nNO\n\n\nTCGA-50-5066-01A\nNO\nNO\n\n\nTCGA-50-5066-02A\nNO\nNO\n\n\nTCGA-50-5935-01A\nYES\nYES\n\n\nTCGA-50-5935-11A\nYES\nYES\n\n\nTCGA-50-5936-01A\nNO\nYES\n\n\nTCGA-50-5936-11A\nNO\nYES\n\n\n\n\n\nCodetable(sample$radiation_therapy,sample$kras_mutation_found)\n#&gt;      \n#&gt;       NO YES\n#&gt;   NO  10   4\n#&gt;   YES  0   2\n\n\n\n\n# 最后的表达矩阵\nexprCounts &lt;- Counts  |&gt; dplyr::select(which(colnames(Counts) %in% sample$sample_id)) \n\nexprCounts &lt;- dplyr::select(exprCounts,order(colnames(exprCounts)))\ncolnames(exprCounts)\n#&gt;  [1] \"TCGA-44-6145-01A\" \"TCGA-44-6145-11A\" \"TCGA-44-6148-01A\" \"TCGA-44-6148-11A\"\n#&gt;  [5] \"TCGA-49-6742-01A\" \"TCGA-49-6742-11A\" \"TCGA-49-6744-01A\" \"TCGA-49-6744-11A\"\n#&gt;  [9] \"TCGA-49-6745-01A\" \"TCGA-49-6745-11A\" \"TCGA-50-5066-01A\" \"TCGA-50-5066-02A\"\n#&gt; [13] \"TCGA-50-5935-01A\" \"TCGA-50-5935-11A\" \"TCGA-50-5936-01A\" \"TCGA-50-5936-11A\"\ndim(exprCounts)\n#&gt; [1] 58387    16\n\n# 去除所有样本都不表达的基因\nexprCounts &lt;- exprCounts |&gt;\n    mutate(rowsum = apply(exprCounts,1,sum)) |&gt;\n    dplyr::filter(rowsum!=0) |&gt; \n    dplyr::select(-rowsum)\n\ndim(exprCounts)\n#&gt; [1] 46488    16\n\n\n\nCode# 检查计数矩阵和列数据，看看它们在样本顺序方面是否一致。\ncolnames(exprCounts)\n#&gt;  [1] \"TCGA-44-6145-01A\" \"TCGA-44-6145-11A\" \"TCGA-44-6148-01A\" \"TCGA-44-6148-11A\"\n#&gt;  [5] \"TCGA-49-6742-01A\" \"TCGA-49-6742-11A\" \"TCGA-49-6744-01A\" \"TCGA-49-6744-11A\"\n#&gt;  [9] \"TCGA-49-6745-01A\" \"TCGA-49-6745-11A\" \"TCGA-50-5066-01A\" \"TCGA-50-5066-02A\"\n#&gt; [13] \"TCGA-50-5935-01A\" \"TCGA-50-5935-11A\" \"TCGA-50-5936-01A\" \"TCGA-50-5936-11A\"\nsample$sample_id\n#&gt;  [1] \"TCGA-44-6145-01A\" \"TCGA-44-6145-11A\" \"TCGA-44-6148-01A\" \"TCGA-44-6148-11A\"\n#&gt;  [5] \"TCGA-49-6742-01A\" \"TCGA-49-6742-11A\" \"TCGA-49-6744-01A\" \"TCGA-49-6744-11A\"\n#&gt;  [9] \"TCGA-49-6745-01A\" \"TCGA-49-6745-11A\" \"TCGA-50-5066-01A\" \"TCGA-50-5066-02A\"\n#&gt; [13] \"TCGA-50-5935-01A\" \"TCGA-50-5935-11A\" \"TCGA-50-5936-01A\" \"TCGA-50-5936-11A\"\n\nall(sample$sample_id%in% colnames(exprCounts))\n#&gt; [1] TRUE\nall(sample$SampleID == colnames(exprCounts))\n#&gt; [1] TRUE",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#构造deg实例",
    "href": "DEGs_Analysis.html#构造deg实例",
    "title": "\n5  差异表达基因分析\n",
    "section": "\n5.4 构造DEG实例",
    "text": "5.4 构造DEG实例\n\nCodedim(exprCounts)\n#&gt; [1] 46488    16\ndim(sample)\n#&gt; [1] 16  3\nexprCounts &lt;- ceiling(exprCounts)\n\n\n根据TCGA样本的命名可以区分正常组织和肿瘤样本的测序结果 其中编号01-09表示肿瘤，10-19表示正常\n\nCode# 字符14~15，\nsample$condition &lt;- factor(\n ifelse(as.numeric(str_sub(sample$sample_id,14,15)) &lt; 10,'tumor','normal'),\n levels = c(\"normal\",\"tumor\"),\n ) \n\nsample &lt;- column_to_rownames(sample,var =\"sample_id\" )\nsample\n\n\n\n\n\nradiation_therapy\nkras_mutation_found\ncondition\n\n\n\nTCGA-44-6145-01A\nNO\nNO\ntumor\n\n\nTCGA-44-6145-11A\nNO\nNO\nnormal\n\n\nTCGA-44-6148-01A\nNO\nNO\ntumor\n\n\nTCGA-44-6148-11A\nNO\nNO\nnormal\n\n\nTCGA-49-6742-01A\nNO\nNO\ntumor\n\n\nTCGA-49-6742-11A\nNO\nNO\nnormal\n\n\nTCGA-49-6744-01A\nNO\nYES\ntumor\n\n\nTCGA-49-6744-11A\nNO\nYES\nnormal\n\n\nTCGA-49-6745-01A\nNO\nNO\ntumor\n\n\nTCGA-49-6745-11A\nNO\nNO\nnormal\n\n\nTCGA-50-5066-01A\nNO\nNO\ntumor\n\n\nTCGA-50-5066-02A\nNO\nNO\ntumor\n\n\nTCGA-50-5935-01A\nYES\nYES\ntumor\n\n\nTCGA-50-5935-11A\nYES\nYES\nnormal\n\n\nTCGA-50-5936-01A\nNO\nYES\ntumor\n\n\nTCGA-50-5936-11A\nNO\nYES\nnormal\n\n\n\n\n\n\n\nCodelibrary(DESeq2)\n\ndds &lt;- DESeqDataSetFromMatrix(countData = exprCounts,\n                              colData = sample,\n                              design = ~ condition)\ndds\n#&gt; class: DESeqDataSet \n#&gt; dim: 46488 16 \n#&gt; metadata(1): version\n#&gt; assays(1): counts\n#&gt; rownames(46488): TSPAN6 TNMD ... LINC01144 RP11-418H16.1\n#&gt; rowData names(0):\n#&gt; colnames(16): TCGA-44-6145-01A TCGA-44-6145-11A ... TCGA-50-5936-01A\n#&gt;   TCGA-50-5936-11A\n#&gt; colData names(3): radiation_therapy kras_mutation_found condition\n\n\n\n5.4.1 预过滤\n\nCodesmallestGroupSize &lt;- 8\n\nkeep &lt;- rowSums(counts(dds) &gt;= 10) &gt;= smallestGroupSize\ndds &lt;- dds[keep,]\ndds\n#&gt; class: DESeqDataSet \n#&gt; dim: 19562 16 \n#&gt; metadata(1): version\n#&gt; assays(1): counts\n#&gt; rownames(19562): TSPAN6 DPM1 ... RP11-274B21.13 LINC01144\n#&gt; rowData names(0):\n#&gt; colnames(16): TCGA-44-6145-01A TCGA-44-6145-11A ... TCGA-50-5936-01A\n#&gt;   TCGA-50-5936-11A\n#&gt; colData names(3): radiation_therapy kras_mutation_found condition\n\n\n\nCodedds$condition\n#&gt;  [1] tumor  normal tumor  normal tumor  normal tumor  normal tumor  normal\n#&gt; [11] tumor  tumor  tumor  normal tumor  normal\n#&gt; Levels: normal tumor\n\ndds@colData\n#&gt; DataFrame with 16 rows and 3 columns\n#&gt;                  radiation_therapy kras_mutation_found condition\n#&gt;                        &lt;character&gt;         &lt;character&gt;  &lt;factor&gt;\n#&gt; TCGA-44-6145-01A                NO                  NO    tumor \n#&gt; TCGA-44-6145-11A                NO                  NO    normal\n#&gt; TCGA-44-6148-01A                NO                  NO    tumor \n#&gt; TCGA-44-6148-11A                NO                  NO    normal\n#&gt; TCGA-49-6742-01A                NO                  NO    tumor \n#&gt; ...                            ...                 ...       ...\n#&gt; TCGA-50-5066-02A                NO                  NO    tumor \n#&gt; TCGA-50-5935-01A               YES                 YES    tumor \n#&gt; TCGA-50-5935-11A               YES                 YES    normal\n#&gt; TCGA-50-5936-01A                NO                 YES    tumor \n#&gt; TCGA-50-5936-11A                NO                 YES    normal\nhead(counts(dds)) #  19562   ×   16 \n#&gt;          TCGA-44-6145-01A TCGA-44-6145-11A TCGA-44-6148-01A TCGA-44-6148-11A\n#&gt; TSPAN6               1407              783             4794             3163\n#&gt; DPM1                 1293             1003              982             1158\n#&gt; SCYL3                 758              389              985              885\n#&gt; C1orf112              340               74              173              183\n#&gt; FGR                   747             3617              759             3076\n#&gt; CFH                  5718             2611            30270             8703\n#&gt;          TCGA-49-6742-01A TCGA-49-6742-11A TCGA-49-6744-01A TCGA-49-6744-11A\n#&gt; TSPAN6               3275             1696             2798             1360\n#&gt; DPM1                  922              986             1453              846\n#&gt; SCYL3                 838              498              808              514\n#&gt; C1orf112              261               95              271              119\n#&gt; FGR                   286             2126             1470             2712\n#&gt; CFH                  1574             5208             5880             3922\n#&gt;          TCGA-49-6745-01A TCGA-49-6745-11A TCGA-50-5066-01A TCGA-50-5066-02A\n#&gt; TSPAN6               2700             2194             3589             8759\n#&gt; DPM1                 1159             1584             2848             4398\n#&gt; SCYL3                 555              570              602             2118\n#&gt; C1orf112              386               98              483             1518\n#&gt; FGR                  1065             1631              541             1169\n#&gt; CFH                  6554             4153             2071             9081\n#&gt;          TCGA-50-5935-01A TCGA-50-5935-11A TCGA-50-5936-01A TCGA-50-5936-11A\n#&gt; TSPAN6               2199             1202             2537              725\n#&gt; DPM1                 1129              715              621              769\n#&gt; SCYL3                1349              441              556              553\n#&gt; C1orf112              386               60              346               80\n#&gt; FGR                   560             1831              519             3600\n#&gt; CFH                  1869             3667             4488             1881",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#差异分析",
    "href": "DEGs_Analysis.html#差异分析",
    "title": "\n5  差异表达基因分析\n",
    "section": "\n5.5 差异分析",
    "text": "5.5 差异分析\n\nCodedes &lt;- DESeq(dds)\n\nresults &lt;- results(\n  object = des,\n  contrast = c(\"condition\", \"tumor\", \"normal\"),\n  alpha = 0.05,\n  filter = rowMeans(counts(des, normalized = TRUE)),# 独立过滤\n  theta = c(0.025, 0.975),\n  pAdjustMethod = \"BH\",\n)\nmetadata(results)[\"alpha\"]\n#&gt; $alpha\n#&gt; [1] 0.05\n\nresults[1:6,]\n#&gt; log2 fold change (MLE): condition tumor vs normal \n#&gt; Wald test p-value: condition tumor vs normal \n#&gt; DataFrame with 6 rows and 6 columns\n#&gt;           baseMean log2FoldChange     lfcSE      stat      pvalue        padj\n#&gt;          &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;\n#&gt; TSPAN6    2491.784       1.009957  0.284407   3.55110 3.83631e-04 2.72195e-03\n#&gt; DPM1      1318.670       0.500631  0.336588   1.48737 1.36918e-01 2.72805e-01\n#&gt; SCYL3      734.633       0.605618  0.202489   2.99087 2.78184e-03 1.38997e-02\n#&gt; C1orf112   268.645       1.951846  0.287025   6.80026 1.04432e-11 7.96688e-10\n#&gt; FGR       1655.039      -1.947828  0.290586  -6.70310 2.04049e-11 1.44134e-09\n#&gt; CFH       5564.337       0.608888  0.464523   1.31078 1.89932e-01 3.45383e-01\nsummary(results)\n#&gt; \n#&gt; out of 19562 with nonzero total read count\n#&gt; adjusted p-value &lt; 0.05\n#&gt; LFC &gt; 0 (up)       : 3248, 17%\n#&gt; LFC &lt; 0 (down)     : 2160, 11%\n#&gt; outliers [1]       : 0, 0%\n#&gt; low counts [2]     : 490, 2.5%\n#&gt; (mean count &lt; 13)\n#&gt; [1] see 'cooksCutoff' argument of ?results\n#&gt; [2] see 'independentFiltering' argument of ?results\nsum(results$padj &lt; 0.05, na.rm=TRUE)\n#&gt; [1] 5408\n\n# 根据padj 升序\nresOrdered &lt;- results[order(results$padj),]\n\n\n\n5.5.1 保存结果\n保存csv以备热图、火山图、富集分析。\n\nCodex &lt;- as.data.frame(resOrdered) |&gt; rownames_to_column(var = \"gene\")\nwrite_csv(x, file=\"data/resOrdered.csv\")\n\n\n\nCodemcols(resOrdered)$description\n#&gt; [1] \"mean of normalized counts for all samples\"        \n#&gt; [2] \"log2 fold change (MLE): condition tumor vs normal\"\n#&gt; [3] \"standard error: condition tumor vs normal\"        \n#&gt; [4] \"Wald statistic: condition tumor vs normal\"        \n#&gt; [5] \"Wald test p-value: condition tumor vs normal\"     \n#&gt; [6] \"BH adjusted p-values\"\n\n\npvalue，是统计学检验变量，代表差异显著性，一般认为P &lt; 0.05 为显著， P &lt;0.01 为非常显著。其含义为：由抽样误差导致样本间差异的概率小于0.05 或0.01。\npadj，是对pvalue进行多重假设检验校正后的结果。转录组测序的差异表达分析是对大量的基因表达值进行的独立统计假设检验，存在假阳性（Family-Wise Error Rate，FWER），Bonferroni矫正\nqvalue，False Discovery Rate，FDR，所有假阳性结果占所有拒绝零假设结果的比例，假阳性结果的比例不超过预设的FDR水平（0.05/0.1）,基于pvalue的分布。多重假设检验校正方法：Benjamini-Hochberg，\nlog2FoldChange：对数倍数变化，1.5倍差异即0.585，2倍差异即1。\n\n\n\n\n\nCodeDEG &lt;- read_csv(\"data/resOrdered.csv\")\n\nDESeq2_DEG &lt;- na.omit(DEG) \nnrDEG &lt;- DESeq2_DEG\nnrDEG[1:25,]\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene\nbaseMean\nlog2FoldChange\nlfcSE\nstat\npvalue\npadj\n\n\n\nMGAT3\n1412.43862\n-4.320278\n0.2750470\n-15.707414\n0\n0\n\n\nRTKN2\n5130.81804\n-4.640307\n0.3175103\n-14.614667\n0\n0\n\n\nGPM6A\n1228.70589\n-5.145635\n0.3599700\n-14.294621\n0\n0\n\n\nSERTM1\n298.17214\n-6.886260\n0.5455626\n-12.622309\n0\n0\n\n\nLIMS2\n1926.05684\n-2.660279\n0.2146619\n-12.392878\n0\n0\n\n\nEMP2\n31710.06920\n-2.671839\n0.2229468\n-11.984199\n0\n0\n\n\nCNTN6\n352.36029\n-4.393899\n0.3796112\n-11.574736\n0\n0\n\n\nKANK3\n495.11283\n-2.848364\n0.2522794\n-11.290513\n0\n0\n\n\nRP1-78O14.1\n240.67218\n-4.394661\n0.3899644\n-11.269390\n0\n0\n\n\nGPM6B\n796.26123\n-2.528567\n0.2297754\n-11.004520\n0\n0\n\n\nWNT3A\n280.08606\n-5.270964\n0.4854622\n-10.857621\n0\n0\n\n\nPDLIM2\n1757.53896\n-2.207799\n0.2064731\n-10.692915\n0\n0\n\n\nITLN2\n655.86747\n-5.904468\n0.5588234\n-10.565893\n0\n0\n\n\nSLC6A13\n35.46976\n-3.659195\n0.3472796\n-10.536740\n0\n0\n\n\nGRK5\n2389.94916\n-2.795107\n0.2712779\n-10.303480\n0\n0\n\n\nEDNRB\n3236.38793\n-3.288481\n0.3211332\n-10.240242\n0\n0\n\n\nKCNN4\n1240.55071\n3.836884\n0.3783283\n10.141679\n0\n0\n\n\nCLIC5\n8327.11939\n-3.732657\n0.3685299\n-10.128505\n0\n0\n\n\nRASAL1\n261.44562\n4.538838\n0.4504928\n10.075272\n0\n0\n\n\nRP11-371A19.2\n54.44687\n-5.168047\n0.5162906\n-10.009957\n0\n0\n\n\nPTPN21\n2327.21817\n-2.527771\n0.2538084\n-9.959365\n0\n0\n\n\nCLEC3B\n2091.74017\n-4.223742\n0.4294719\n-9.834733\n0\n0\n\n\nCTD-2135D7.5\n38.21341\n-3.366170\n0.3434858\n-9.800029\n0\n0\n\n\nFAM83A\n2565.85011\n6.377845\n0.6514036\n9.790927\n0\n0\n\n\nPTPRH\n490.58361\n6.130422\n0.6281505\n9.759480\n0\n0\n\n\n\n\n\n\n\n5.5.2 热图\n\nCode\nlog2exprCounts &lt;- log2(counts(des)+1)\nlibrary(pheatmap)\n\npheatmap(log2exprCounts[(head(DESeq2_DEG$gene,n=25)) , ])\n\n\n\n\n\n\n\n\n5.5.3 配对图\n挑选指定第一个基因看它在同一个病人的配对表达情况\n\nCodelibrary(ggpubr)\n\ndf &lt;- tibble(\n  group = sample$condition,\n  patient = colnames(exprCounts),\n  expressionValue = as.numeric(exprCounts[DESeq2_DEG$gene[1],]),\n  )\n\nggpubr::ggpaired(df, x = \"group\", y = \"expressionValue\",color = \"group\", \n                 line.color = \"gray\", line.size = 0.4,palette = \"npg\")+\n    stat_compare_means()\n\n\n\n\n\n\n\n\n5.5.4 火山图\n\nCodenrDEG$group &lt;- factor(\n    if_else(nrDEG$padj&lt;0.05& abs(nrDEG$log2FoldChange)&gt;=1,\n            if_else(nrDEG$log2FoldChange&gt;=1,\"up\",\"down\"),\n            \"NS\",),\n    levels =c(\"up\",\"down\",\"NS\") )\ntable(nrDEG$group)\n#&gt; \n#&gt;    up  down    NS \n#&gt;  2073  1641 15358\n\ngene_labels &lt;- dplyr::filter(nrDEG,nrDEG$padj&lt;0.05 & \n                                 abs(nrDEG$log2FoldChange)&gt;=1)|&gt; \n    slice_head(n=25) \n\n\nggplot(nrDEG,aes( x = log2FoldChange,y = -log10(padj),color=group,shape=group))+\n    geom_point(alpha=0.5,size=1.5)+\n    scale_color_manual(values = c(\"red\",\"green\",\"gray\"))+\n    #scale_shape_manual(values = c(2,25,4))+\n    geom_vline(xintercept = c(-1,0,1),lty=3,color=\"grey25\",lwd=0.8)+\n    geom_hline(yintercept = -log10(0.05),lty=3,color=\"grey25\",lwd=0.8)+\n    ggrepel::geom_text_repel(\n        data = gene_labels,\n        aes(label=gene),\n        color=\"black\",\n        size=2)+\n    theme_pubr()\n\n\n\n\n\n\n\n\n5.5.5 EnhancedVolcano\n\n\nCodeif(!require(EnhancedVolcano))\n  BiocManager::install('EnhancedVolcano')\n\n\n\n5.5.6 LFC收缩和pagj\n\nCoderesultsNames(des)\n#&gt; [1] \"Intercept\"                 \"condition_tumor_vs_normal\"\n# BiocManager::install(\"apeglm\")  自适应 t 先验收缩估计器  默认\n# resLFC &lt;- lfcShrink(des, coef=\"condition_tumor_vs_normal\", type=\"apeglm\")\n\n# `normal`是原始的 DESeq2 收缩估计器，是先验的自适应正态分布\nresNorm &lt;- lfcShrink(des, coef=2, type=\"normal\")\n\n# BiocManager::install(\"ashr\")\n# resAsh &lt;- lfcShrink(des, coef=2, type=\"ashr\")\n\n\n## 先验信息\n\n# priorInfo(resLFC)\npriorInfo(resNorm)\n#&gt; $type\n#&gt; [1] \"normal\"\n#&gt; \n#&gt; $package\n#&gt; [1] \"DESeq2\"\n#&gt; \n#&gt; $version\n#&gt; [1] '1.44.0'\n#&gt; \n#&gt; $betaPriorVar\n#&gt;      Intercept conditiontumor \n#&gt;   1.000000e+06   1.658755e+00\n# priorInfo(resAsh)\n\n\n\n5.5.7 MA图 Mean-AbsDeviation plot\n\nCode# 对gene添加“是否呈现显著差异表达”的标签\nDESeq2_DEG$significant &lt;- factor(ifelse(DESeq2_DEG$padj &lt;0.05, \"Significant\", \"NS\"),\nlevels = c(\"Significant\", \"NS\"))\n\ntable(DESeq2_DEG$significant)\n#&gt; \n#&gt; Significant          NS \n#&gt;        5408       13664\n# 以baseMean作为x，log2FoldChange作为y   以significant作为分类变量\nggplot(DESeq2_DEG, aes(baseMean, log2FoldChange, colour=significant)) + \n geom_point(size=1) + \n scale_y_continuous(limits=c(-3, 3)) + \n scale_x_log10() + \n geom_hline(yintercept = 0, colour=\"black\", linewidth=1) + \n labs(x=\"mean of normalized counts\", y=\"log2FoldChange\") + \n scale_colour_manual(name=\"padj\", \n                     values=c(\"Significant\"=\"blue\",\"NS\"=\"grey50\")) +\n theme_classic()\n\n\n\n\n\n\n\n\nCodexlim &lt;- c(1,10e6)\nylim &lt;- c(-3,3)\nplotMA(resOrdered,  xlim=xlim, ylim=ylim,main=\"none\")\n\n\n\n\n\n\nCode# plotMA(resLFC, xlim=xlim, ylim=ylim, main=\"apeglm\")\nplotMA(resNorm, xlim=xlim, ylim=ylim, main=\"normal\")\n\n\n\n\n\n\nCode# plotMA(resAsh, xlim=xlim, ylim=ylim, main=\"ashr\")\n\n\n\n5.5.8 readCounts\n\nCode#  the counts of reads for a single gene across the groups\nplotCounts(des, gene=which.min(resOrdered$padj), \n  intgroup=\"condition\",returnData=TRUE) |&gt; \n ggplot(aes(x=condition, y=count)) + \n geom_point(position=position_jitter(w=0.1,h=0))\n\n\n\n\n\n\n\n\n5.5.9 异常观测\n\nCodeW &lt;- resOrdered$stat\nmaxCooks &lt;- apply(assays(des)[[\"cooks\"]],1,max)\nidx &lt;- !is.na(W)\nplot(rank(W[idx]), maxCooks[idx], xlab=\"rank of Wald statistic\", \n  ylab=\"maximum Cook's distance per gene\",\n  ylim=c(0,5), cex=.4, col=rgb(0,0,0,.3))\nm &lt;- ncol(des)\np &lt;- 3\nabline(h=qf(.99, p, m - p))\n\n\n\n\n\n\n\n\n5.5.10 多因素设计\n\nCodecolData(dds)\n#&gt; DataFrame with 16 rows and 3 columns\n#&gt;                  radiation_therapy kras_mutation_found condition\n#&gt;                        &lt;character&gt;         &lt;character&gt;  &lt;factor&gt;\n#&gt; TCGA-44-6145-01A                NO                  NO    tumor \n#&gt; TCGA-44-6145-11A                NO                  NO    normal\n#&gt; TCGA-44-6148-01A                NO                  NO    tumor \n#&gt; TCGA-44-6148-11A                NO                  NO    normal\n#&gt; TCGA-49-6742-01A                NO                  NO    tumor \n#&gt; ...                            ...                 ...       ...\n#&gt; TCGA-50-5066-02A                NO                  NO    tumor \n#&gt; TCGA-50-5935-01A               YES                 YES    tumor \n#&gt; TCGA-50-5935-11A               YES                 YES    normal\n#&gt; TCGA-50-5936-01A                NO                 YES    tumor \n#&gt; TCGA-50-5936-11A                NO                 YES    normal",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html",
    "href": "EnrichmentAnalysis.html",
    "title": "\n6  富集分析\n",
    "section": "",
    "text": "6.1 基因集富集分析 GSEA\n基因集表示基因集中基因的一般共享生物属性的先验知识。",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#基因集富集分析-gsea",
    "href": "EnrichmentAnalysis.html#基因集富集分析-gsea",
    "title": "\n6  富集分析\n",
    "section": "",
    "text": "GSEA\n\n\n\n\n\n\n6.1.1 over-representation analysis (ORA)\n基因本体论 （Gene Ontology，GO） 基因集\n京都基因与基因组百科全书 （Kyoto Encyclopedia of Genes and Genomes，KEGG）基因集\n\nCode# BiocManager::install('clusterProfiler')\n# BiocManager::install(\"org.Hs.eg.db\")\n\nDEG &lt;- read_csv(\"data/resOrdered.csv\")\nx &lt;-  na.omit(DEG) \n\n\n对于有参考基因组物种的分析，可以在相关软件包中直接加载该物种的背景基因集。对于常见的模式物种，例如BiocManager::install(\"org.Hs.eg.db\") ，安装人类hg19的注释包 BiocManager::install(\"org.Mm.eg.db\") ，安装小鼠的注释包",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#基因注释",
    "href": "EnrichmentAnalysis.html#基因注释",
    "title": "\n6  富集分析\n",
    "section": "\n6.2 基因注释",
    "text": "6.2 基因注释\n\nCodedeg_df &lt;- x[,c(1,3,7)]\nhead(deg_df)\n\n\n\n\ngene\nlog2FoldChange\npadj\n\n\n\nMGAT3\n-4.320278\n0\n\n\nRTKN2\n-4.640307\n0\n\n\nGPM6A\n-5.145635\n0\n\n\nSERTM1\n-6.886260\n0\n\n\nLIMS2\n-2.660279\n0\n\n\nEMP2\n-2.671839\n0\n\n\n\n\n\nCode\ndeg_df$expression &lt;- factor( \n    ifelse( deg_df$padj&lt; 0.05 & abs(deg_df$log2FoldChange) &gt;= 1,\n            if_else( deg_df$log2FoldChange &gt;= 1 , 'up', 'down' ),\n            'NS'),\n    levels = c(\"up\",\"down\",\"NS\"))\ntable(deg_df$expression)\n#&gt; \n#&gt;    up  down    NS \n#&gt;  2073  1641 15358\n\ngtf_v22_transcripts &lt;- read_delim(\"data/gencode.v22.annotation.gene.probeMap\")\n\n\n# 之前差异分析可以保留ENSEMBL标识符  \ndeg_df &lt;- deg_df |&gt; \n inner_join(gtf_v22_transcripts, by = c( \"gene\"= \"gene\"))\n\n# 移除ENSEMBL版本号\ndeg_df$ENSEMBL &lt;- str_sub(deg_df$id, start = 1, end = 15)\n\n\nR 语言中 AnnotationDbi 包提供的一个函数名bitr() 代表 “Biological Identifier Translation”，即生物学标识符转换。这个函数用于在不同的基因标识符之间进行转换，例如从基因的 Ensembl ID 转换为 Entrez ID（特定基因产物）)、基因符号（symbol）或基因名称（gene name）。\nEntrez是National Center for Biotechnology Information (NCBI) 提供的一个综合性生物信息数据库查询系统。它允许用户搜索和检索包括基因、蛋白质、核酸序列、3D蛋白质结构、基因表达数据、基因组数据、遗传多态性、生物项目、生物文献等各种生物医学信息。Entrez Gene数据库中的基因ID是唯一的数字标识符，用于在NCBI的Entrez系统内标识特定的基因。\nclusterProfiler\n\nCodelibrary(clusterProfiler)\nlibrary(org.Hs.eg.db)\nAnnotationDbi::keytypes(org.Hs.eg.db)\n#&gt;  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n#&gt;  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n#&gt; [11] \"GENETYPE\"     \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"         \n#&gt; [16] \"OMIM\"         \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"        \n#&gt; [21] \"PMID\"         \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"      \n#&gt; [26] \"UNIPROT\"\nhead(keys(org.Hs.eg.db, \"ENSEMBL\"))\n#&gt; [1] \"ENSG00000121410\" \"ENSG00000175899\" \"ENSG00000291190\" \"ENSG00000171428\"\n#&gt; [5] \"ENSG00000156006\" \"ENSG00000196136\"\nhead(keys(org.Hs.eg.db, \"ENTREZID\"))\n#&gt; [1] \"1\"  \"2\"  \"3\"  \"9\"  \"10\" \"11\"\nhead(keys(org.Hs.eg.db, \"SYMBOL\")) #基因名称缩写\n#&gt; [1] \"A1BG\"  \"A2M\"   \"A2MP1\" \"NAT1\"  \"NAT2\"  \"NATP\"\nhead(keys(org.Hs.eg.db, \"GENENAME\")) # 基因名称全称\n#&gt; [1] \"alpha-1-B glycoprotein\"             \"alpha-2-macroglobulin\"             \n#&gt; [3] \"alpha-2-macroglobulin pseudogene 1\" \"N-acetyltransferase 1\"             \n#&gt; [5] \"N-acetyltransferase 2\"              \"N-acetyltransferase pseudogene\"\n\nvalid_ensembl &lt;- deg_df$ENSEMBL %in% keys(org.Hs.eg.db, \"ENSEMBL\")  \ntable(valid_ensembl)\n#&gt; valid_ensembl\n#&gt; FALSE  TRUE \n#&gt;  2262 16895\n\nvalid_symbol &lt;- deg_df$gene %in% keys(org.Hs.eg.db, \"SYMBOL\")  \ntable(valid_symbol)\n#&gt; valid_symbol\n#&gt; FALSE  TRUE \n#&gt;  3242 15915\n\n\ndeg_df_filtered &lt;- deg_df[valid_ensembl, ]  \n\n# Biological Identifier Translation\ndf &lt;- bitr(\n geneID= deg_df_filtered$ENSEMBL,\n fromType = \"ENSEMBL\", \n toType = c( \"ENTREZID\",\"SYMBOL\",\"GENENAME\" ), \n OrgDb = org.Hs.eg.db )\n\nhead(df)\n\n\n\n\n\n\n\n\n\n\nENSEMBL\nENTREZID\nSYMBOL\nGENENAME\n\n\n\nENSG00000128268\n4248\nMGAT3\nbeta-1,4-mannosyl-glycoprotein 4-beta-N-acetylglucosaminyltransferase\n\n\nENSG00000182010\n219790\nRTKN2\nrhotekin 2\n\n\nENSG00000150625\n2823\nGPM6A\nglycoprotein M6A\n\n\nENSG00000180440\n400120\nSERTM1\nserine rich and transmembrane domain containing 1\n\n\nENSG00000072163\n55679\nLIMS2\nLIM zinc finger domain containing 2\n\n\nENSG00000213853\n2013\nEMP2\nepithelial membrane protein 2\n\n\n\n\n\nCode\ndeg_df &lt;- inner_join(deg_df_filtered, df, by='ENSEMBL' )\n\n\n进行上调和下调基因的分离是为了更精确地识别与特定生物学过程或疾病状态相关的途径。例如，某些途径可能在疾病发生时被激活，导致相关基因上调，而其他途径可能被抑制，导致相关基因下调。\n\nCodegene_up &lt;- deg_df[ deg_df$expression == 'up', \"ENTREZID\" ] \ngene_down &lt;- deg_df[ deg_df$expression == 'down', \"ENTREZID\"]\n\n\ngene_all &lt;- deg_df[ ,\"ENTREZID\"]\n\nlibrary(biomaRt)\n\n# 使用biomaRt映射基因ID\ngene_info &lt;- getBM(attributes = c(\"hgnc_symbol\", \"entrezgene_id\"), \n                     filters = \"entrezgene_id\", \n                     values = gene_up$ENTREZID, \n                     mart = useMart(\"ensembl\", dataset = \"hsapiens_gene_ensembl\"))",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#kegg-通路富集",
    "href": "EnrichmentAnalysis.html#kegg-通路富集",
    "title": "\n6  富集分析\n",
    "section": "\n6.3 KEGG 通路富集",
    "text": "6.3 KEGG 通路富集\n\nCodekegg_up &lt;- clusterProfiler::enrichKEGG(gene = gene_up$ENTREZID ,# entrez gene id\n                    organism=  'hsa',\n                    keyType = \"kegg\",\n                    pvalueCutoff  =  0.05,\n                    pAdjustMethod = \"BH\",  # FDR多重假设检验校正 qvalue\n                    universe=  gene_all$ENTREZID,\n                    minGSSize = 10,\n                    maxGSSize = 500,\n                    qvalueCutoff  =  0.05 )\nkegg_down &lt;- clusterProfiler::enrichKEGG(gene = gene_down$ENTREZID ,\n                    organism=  'hsa',\n                    keyType = \"kegg\",\n                    pvalueCutoff  =  0.05,\n                    pAdjustMethod = \"BH\", \n                    universe=  gene_all$ENTREZID,\n                    qvalueCutoff  =  0.05 )\n\n\n\nCodedf_up&lt;- as.data.frame(kegg_up)\ndf_down&lt;- as.data.frame(kegg_down)\ndf_up\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncategory\nsubcategory\nID\nDescription\nGeneRatio\nBgRatio\npvalue\np.adjust\nqvalue\ngeneID\nCount\n\n\n\nhsa04110\nCellular Processes\nCell growth and death\nhsa04110\nCell cycle\n56/763\n154/6926\n0.0000000\n0.0000000\n0.0000000\n5347/898/990/701/113130/991/151648/9232/9212/9133/891/995/9088/23594/7272/890/4998/9700/57082/1111/10403/157570/8318/4171/1029/80174/699/4173/90381/4175/4085/81620/1870/983/9134/11200/27085/993/3065/4176/1871/5111/5001/10926/9319/5933/7157/26271/10459/1875/5591/1019/1869/8317/1663/4193\n56\n\n\nhsa01230\nMetabolism\nGlobal and overview maps\nhsa01230\nBiosynthesis of amino acids\n19/763\n64/6926\n0.0000356\n0.0045716\n0.0042807\n5831/84706/5832/6472/29968/2597/5214/2023/3418/5091/1373/10993/7167/6888/226/3417/440/4143/384\n19\n\n\nhsa01232\nMetabolism\nGlobal and overview maps\nhsa01232\nNucleotide metabolism\n22/763\n81/6926\n0.0000409\n0.0045716\n0.0042807\n205/6241/978/7083/377841/7298/4830/7498/100/4907/124583/4833/122622/4831/272/3251/56953/1841/9615/7371/5167/954\n22\n\n\nhsa05206\nHuman Diseases\nCancer: overview\nhsa05206\nMicroRNAs in cancer\n34/763\n155/6926\n0.0000549\n0.0046001\n0.0043074\n898/113130/1591/995/1945/2146/5268/1944/1029/9493/8091/1870/5328/9134/7473/1789/1946/672/4318/993/6659/3065/1871/6464/7157/90427/6768/3845/3925/1869/54541/4193/6624/2065\n34\n\n\nhsa00330\nMetabolism\nAmino acid metabolism\nhsa00330\nArginine and proline metabolism\n14/763\n45/6926\n0.0002183\n0.0123365\n0.0115516\n5831/79814/1159/548596/5832/26/283208/6723/54498/6611/2628/219/384/2593\n14\n\n\nhsa03030\nGenetic Information Processing\nReplication and repair\nhsa03030\nDNA replication\n12/763\n35/6926\n0.0002210\n0.0123365\n0.0115516\n1763/4171/4173/2237/5427/4175/5984/5558/10535/4176/5111/6119\n12\n\n\nhsa00480\nMetabolism\nMetabolism of other amino acids\nhsa00480\nGlutathione metabolism\n15/763\n51/6926\n0.0002628\n0.0125753\n0.0117751\n2877/6241/2729/2936/79017/3418/6723/2730/6611/2539/3417/4257/493869/5226/494143\n15\n\n\nhsa01200\nMetabolism\nGlobal and overview maps\nhsa01200\nCarbon metabolism\n23/763\n101/6926\n0.0004909\n0.0193605\n0.0181286\n84706/6472/29968/2597/5214/2023/2731/3418/5091/1373/10993/2821/7167/6888/2539/80201/226/3417/55753/2653/4199/5226/6389\n23\n\n\nhsa00240\nMetabolism\nNucleotide metabolism\nhsa00240\nPyrimidine metabolism\n15/763\n54/6926\n0.0005201\n0.0193605\n0.0181286\n6241/978/7083/377841/7298/4830/4907/124583/4833/4831/790/56953/1841/7371/5167\n15\n\n\nhsa03460\nGenetic Information Processing\nReplication and repair\nhsa03460\nFanconi anemia pathway\n14/763\n50/6926\n0.0007264\n0.0223526\n0.0209303\n29089/83990/116028/55215/641/146956/5888/2189/2177/2175/2187/91442/672/6119\n14\n\n\nhsa05203\nHuman Diseases\nCancer: overview\nhsa05203\nViral carcinogenesis\n33/763\n171/6926\n0.0008538\n0.0223526\n0.0209303\n2648/898/991/890/3017/1111/1029/3718/983/1237/9134/7188/440689/3665/2961/3065/5366/7185/8339/5933/7157/1232/148327/8294/85236/5902/3845/7186/1019/8365/4193/8347/7419\n33\n\n\nhsa04115\nCellular Processes\nCell growth and death\nhsa04115\np53 signaling pathway\n18/763\n74/6926\n0.0008674\n0.0223526\n0.0209303\n898/9133/891/51512/6241/5268/1111/1029/983/9134/11200/64065/5366/84883/7157/1019/3486/4193\n18\n\n\nhsa04974\nOrganismal Systems\nDigestive system\nhsa04974\nProtein digestion and absorption\n18/763\n74/6926\n0.0008674\n0.0223526\n0.0209303\n3783/1301/1300/6564/1281/1294/1308/1290/169044/1289/1277/255631/5646/478/1278/1293/1298/1299\n18\n\n\nhsa01240\nMetabolism\nGlobal and overview maps\nhsa01240\nBiosynthesis of cofactors\n27/763\n135/6926\n0.0014208\n0.0339975\n0.0318343\n205/6999/1728/6472/29968/4830/7358/80308/2729/29926/10797/53630/4833/23475/2730/122622/4831/3145/790/23057/1719/219/8942/8836/4143/54578/93100\n27\n\n\n\n\n\nCodedf_down\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncategory\nsubcategory\nID\nDescription\nGeneRatio\nBgRatio\npvalue\np.adjust\nqvalue\ngeneID\nCount\n\n\n\nhsa04080\nEnvironmental Information Processing\nSignaling molecules and interaction\nhsa04080\nNeuroactive ligand-receptor interaction\n44/635\n181/6926\n0.0000000\n0.0000003\n0.0000002\n1910/154/7433/10316/1901/10203/1129/2890/148/2900/2358/5028/2922/59350/1268/554/8698/5745/1906/22953/122042/6751/53637/9002/117/185/5734/153/728/146/3953/2894/1908/1132/1128/2357/5179/3355/187/2690/2740/796/8862/147\n44\n\n\nhsa04270\nOrganismal Systems\nCirculatory system\nhsa04270\nVascular smooth muscle contraction\n31/635\n116/6926\n0.0000000\n0.0000042\n0.0000036\n10266/10268/255189/10398/2977/10203/196883/50487/148/5581/779/5319/5592/4629/54776/91807/5583/1906/72/4881/108/10242/5588/114/185/146/115/1908/4628/796/147\n31\n\n\nhsa04820\nNA\nNA\nhsa04820\nCytoskeleton in muscle cells\n43/635\n201/6926\n0.0000001\n0.0000081\n0.0000070\n64236/27063/7134/6445/10398/1288/2273/23500/477/171024/88/4629/4620/1285/6442/25802/161176/72/1286/6711/10529/84467/7431/1674/2192/9172/6383/91977/25777/2006/131873/825/7273/8516/58529/56203/8736/4628/7111/29767/7140/4634/23345\n43\n\n\nhsa04610\nOrganismal Systems\nImmune system\nhsa04610\nComplement and coagulation cascades\n21/635\n71/6926\n0.0000008\n0.0000611\n0.0000528\n5648/7056/7450/11326/732/9002/1361/2157/1604/2159/2160/728/5627/3687/10747/722/717/712/2/1675/713\n21\n\n\nhsa05144\nHuman Diseases\nInfectious disease: parasitic\nhsa05144\nMalaria\n16/635\n46/6926\n0.0000015\n0.0000934\n0.0000808\n5175/2995/6403/1440/948/3569/2532/3043/7042/3040/6383/7099/3039/3082/3683/3553\n16\n\n\nhsa04024\nEnvironmental Information Processing\nSignal transduction\nhsa04024\ncAMP signaling pathway\n36/635\n176/6926\n0.0000028\n0.0001455\n0.0001257\n154/10398/196883/1129/2890/477/779/338442/11069/64399/627/1906/5140/4881/108/6751/114/10411/8843/117/2353/153/115/51196/1262/64411/1908/6262/5348/4772/1128/3725/3355/5295/5350/2740\n36\n\n\nhsa04924\nOrganismal Systems\nEndocrine system\nhsa04924\nRenin secretion\n17/635\n60/6926\n0.0000166\n0.0007425\n0.0006417\n154/2977/358/779/5153/1636/5972/1906/5140/4881/117/185/5593/5734/153/1908/5137\n17\n\n\nhsa04015\nEnvironmental Information Processing\nSignal transduction\nhsa04015\nRap1 signaling pathway\n34/635\n185/6926\n0.0000562\n0.0021692\n0.0018748\n7010/51378/196883/2255/2277/9732/5028/11069/10235/8817/1268/5587/5155/260425/2247/108/114/10411/9002/2324/5590/3791/9771/115/9863/51196/64411/284/9223/3082/3683/2357/5295/2264\n34\n\n\nhsa04022\nEnvironmental Information Processing\nSignal transduction\nhsa04022\ncGMP-PKG signaling pathway\n28/635\n141/6926\n0.0000624\n0.0021692\n0.0018748\n1910/154/10398/2977/196883/148/5581/477/779/5592/91807/5140/4881/5138/108/10242/114/185/5593/153/8654/146/115/3764/23533/4772/5350/147\n28\n\n\nhsa04020\nEnvironmental Information Processing\nSignal transduction\nhsa04020\nCalcium signaling pathway\n36/635\n203/6926\n0.0000745\n0.0023306\n0.0020143\n1910/7134/154/845/196883/1129/2255/2277/148/779/5153/8817/91807/22953/5155/2247/108/114/2324/185/153/3791/146/115/51196/6262/3082/4772/1128/2264/4915/5350/5137/2066/4843/147\n36\n\n\nhsa04380\nOrganismal Systems\nDevelopment and regeneration\nhsa04380\nOsteoclast differentiation\n26/635\n131/6926\n0.0001144\n0.0032557\n0.0028139\n7048/126014/10326/9846/54/6688/4286/3552/7042/4688/2353/11025/102725035/107987425/107987462/11027/2354/695/4772/3553/3725/3727/5295/3726/5468/79168\n26\n\n\nhsa04923\nOrganismal Systems\nEndocrine system\nhsa04923\nRegulation of lipolysis in adipocytes\n13/635\n46/6926\n0.0001684\n0.0043932\n0.0037970\n2167/154/196883/5592/5140/4881/108/114/5593/153/115/11343/5295\n13\n\n\nhsa04970\nOrganismal Systems\nDigestive system\nhsa04970\nSalivary secretion\n16/635\n69/6926\n0.0003885\n0.0093543\n0.0080849\n154/2977/196883/148/477/5592/108/114/683/5593/153/820/146/115/1473/147\n16\n\n\nhsa04261\nOrganismal Systems\nCirculatory system\nhsa04261\nAdrenergic signaling in cardiomyocytes\n25/635\n135/6926\n0.0004720\n0.0100425\n0.0086797\n7134/154/196883/148/477/779/9254/11069/6330/108/114/10411/185/153/146/115/23533/6262/3753/785/6332/5350/4634/55799/147\n25\n\n\nhsa05414\nHuman Diseases\nCardiovascular disease\nhsa05414\nDilated cardiomyopathy\n19/635\n91/6926\n0.0004813\n0.0100425\n0.0086797\n7134/6445/196883/779/9254/6442/108/7042/1674/114/153/115/7273/8516/6262/785/5350/4634/55799\n19\n\n\nhsa04933\nHuman Diseases\nEndocrine and metabolic disease\nhsa04933\nAGE-RAGE signaling pathway in diabetic complications\n20/635\n99/6926\n0.0005420\n0.0106032\n0.0091643\n177/7048/1288/2277/5581/7056/3569/1285/1906/1286/3552/7042/5590/185/1958/51196/4772/3553/3725/5295\n20\n\n\nhsa04740\nOrganismal Systems\nSensory system\nhsa04740\nOlfactory transduction\n10/635\n35/6926\n0.0008629\n0.0150651\n0.0130208\n408/123041/57101/5153/5592/5138/83988/5593/1262/5137\n10\n\n\nhsa04060\nEnvironmental Information Processing\nSignaling molecules and interaction\nhsa04060\nCytokine-cytokine receptor interaction\n35/635\n221/6926\n0.0008664\n0.0150651\n0.0130208\n7048/53342/94/6369/1440/55504/3563/3590/3569/2920/51554/6368/3977/6358/653/3552/7042/659/90865/2921/5473/3953/8741/654/9173/1271/3553/650/2662/85480/3575/2690/53832/3577/3579\n35\n\n\nhsa04514\nEnvironmental Information Processing\nSignaling molecules and interaction\nhsa04514\nCell adhesion molecules\n25/635\n143/6926\n0.0011339\n0.0186796\n0.0161448\n23705/5175/1003/58494/6403/51208/64115/7122/6693/947/90952/5797/94030/3133/23114/83700/6383/6404/84631/8516/3683/22865/3384/4099/257194\n25\n\n\nhsa04926\nOrganismal Systems\nEndocrine system\nhsa04926\nRelaxin signaling pathway\n21/635\n116/6926\n0.0017605\n0.0275521\n0.0238133\n1910/7048/408/53358/196883/1288/2277/59350/1285/1906/1286/122042/108/114/5590/2353/115/3725/5295/2791/4843\n21\n\n\nhsa03320\nOrganismal Systems\nEndocrine system\nhsa03320\nPPAR signaling pathway\n13/635\n60/6926\n0.0025795\n0.0384467\n0.0332295\n2167/33/948/4973/4023/10580/6258/1593/2180/2171/79966/5468/28965\n13\n\n\nhsa04927\nOrganismal Systems\nEndocrine system\nhsa04927\nCortisol synthesis and secretion\n12/635\n54/6926\n0.0029828\n0.0409681\n0.0354088\n196883/779/3949/3739/108/114/185/1586/115/3777/8622/3164\n12\n\n\nhsa05150\nHuman Diseases\nInfectious disease: bacterial\nhsa05150\nStaphylococcus aureus infection\n13/635\n61/6926\n0.0030104\n0.0409681\n0.0354088\n5648/6403/2358/6404/820/728/3683/10747/2357/717/712/1675/713\n13\n\n\n\n\n\n\n对于各列内容：\nID和Description，富集到的通路和功能描述；\nGeneRatio和BgRatio，分别为富集到该通路中的基因数目/给定基因的总数目，以及该通路中背景基因总数目/该物种所有已知的KEGG功能基因数目；\npvalue、p.adjust和qvalue，p值、校正后p值和q值信息；\n\n\np值（P-value）：\n\np值是在一个假设检验中，当零假设（null hypothesis）为真时，观察到的统计量或更极端情况出现的概率。\n一个低的p值（如小于0.05）通常表明统计学上的显著性，意味着结果不太可能仅仅是由随机因素引起的。\n不太关心假阳性，而是更关注于发现尽可能多的显著性通路，原始的p值可能足够\n\n\n\n校正后的p值（Adjusted P-value） - Benjamini-Hochberg (BH)方法：\n\n在进行多重检验时，为了控制第一类错误（错误地拒绝零假设）的总体率，需要对p值进行校正。BH方法是一种流行的校正方法，它通过控制假发现率（false discovery rate, FDR）来进行校正。\nBH校正后的p值（padj）是基于原始p值按照一定规则调整后的值，用于评估在多重比较情况下的统计显著性。\n平衡假阳性和假阴性的发现，可以使用BH方法的p.adjust值\n\n\n\nq值（Q-value）：\n\nq值同样是用于评估多重检验中的统计显著性，它直接控制了假发现率。\nq值定义为在最坏的情况下，所接受的假设中错误发现的比例。例如，q=0.05意味着在所有被认为是显著的发现中，最多有5%实际上是假阳性。\n更保守地挑选显著性通路，以减少假阳性的可能性，可能会选择使用q值\nR中使用”BY”表示q值校正\n\n\n\ngeneID和Count，富集到该通路中的基因名称和数目。\n\nCodedf_up &lt;- df_up[df_up$pvalue &lt; 0.05, ]\ndf_down &lt;- df_down[df_down$pvalue &lt; 0.05, ]\nlubridate::intersect(df_up$ID,df_down$ID)\n#&gt; character(0)\n\n\n\nCodedf_up$group &lt;- 1\ndf_down$group &lt;- -1\n\n\n\nCodeup_down &lt;- rbind(df_up,df_down)\nhead(up_down)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncategory\nsubcategory\nID\nDescription\nGeneRatio\nBgRatio\npvalue\np.adjust\nqvalue\ngeneID\nCount\ngroup\n\n\n\nhsa04110\nCellular Processes\nCell growth and death\nhsa04110\nCell cycle\n56/763\n154/6926\n0.0000000\n0.0000000\n0.0000000\n5347/898/990/701/113130/991/151648/9232/9212/9133/891/995/9088/23594/7272/890/4998/9700/57082/1111/10403/157570/8318/4171/1029/80174/699/4173/90381/4175/4085/81620/1870/983/9134/11200/27085/993/3065/4176/1871/5111/5001/10926/9319/5933/7157/26271/10459/1875/5591/1019/1869/8317/1663/4193\n56\n1\n\n\nhsa01230\nMetabolism\nGlobal and overview maps\nhsa01230\nBiosynthesis of amino acids\n19/763\n64/6926\n0.0000356\n0.0045716\n0.0042807\n5831/84706/5832/6472/29968/2597/5214/2023/3418/5091/1373/10993/7167/6888/226/3417/440/4143/384\n19\n1\n\n\nhsa01232\nMetabolism\nGlobal and overview maps\nhsa01232\nNucleotide metabolism\n22/763\n81/6926\n0.0000409\n0.0045716\n0.0042807\n205/6241/978/7083/377841/7298/4830/7498/100/4907/124583/4833/122622/4831/272/3251/56953/1841/9615/7371/5167/954\n22\n1\n\n\nhsa05206\nHuman Diseases\nCancer: overview\nhsa05206\nMicroRNAs in cancer\n34/763\n155/6926\n0.0000549\n0.0046001\n0.0043074\n898/113130/1591/995/1945/2146/5268/1944/1029/9493/8091/1870/5328/9134/7473/1789/1946/672/4318/993/6659/3065/1871/6464/7157/90427/6768/3845/3925/1869/54541/4193/6624/2065\n34\n1\n\n\nhsa00330\nMetabolism\nAmino acid metabolism\nhsa00330\nArginine and proline metabolism\n14/763\n45/6926\n0.0002183\n0.0123365\n0.0115516\n5831/79814/1159/548596/5832/26/283208/6723/54498/6611/2628/219/384/2593\n14\n1\n\n\nhsa03030\nGenetic Information Processing\nReplication and repair\nhsa03030\nDNA replication\n12/763\n35/6926\n0.0002210\n0.0123365\n0.0115516\n1763/4171/4173/2237/5427/4175/5984/5558/10535/4176/5111/6119\n12\n1\n\n\n\n\n\n\n\n6.3.1 水平条图\n\nCodebarplot(kegg_up, showCategory=20, xlab=\"-log10(pvalue)\", ylab=\"Pathways\") +\n  theme_minimal()\n\n\n\n\n\n\nCodedotplot(kegg_up)\n\n\n\n\n\n\n\n\nCodeup_down$Negative_log10pvalue &lt;- -log10(up_down$pvalue)\n\nup_down$Grouped_Negativelog10pvalue &lt;- up_down$Negative_log10pvalue * up_down$group\n\nup_down &lt;- up_down[order( up_down$Grouped_Negativelog10pvalue), ]\n\nggplot(up_down, aes(\n  x =  reorder(Description, order(Grouped_Negativelog10pvalue, decreasing = F)),\n  y = Grouped_Negativelog10pvalue,\n  fill = group\n)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip()+\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_x_discrete(name = \"Pathway names\") +\n  scale_y_continuous(name = \"-log10 pvalue\")+\n  theme(plot.title = element_text(hjust = 0.5) ) +\n  ggtitle(\"KEGG Pathway Enrichment\") \n\n\n\n\n\n\n\n\n6.3.2 点图\n\nCode# GeneRatio 转化成数值型\nGR &lt;- up_down$GeneRatio |&gt; \n    str_split(pattern = \"/\",simplify = TRUE) |&gt; as_tibble(.name_repair=\"unique\")\n\nup_down$GeneRatio &lt;- parse_number(GR$...1)/parse_number(GR$...2)\n\nup_down &lt;- up_down[order(up_down$GeneRatio),]\n\nggplot(data = up_down,aes(x=GeneRatio,\n                      y=reorder(Description,order(GeneRatio)),\n                      color = Grouped_Negativelog10pvalue,\n                      size=Count\n                      )\n       )+\n    geom_point()+\n    scale_x_continuous( name = \"GeneRatio\" ,breaks = seq(0,1.0,0.1))+\n    scale_color_gradient(low = \"blue\", high = \"red\" )+\n    scale_y_discrete( name = \"Pathway names\" ) +\n    theme( plot.title = element_text( hjust = 0.5 )) +\n    ggtitle( \"KEGG Pathway Enrichment \" )+\n    labs(color=\"-log10 pvalue\")",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#go富集分析",
    "href": "EnrichmentAnalysis.html#go富集分析",
    "title": "\n6  富集分析\n",
    "section": "\n6.4 GO富集分析",
    "text": "6.4 GO富集分析\nGene Ontology 基因集\n\n\nPackage\nOrganism\n\n\n\norg.Hs.eg.db\nHuman\n\n\norg.Mm.eg.db\nMouse\n\n\n\n对于输出的GO富集结果表格中的各列内容：\nONTOLOGY，GO的BP（生物学过程）、CC（细胞组分）或MF（分子功能）；\nID和Description，富集到的GO term及其描述；\nGeneRatio和BgRatio，分别为富集到该GO term中的基因数目/给定基因的总数目，以及该GO term中背景基因总数目/该物种所有已知GO功能基因数目；\npvalue、p.adjust和qvalue，p值、校正后p值和q值；\ngeneID和Count，富集到该GO term中的基因名称和数目。\n\nCodeGO_EA&lt;- clusterProfiler::enrichGO(gene = gene_all$ENTREZID,\n                                  OrgDb = \"org.Hs.eg.db\",\n                        \n                                  keyType = \"ENTREZID\",\n                                  ont = \"ALL\",\n                                  pvalueCutoff  =  0.05 ,\n                                  qvalueCutoff  =  0.05,\n                                  readable = F)\nGO_EA_tbl &lt;-  as_tibble(GO_EA)\n\n\n\n6.4.1 可视化\n\nCode#clusterProfiler 包里的一些默认作图方法，例如\nbarplot(GO_EA)  #富集柱形图\n\n\n\n\n\n\nCodedotplot(GO_EA)  #富集气泡图\n\n\n\n\n\n\n\n\nCodedat2 &lt;- GO_EA_tbl[GO_EA_tbl$pvalue&lt; 0.05, ]\ndat2$Negative_log10pvalue &lt;-  -log10(dat2$pvalue)\ndat2 = dat2[order( dat2$Negative_log10pvalue, decreasing = F ), ]\n\ndat2 &lt;- dat2 |&gt; \n    group_by(ONTOLOGY) |&gt; \n    slice_max(order_by = Negative_log10pvalue,n=10) |&gt; \n    ungroup()\n\n\nggplot(dat2,aes(x = Negative_log10pvalue, \n                y = reorder(Description,\n                            order(ONTOLOGY,Negative_log10pvalue,decreasing=F)),\n                fill = ONTOLOGY ))+ \n    geom_bar( stat = \"identity\" ) +\n    scale_x_continuous( name = \"-log10 pvalue\" ) +\n    scale_y_discrete( name = \"Pathway names\" ) +\n    theme_bw() + \n    theme( plot.title = element_text( hjust = 0.5 ) ) +\n    ggtitle( \"GO Pathway Enrichment\" )",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>富集分析</span>"
    ]
  }
]