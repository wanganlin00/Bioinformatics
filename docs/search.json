[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Bioinformatics",
    "section": "",
    "text": "前言",
    "crumbs": [
      "前言"
    ]
  },
  {
    "objectID": "index.html#推荐阅读",
    "href": "index.html#推荐阅读",
    "title": "Bioinformatics",
    "section": "推荐阅读",
    "text": "推荐阅读\n\nhttps://www.bioconductor.org\nOrchestrating Single-Cell Analysis with Bioconductor\nSeurat\nDESeq2\nclusterProfiler、Disease Ontology Semantic and Enrichment analysis\nmonocle2\nhttps://cole-trapnell-lab.github.io/monocle3/\n系统发育树\nplink 2.0",
    "crumbs": [
      "前言"
    ]
  },
  {
    "objectID": "index.html#前提条件",
    "href": "index.html#前提条件",
    "title": "Bioinformatics",
    "section": "前提条件",
    "text": "前提条件\n\nCodepkgs &lt;- c(\n          \"gggenes\",\n          )\n\nfor (pkg in pkgs) {\n    if (!require(pkg, character.only = TRUE)) {\n        install.packages(pkg)\n    }\n}\n\nbiopkgs &lt;- c(\"SingleCellExperiment\", \"Biostrings\",\"AnnotationHub\", \"biomaRt\",\"rtracklayer\", \"BSgenome\",\"scuttle\",\"scater\",\"scran\",\"biobroom\",\"qvalue\",\"DESeq2\",\"EnhancedVolcano\",\"clusterProfiler\"\n             )\n\nfor (pkg in biopkgs) {\n    if (!require(pkg, character.only = TRUE)) {\n        BiocManager::install(biopkgs)\n    }\n}",
    "crumbs": [
      "前言"
    ]
  },
  {
    "objectID": "upstream_analysis.html",
    "href": "upstream_analysis.html",
    "title": "1  上游分析",
    "section": "",
    "text": "1.1 测序",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>上游分析</span>"
    ]
  },
  {
    "objectID": "upstream_analysis.html#测序",
    "href": "upstream_analysis.html#测序",
    "title": "1  上游分析",
    "section": "",
    "text": "1.1.1 FASTQ 文件\n\n\n\n\n\n@&lt;instrument&gt;:&lt;run num&gt;:&lt;flowcell ID&gt;:&lt;lane&gt;:&lt;tile&gt;:&lt;x&gt;:&lt;y&gt;:&lt;UMI&gt; &lt;read&gt;:&lt;filtered&gt;:&lt;control num&gt;:&lt;index&gt;\nFastq文件形如：\n@M00970:337:000000000-BR5KF:1:1102:17745:1557 1:N:0:CGCAGAAC+ACAGAGTT\nACCAACCAACTTTCGATCTCTTGTAGATCTGTTCTCT...AAACGAACTTTAAAATCTGTGTGGCTGTCACTCGGCTGCATGC\n+\nDDDCDDDDDDFFGGGGGGGGGGHHHHHHHHHHHHHHH...HHHHGGGGHHHHHHHHHHHHHHHGHHGHHHHHHGGGGGGHHHH\n每个碱基对应的字符在ASCII码中对应的十进制数字减去33即为该碱基质量（也即Phred33体系），例如上述序列中第一个碱基的质量为D，对应的十进制数字为68（见下表），则碱基质量为68-33=35。碱基质量Q=-10*lgP，P为碱基被测错的概率。也即Q为30代表被测错的概率为0.001，碱基质量越高，则被测错的概率越低。\nQ = -10 log10(P)\n\n\n\n\n\n\n\n\n\n\n\n\n1.1.2 BAM 文件\nBinary alignment\nGenomicAlignments\n\n\n1.1.3 VCF 文件\n变异注释\nVariantAnnotation readVcf()\n\n\n1.1.4 BED、WIG、GTF 文件\n基因组注释文件\nrtracklayer",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>上游分析</span>"
    ]
  },
  {
    "objectID": "upstream_analysis.html#质量控制fastqc",
    "href": "upstream_analysis.html#质量控制fastqc",
    "title": "1  上游分析",
    "section": "1.2 质量控制：FastQC",
    "text": "1.2 质量控制：FastQC\nFastQC v0.12.1 (Win/Linux zip file)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>上游分析</span>"
    ]
  },
  {
    "objectID": "upstream_analysis.html#剪切trimmomatic",
    "href": "upstream_analysis.html#剪切trimmomatic",
    "title": "1  上游分析",
    "section": "1.3 剪切：Trimmomatic",
    "text": "1.3 剪切：Trimmomatic\n接头序列的去除和低质量序列的修剪",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>上游分析</span>"
    ]
  },
  {
    "objectID": "upstream_analysis.html#序列比对star",
    "href": "upstream_analysis.html#序列比对star",
    "title": "1  上游分析",
    "section": "1.4 序列比对：STAR",
    "text": "1.4 序列比对：STAR",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>上游分析</span>"
    ]
  },
  {
    "objectID": "upstream_analysis.html#定量计数矩阵",
    "href": "upstream_analysis.html#定量计数矩阵",
    "title": "1  上游分析",
    "section": "1.5 定量：计数矩阵",
    "text": "1.5 定量：计数矩阵\nhttps://subread.sourceforge.net/featureCounts.html\n\n将读数与基因组对齐，并计算每个基因外显子内的读数数量。\nR 包 Rsubread 更简单、更快、更便宜、更适合 RNA 测序的比对和定量\nhttps://bioconductor.org/packages/release/bioc/html/Rsubread.html\nfeatureCount是subread软件包里的一个命令，所以安装subread R版，\n将读数与转录组对齐，量化转录表达，并将转录表达总结为基因表达\nPseudoalign针对转录组进行读取，使用相应的基因组作为诱饵，量化该过程中的转录物表达，并将转录物水平的表达总结为基因水平的表达",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>上游分析</span>"
    ]
  },
  {
    "objectID": "biodata_structure.html",
    "href": "biodata_structure.html",
    "title": "\n2  生物数据结构\n",
    "section": "",
    "text": "2.1 S4 类\nhttps://bioconductor.org/packages/release/workflows/html/sequencing.html",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>生物数据结构</span>"
    ]
  },
  {
    "objectID": "biodata_structure.html#s4-类",
    "href": "biodata_structure.html#s4-类",
    "title": "\n2  生物数据结构\n",
    "section": "",
    "text": "2.1.1 DataFrame\n\nCodelibrary(S4Vectors)\nconflicts_prefer(S4Vectors::setdiff)\n# 创建一个 DataFrame 对象\ndf &lt;- DataFrame(a = 1:3, b = letters[1:3])\ndf\n#&gt; DataFrame with 3 rows and 2 columns\n#&gt;           a           b\n#&gt;   &lt;integer&gt; &lt;character&gt;\n#&gt; 1         1           a\n#&gt; 2         2           b\n#&gt; 3         3           c\n\n\n\n2.1.2 Rle\nRun-Length Encoding (RLE) 是一种简单且常用的数据压缩方法，特别适用于存储和处理重复数据序列。class?Rle\n\nCode# 创建一个 Rle 对象\n\nrle_obj &lt;- Rle(c(rep(\"A\", 5), rep(\"B\", 3), rep(\"C\", 2), \"D\", rep(\"A\", 2)))\n\nprint(rle_obj)\n#&gt; character-Rle of length 13 with 5 runs\n#&gt;   Lengths:   5   3   2   1   2\n#&gt;   Values : \"A\" \"B\" \"C\" \"D\" \"A\"\n\nrunLength(rle_obj)\n#&gt; [1] 5 3 2 1 2\n\n\n在 RLE 中，连续的重复元素（称为“运行”）被压缩成一个值和一个计数对。这个值表示重复的元素，计数表示它们的数量。例如，序列 [AAAAABBBCCDAA] 可以被编码为 (A5, B3, C2, D1, A2)。",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>生物数据结构</span>"
    ]
  },
  {
    "objectID": "biodata_structure.html#biostrings",
    "href": "biodata_structure.html#biostrings",
    "title": "\n2  生物数据结构\n",
    "section": "\n2.2 Biostrings",
    "text": "2.2 Biostrings\nBiological strings\nDNAstringSet、RNAStringSet、AAStringSet、BStringSet\n\n2.2.1 DNA\n\nCode# BiocManager::install(\"Biostrings\")\nlibrary(Biostrings) %&gt;% suppressMessages()\n\nBiostrings::DNA_ALPHABET\n#&gt;  [1] \"A\" \"C\" \"G\" \"T\" \"M\" \"R\" \"W\" \"S\" \"Y\" \"K\" \"V\" \"H\" \"D\" \"B\" \"N\" \"-\" \"+\" \".\"\nIUPAC_CODE_MAP\n#&gt;      A      C      G      T      M      R      W      S      Y      K      V \n#&gt;    \"A\"    \"C\"    \"G\"    \"T\"   \"AC\"   \"AG\"   \"AT\"   \"CG\"   \"CT\"   \"GT\"  \"ACG\" \n#&gt;      H      D      B      N \n#&gt;  \"ACT\"  \"AGT\"  \"CGT\" \"ACGT\"\n\nd &lt;- DNAStringSet(c(\"TGCACGTGCATT\",\"ACTGCA\"))\nd\n#&gt; DNAStringSet object of length 2:\n#&gt;     width seq\n#&gt; [1]    12 TGCACGTGCATT\n#&gt; [2]     6 ACTGCA\nlength(d)\n#&gt; [1] 2\n\nwidth(d)\n#&gt; [1] 12  6\nrev(d)\n#&gt; DNAStringSet object of length 2:\n#&gt;     width seq\n#&gt; [1]     6 ACTGCA\n#&gt; [2]    12 TGCACGTGCATT\nreverse(d)\n#&gt; DNAStringSet object of length 2:\n#&gt;     width seq\n#&gt; [1]    12 TTACGTGCACGT\n#&gt; [2]     6 ACGTCA\nreverseComplement(d)\n#&gt; DNAStringSet object of length 2:\n#&gt;     width seq\n#&gt; [1]    12 AATGCACGTGCA\n#&gt; [2]     6 TGCAGT\ntranslate(d)\n#&gt; AAStringSet object of length 2:\n#&gt;     width seq\n#&gt; [1]     4 CTCI\n#&gt; [2]     2 TA\n\nalphabetFrequency(d)\n#&gt;      A C G T M R W S Y K V H D B N - + .\n#&gt; [1,] 2 3 3 4 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n#&gt; [2,] 2 2 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0\nletterFrequency(d,letters = \"GC\")\n#&gt;      G|C\n#&gt; [1,]   6\n#&gt; [2,]   3\ndinucleotideFrequency(d)\n#&gt;      AA AC AG AT CA CC CG CT GA GC GG GT TA TC TG TT\n#&gt; [1,]  0  1  0  1  2  0  1  0  0  2  0  1  0  0  2  1\n#&gt; [2,]  0  1  0  0  1  0  0  1  0  1  0  0  0  0  1  0\n\n# 共识矩阵\n\nconsensusMatrix(d)\n#&gt;   [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]\n#&gt; A    1    0    0    1    0    1    0    0    0     1     0     0\n#&gt; C    0    1    1    0    2    0    0    0    1     0     0     0\n#&gt; G    0    1    0    1    0    1    0    1    0     0     0     0\n#&gt; T    1    0    1    0    0    0    1    0    0     0     1     1\n#&gt; M    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; R    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; W    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; S    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; Y    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; K    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; V    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; H    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; D    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; B    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; N    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; -    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; +    0    0    0    0    0    0    0    0    0     0     0     0\n#&gt; .    0    0    0    0    0    0    0    0    0     0     0     0\n\n\n从 Ensembl 的FASTA文件’Homo_sapiens.GRCh38.cdna.all.fa’中下载所有智人cDNA序列\n\nCodelibrary(AnnotationHub) %&gt;% suppressMessages()\nah &lt;- AnnotationHub(cache = \"D:/AnnotationHub\")\nah\nah2 &lt;- query(ah, c(\"fasta\", \"homo sapiens\", \"Ensembl\", \"cdna\"))\nah2\n\n# 下载为TwoBitFile文件\ndna &lt;- ah2[[\"AH68262\"]]\n\ndna@resource\n#&gt; [1]\"C:\\\\Users\\\\WANGAN~1\\\\AppData\\\\Local\\\\Temp\\\\RtmpeUSnD9/BiocFileCache/40e014f2123b_75008\"\n\nBiostrings::getSeq(dna)\n\n\n\nCodelibrary(rtracklayer)\ndna &lt;- import.2bit(con = \"C:\\\\Users\\\\WANGAN~1\\\\AppData\\\\Local\\\\Temp\\\\RtmpeUSnD9/BiocFileCache/40e014f2123b_75008\")\n\ndna\n#&gt; DNAStringSet object of length 187626:\n#&gt;           width seq                                         names               \n#&gt;      [1]     12 GGGACAGGGGGC                                ENST00000632684.1\n#&gt;      [2]      9 CCTTCCTAC                                   ENST00000434970.2\n#&gt;      [3]     13 ACTGGGGGATACG                               ENST00000448914.1\n#&gt;      [4]      8 GAAATAGT                                    ENST00000415118.1\n#&gt;      [5]     12 GGGACAGGGGGC                                ENST00000631435.1\n#&gt;      ...    ... ...\n#&gt; [187622]   1370 GGCTGAGTCTGGGCCCCAGG...AAGATGCAGCCGGGAGGTGA ENST00000639790.1\n#&gt; [187623]    284 GGCGTCTACAAGAGACCTTC...GCCCTAGATGACCACTGTTA ENST00000639660.1\n#&gt; [187624]    105 TGCATCACTCTGGCATTGAC...GTGGACCCCAGAAAGTTAAT ENST00000643577.1\n#&gt; [187625]    900 ATGGGATGTCACCAATCAAT...GGAAGGAGAGGCTGATGTAA ENST00000646356.1\n#&gt; [187626]    930 ATGGGAGTCAACCAATCATG...TGCAGAGGACGCTGTCTATG ENST00000645792.1\n\n\n\n2.2.2 RNA\n\nCodeBiostrings::GENETIC_CODE\n#&gt; TTT TTC TTA TTG TCT TCC TCA TCG TAT TAC TAA TAG TGT TGC TGA TGG CTT CTC CTA CTG \n#&gt; \"F\" \"F\" \"L\" \"L\" \"S\" \"S\" \"S\" \"S\" \"Y\" \"Y\" \"*\" \"*\" \"C\" \"C\" \"*\" \"W\" \"L\" \"L\" \"L\" \"L\" \n#&gt; CCT CCC CCA CCG CAT CAC CAA CAG CGT CGC CGA CGG ATT ATC ATA ATG ACT ACC ACA ACG \n#&gt; \"P\" \"P\" \"P\" \"P\" \"H\" \"H\" \"Q\" \"Q\" \"R\" \"R\" \"R\" \"R\" \"I\" \"I\" \"I\" \"M\" \"T\" \"T\" \"T\" \"T\" \n#&gt; AAT AAC AAA AAG AGT AGC AGA AGG GTT GTC GTA GTG GCT GCC GCA GCG GAT GAC GAA GAG \n#&gt; \"N\" \"N\" \"K\" \"K\" \"S\" \"S\" \"R\" \"R\" \"V\" \"V\" \"V\" \"V\" \"A\" \"A\" \"A\" \"A\" \"D\" \"D\" \"E\" \"E\" \n#&gt; GGT GGC GGA GGG \n#&gt; \"G\" \"G\" \"G\" \"G\" \n#&gt; attr(,\"alt_init_codons\")\n#&gt; [1] \"TTG\" \"CTG\"\nBiostrings::RNA_GENETIC_CODE\n#&gt; UUU UUC UUA UUG UCU UCC UCA UCG UAU UAC UAA UAG UGU UGC UGA UGG CUU CUC CUA CUG \n#&gt; \"F\" \"F\" \"L\" \"L\" \"S\" \"S\" \"S\" \"S\" \"Y\" \"Y\" \"*\" \"*\" \"C\" \"C\" \"*\" \"W\" \"L\" \"L\" \"L\" \"L\" \n#&gt; CCU CCC CCA CCG CAU CAC CAA CAG CGU CGC CGA CGG AUU AUC AUA AUG ACU ACC ACA ACG \n#&gt; \"P\" \"P\" \"P\" \"P\" \"H\" \"H\" \"Q\" \"Q\" \"R\" \"R\" \"R\" \"R\" \"I\" \"I\" \"I\" \"M\" \"T\" \"T\" \"T\" \"T\" \n#&gt; AAU AAC AAA AAG AGU AGC AGA AGG GUU GUC GUA GUG GCU GCC GCA GCG GAU GAC GAA GAG \n#&gt; \"N\" \"N\" \"K\" \"K\" \"S\" \"S\" \"R\" \"R\" \"V\" \"V\" \"V\" \"V\" \"A\" \"A\" \"A\" \"A\" \"D\" \"D\" \"E\" \"E\" \n#&gt; GGU GGC GGA GGG \n#&gt; \"G\" \"G\" \"G\" \"G\" \n#&gt; attr(,\"alt_init_codons\")\n#&gt; [1] \"UUG\" \"CUG\"\nRNA_ALPHABET\n#&gt;  [1] \"A\" \"C\" \"G\" \"U\" \"M\" \"R\" \"W\" \"S\" \"Y\" \"K\" \"V\" \"H\" \"D\" \"B\" \"N\" \"-\" \"+\" \".\"\nr &lt;- RNAStringSet(c(\"AUCG\", \"GCAU\", \"AUCGAU\", \"GCUA\"))\nr\n#&gt; RNAStringSet object of length 4:\n#&gt;     width seq\n#&gt; [1]     4 AUCG\n#&gt; [2]     4 GCAU\n#&gt; [3]     6 AUCGAU\n#&gt; [4]     4 GCUA\n\n\n\n2.2.3 蛋白质\n组成人体蛋白质的21种氨基酸，20 + 硒代半胱氨酸（UGA-终止密码子）\n\nCodeBiostrings::AMINO_ACID_CODE\n#&gt;     A     R     N     D     C     Q     E     G     H     I     L     K     M \n#&gt; \"Ala\" \"Arg\" \"Asn\" \"Asp\" \"Cys\" \"Gln\" \"Glu\" \"Gly\" \"His\" \"Ile\" \"Leu\" \"Lys\" \"Met\" \n#&gt;     F     P     S     T     W     Y     V     U     O     B     J     Z     X \n#&gt; \"Phe\" \"Pro\" \"Ser\" \"Thr\" \"Trp\" \"Tyr\" \"Val\" \"Sec\" \"Pyl\" \"Asx\" \"Xle\" \"Glx\" \"Xaa\"\nAA_ALPHABET\n#&gt;  [1] \"A\" \"R\" \"N\" \"D\" \"C\" \"Q\" \"E\" \"G\" \"H\" \"I\" \"L\" \"K\" \"M\" \"F\" \"P\" \"S\" \"T\" \"W\" \"Y\"\n#&gt; [20] \"V\" \"U\" \"O\" \"B\" \"J\" \"Z\" \"X\" \"*\" \"-\" \"+\" \".\"\n\nprotein_strings &lt;- AAStringSet(c(\"MATH\", \"GCAU\", \"MATHMATH\", \"CUMA\"))\nprotein_strings\n#&gt; AAStringSet object of length 4:\n#&gt;     width seq\n#&gt; [1]     4 MATH\n#&gt; [2]     4 GCAU\n#&gt; [3]     8 MATHMATH\n#&gt; [4]     4 CUMA\n\n# 二进制字符串存储 如seq_id、quality\nbinary_strings &lt;- BStringSet(c(\"ERCC010101\", \"CRCC110011\", \"101010\", \"111000\"))\nbinary_strings\n#&gt; BStringSet object of length 4:\n#&gt;     width seq\n#&gt; [1]    10 ERCC010101\n#&gt; [2]    10 CRCC110011\n#&gt; [3]     6 101010\n#&gt; [4]     6 111000",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>生物数据结构</span>"
    ]
  },
  {
    "objectID": "biodata_structure.html#ranges",
    "href": "biodata_structure.html#ranges",
    "title": "\n2  生物数据结构\n",
    "section": "\n2.3 Ranges",
    "text": "2.3 Ranges\n\n2.3.1 IntervalRanges\nIRanges\n\nCodelibrary(IRanges)\nset.seed(10)\nranges &lt;- IRanges::IRanges(\n  start = round(runif(10, 1, 100)),\n  width = round(runif(10, 0, 50)),\n  names = paste0(\"exton_\", letters[sample(1:26, 10)])\n)\nranges\n#&gt; IRanges object with 10 ranges and 0 metadata columns:\n#&gt;               start       end     width\n#&gt;           &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;\n#&gt;   exton_h        51        83        33\n#&gt;   exton_n        31        58        28\n#&gt;   exton_g        43        48         6\n#&gt;   exton_f        70        99        30\n#&gt;   exton_x         9        26        18\n#&gt;   exton_r        23        43        21\n#&gt;   exton_u        28        30         3\n#&gt;   exton_m        28        40        13\n#&gt;   exton_e        62        81        20\n#&gt;   exton_a        44        85        42\n\n\nstart(ranges)\n#&gt;  [1] 51 31 43 70  9 23 28 28 62 44\nwidth(ranges)\n#&gt;  [1] 33 28  6 30 18 21  3 13 20 42\nend(ranges)\n#&gt;  [1] 83 58 48 99 26 43 30 40 81 85\n\n\n没有维度，但有长度\n\nCodedim(ranges)\n#&gt; NULL\nlength(ranges)\n#&gt; [1] 10\n\n\n重叠检测: 检查不同区间是否有重叠。\n\nCodequery &lt;- IRanges(1, 10)\nsubject &lt;- IRanges(c(5, 15), c(10, 20))\noverlaps &lt;- findOverlaps(query, subject)\noverlaps\n#&gt; Hits object with 1 hit and 0 metadata columns:\n#&gt;       queryHits subjectHits\n#&gt;       &lt;integer&gt;   &lt;integer&gt;\n#&gt;   [1]         1           1\n#&gt;   -------\n#&gt;   queryLength: 1 / subjectLength: 2\n\nqueryHits(overlaps)\n#&gt; [1] 1\n\n\n合并区间: 将重叠或相邻的区间合并为一个更大的区间。\n\nCodemerged &lt;- GenomicRanges::reduce(IRanges(start = c(1, 5), end = c(10, 20)))\nprint(merged)\n#&gt; IRanges object with 1 range and 0 metadata columns:\n#&gt;           start       end     width\n#&gt;       &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;\n#&gt;   [1]         1        20        20\n\n\n\nCodeplotRanges &lt;- function(x, xlim = x , \n                       main =deparse(substitute(x)),\n                       col = \"black\", sep = 0.5, ...){\n  height = 1\n  if(is(xlim, class2 = \"Ranges\"))\n    xlim = c(min(start(xlim)), max(end(xlim)))\n  bins &lt;- disjointBins(IRanges(start(x),end(x)+1))\n  plot.new()\n  plot.window(xlim, c(0, max(bins)*(height + sep)))\n  ybottom &lt;- bins * (sep + height) - height\n  rect(start(x)-0.5, ybottom, end(x)+0.5, ybottom + height,\n       col = col, ...)\n  title(main)\n  axis(1)\n  \n}\n\n\n\nCodeir &lt;- IRanges::IRanges(\n  start =c(1, 1, 4, 10),\n  end =  c(6, 3, 8, 10)\n)\nir\n#&gt; IRanges object with 4 ranges and 0 metadata columns:\n#&gt;           start       end     width\n#&gt;       &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;\n#&gt;   [1]         1         6         6\n#&gt;   [2]         1         3         3\n#&gt;   [3]         4         8         5\n#&gt;   [4]        10        10         1\ndisjoin(ir)\n#&gt; IRanges object with 4 ranges and 0 metadata columns:\n#&gt;           start       end     width\n#&gt;       &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;\n#&gt;   [1]         1         3         3\n#&gt;   [2]         4         6         3\n#&gt;   [3]         7         8         2\n#&gt;   [4]        10        10         1\n\ndisjointBins(IRanges(start(ir), end(ir) + 1)) # 1,2,3,1 放于第1，2，3，1层\n#&gt; [1] 1 2 3 1\ndisjointBins(IRanges(start(disjoin(ir)), end(disjoin(ir)) + 1)) #放于第1，2，1，1层\n#&gt; [1] 1 2 1 1\n\npar(mfrow = c(2,1))\nplotRanges(ir)\nplotRanges(disjoin(ir))\n\n\n\n\n\n\n\n\n2.3.2 GenomicRanges\nGRanges：用于表示基因组（染色体）范围的数据结构，例如Promoters，Genes，SNPs，CpG Islands，……\n\nCodelibrary(GenomicRanges)\n# help(\"GRanges-class\")\n\nset.seed(10)\nGranges &lt;- GRanges(\n  seqnames = Rle( values =  c('chr1', 'chr2', 'chr3'), lengths =  c(3, 3, 3)),\n  ranges = IRanges(start = seq(1,18,2), width = 3),\n  strand = rep(c(\"+\",\"-\",\"*\"),each=3),\n  score = 101:109,\n  GC = runif(9)\n)\nGranges\n#&gt; GRanges object with 9 ranges and 2 metadata columns:\n#&gt;       seqnames    ranges strand |     score        GC\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;numeric&gt;\n#&gt;   [1]     chr1       1-3      + |       101  0.507478\n#&gt;   [2]     chr1       3-5      + |       102  0.306769\n#&gt;   [3]     chr1       5-7      + |       103  0.426908\n#&gt;   [4]     chr2       7-9      - |       104  0.693102\n#&gt;   [5]     chr2      9-11      - |       105  0.085136\n#&gt;   [6]     chr2     11-13      - |       106  0.225437\n#&gt;   [7]     chr3     13-15      * |       107  0.274531\n#&gt;   [8]     chr3     15-17      * |       108  0.272305\n#&gt;   [9]     chr3     17-19      * |       109  0.615829\n#&gt;   -------\n#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths\n\n\n\nCodesort(Granges)\n#&gt; GRanges object with 9 ranges and 2 metadata columns:\n#&gt;       seqnames    ranges strand |     score        GC\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;integer&gt; &lt;numeric&gt;\n#&gt;   [1]     chr1       1-3      + |       101  0.507478\n#&gt;   [2]     chr1       3-5      + |       102  0.306769\n#&gt;   [3]     chr1       5-7      + |       103  0.426908\n#&gt;   [4]     chr2       7-9      - |       104  0.693102\n#&gt;   [5]     chr2      9-11      - |       105  0.085136\n#&gt;   [6]     chr2     11-13      - |       106  0.225437\n#&gt;   [7]     chr3     13-15      * |       107  0.274531\n#&gt;   [8]     chr3     15-17      * |       108  0.272305\n#&gt;   [9]     chr3     17-19      * |       109  0.615829\n#&gt;   -------\n#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths\n\nvalues(Granges) &lt;- DataFrame(score = rnorm(9), GC = runif(9))\nGranges\n#&gt; GRanges object with 9 ranges and 2 metadata columns:\n#&gt;       seqnames    ranges strand |     score        GC\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt;\n#&gt;   [1]     chr1       1-3      + | -0.177211 0.2395891\n#&gt;   [2]     chr1       3-5      + |  0.170618 0.7707715\n#&gt;   [3]     chr1       5-7      + |  0.242814 0.3558977\n#&gt;   [4]     chr2       7-9      - | -0.179406 0.5355970\n#&gt;   [5]     chr2      9-11      - | -0.630519 0.0930881\n#&gt;   [6]     chr2     11-13      - |  0.978693 0.1698030\n#&gt;   [7]     chr3     13-15      * |  0.293297 0.8998325\n#&gt;   [8]     chr3     15-17      * | -0.370329 0.4226376\n#&gt;   [9]     chr3     17-19      * |  0.543615 0.7477465\n#&gt;   -------\n#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths\n\n\nflank(x, width, start = TRUE, both = FALSE) 用于在基因组范围对象 (GRanges) 上扩展或调整范围。它会基于输入的基因组范围返回其上游或下游的邻近区域。flanking sequence\n\n\nx: 一个 GRanges 对象。\n\nwidth: 你想要的上下游区域的宽度（如上例中的 5）。\n\nstart: 这个参数决定了是否使用起始端（TRUE）还是结束端（FALSE）来生成上下游区域。如果你的基因组是正链，start = TRUE 表示上游。如果是负链，start = TRUE 则表示下游。默认为 TRUE。\n\nboth: 如果设置为 TRUE，则会在范围的两端生成 width 宽度的区域。\n\n\nCodeflank(Granges,5)\n#&gt; GRanges object with 9 ranges and 2 metadata columns:\n#&gt;       seqnames    ranges strand |     score        GC\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt;\n#&gt;   [1]     chr1      -4-0      + | -0.177211 0.2395891\n#&gt;   [2]     chr1      -2-2      + |  0.170618 0.7707715\n#&gt;   [3]     chr1       0-4      + |  0.242814 0.3558977\n#&gt;   [4]     chr2     10-14      - | -0.179406 0.5355970\n#&gt;   [5]     chr2     12-16      - | -0.630519 0.0930881\n#&gt;   [6]     chr2     14-18      - |  0.978693 0.1698030\n#&gt;   [7]     chr3      8-12      * |  0.293297 0.8998325\n#&gt;   [8]     chr3     10-14      * | -0.370329 0.4226376\n#&gt;   [9]     chr3     12-16      * |  0.543615 0.7477465\n#&gt;   -------\n#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths\n\n\npromoters(x, upstream = 2000, downstream = 200) 通常用于提取基因的启动子区域（promoter regions）。在基因组分析中，启动子区域是靠近基因起始位点的区域，通常被认为是调控基因表达的关键区域。启动子区域是基于基因组范围的起始位置提取的，上游（upstream）和下游（downstream）的长度可以自定义。\n\nCodepromoters(Granges)\n#&gt; GRanges object with 9 ranges and 2 metadata columns:\n#&gt;       seqnames    ranges strand |     score        GC\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt; &lt;numeric&gt;\n#&gt;   [1]     chr1 -1999-200      + | -0.177211 0.2395891\n#&gt;   [2]     chr1 -1997-202      + |  0.170618 0.7707715\n#&gt;   [3]     chr1 -1995-204      + |  0.242814 0.3558977\n#&gt;   [4]     chr2 -190-2009      - | -0.179406 0.5355970\n#&gt;   [5]     chr2 -188-2011      - | -0.630519 0.0930881\n#&gt;   [6]     chr2 -186-2013      - |  0.978693 0.1698030\n#&gt;   [7]     chr3 -1987-212      * |  0.293297 0.8998325\n#&gt;   [8]     chr3 -1985-214      * | -0.370329 0.4226376\n#&gt;   [9]     chr3 -1983-216      * |  0.543615 0.7477465\n#&gt;   -------\n#&gt;   seqinfo: 3 sequences from an unspecified genome; no seqlengths\n\n\n\nCodelibrary(GenomeInfoDb)\n\ngenome(Granges) &lt;- \"hg19\"\n\nseqinfo(Granges)\n#&gt; Seqinfo object with 3 sequences from hg19 genome; no seqlengths:\n#&gt;   seqnames seqlengths isCircular genome\n#&gt;   chr1             NA         NA   hg19\n#&gt;   chr2             NA         NA   hg19\n#&gt;   chr3             NA         NA   hg19\nseqlevels(Granges)\n#&gt; [1] \"chr1\" \"chr2\" \"chr3\"\nseqlengths(Granges)\n#&gt; chr1 chr2 chr3 \n#&gt;   NA   NA   NA\n\n\ngaps(x)用于计算给定的 GRanges 对象中缺失（gaps）的基因组区域。它返回的是不被输入的 GRanges 对象覆盖的范围（即空白区域），通常用于确定在某些染色体区域中没有基因或特征的部分。\n\nCodegaps(Granges)\n#&gt; GRanges object with 2 ranges and 0 metadata columns:\n#&gt;       seqnames    ranges strand\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   [1]     chr2       1-6      -\n#&gt;   [2]     chr3      1-12      *\n#&gt;   -------\n#&gt;   seqinfo: 3 sequences from hg19 genome; no seqlengths\n\n\n\nCodelibrary(gggenes)\nGranges %&gt;% as.data.frame() %&gt;% \n  rownames_to_column(var = \"gene\") %&gt;% \n  ggplot(aes(xmin = start, xmax= end,y =seqnames,fill = gene))+\n  geom_gene_arrow()+\n  facet_wrap(~ seqnames, scales = \"free\", ncol = 1) +\n  scale_fill_brewer(palette = \"Set3\")+\n  theme_genes()\n\n\n\n\n\n\n\n\nCode\ngr1 &lt;- GRanges(seqnames = \"chr1\", \n               ranges = IRanges(start = c(1, 20), end = c(10, 30)))\ngr2 &lt;- GRanges(seqnames = \"chr1\", \n               ranges = IRanges(start = c(5, 25), end = c(15, 35)))\ngr1\n#&gt; GRanges object with 2 ranges and 0 metadata columns:\n#&gt;       seqnames    ranges strand\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   [1]     chr1      1-10      *\n#&gt;   [2]     chr1     20-30      *\n#&gt;   -------\n#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths\ngr2\n#&gt; GRanges object with 2 ranges and 0 metadata columns:\n#&gt;       seqnames    ranges strand\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   [1]     chr1      5-15      *\n#&gt;   [2]     chr1     25-35      *\n#&gt;   -------\n#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths\nGenomicRanges::setdiff(gr1, gr2)\n#&gt; GRanges object with 2 ranges and 0 metadata columns:\n#&gt;       seqnames    ranges strand\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   [1]     chr1       1-4      *\n#&gt;   [2]     chr1     20-24      *\n#&gt;   -------\n#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths\n\nfindOverlaps(gr1,gr2)\n#&gt; Hits object with 2 hits and 0 metadata columns:\n#&gt;       queryHits subjectHits\n#&gt;       &lt;integer&gt;   &lt;integer&gt;\n#&gt;   [1]         1           1\n#&gt;   [2]         2           2\n#&gt;   -------\n#&gt;   queryLength: 2 / subjectLength: 2\n\nsubsetByOverlaps(gr1, gr2)\n#&gt; GRanges object with 2 ranges and 0 metadata columns:\n#&gt;       seqnames    ranges strand\n#&gt;          &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   [1]     chr1      1-10      *\n#&gt;   [2]     chr1     20-30      *\n#&gt;   -------\n#&gt;   seqinfo: 1 sequence from an unspecified genome; no seqlengths",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>生物数据结构</span>"
    ]
  },
  {
    "objectID": "annotation_database.html",
    "href": "annotation_database.html",
    "title": "\n3  注释数据库\n",
    "section": "",
    "text": "3.1 BioMart\nhttps://bioconductor.org/packages/release/workflows/html/annotation.html\n即Ensembl ID\n查找智人（homo sapien）基因组\nhttps://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/accessing_ensembl.html#introduction\nCode# BiocManager::install(\"biomaRt\")\nlibrary(biomaRt)\n\nlistEnsembl()\n\n\n\n\nbiomart\nversion\n\n\n\ngenes\nEnsembl Genes 113\n\n\nmouse_strains\nMouse strains 113\n\n\nsnps\nEnsembl Variation 113\n\n\nregulation\nEnsembl Regulation 113\n\n\n\n\n\nCode\n# 连接到Ensembl BioMart\nensembl &lt;- useEnsembl(biomart = \"genes\")\nensembl\n#&gt; Object of class 'Mart':\n#&gt;   Using the ENSEMBL_MART_ENSEMBL BioMart database\n#&gt;   No dataset selected.\n\n# 列出数据集\nlistDatasets(ensembl) |&gt; as_tibble()\n\n\n\n\n\n\n\n\n\ndataset\ndescription\nversion\n\n\n\nabrachyrhynchus_gene_ensembl\nPink-footed goose genes (ASM259213v1)\nASM259213v1\n\n\nacalliptera_gene_ensembl\nEastern happy genes (fAstCal1.3)\nfAstCal1.3\n\n\nacarolinensis_gene_ensembl\nGreen anole genes (AnoCar2.0v2)\nAnoCar2.0v2\n\n\nacchrysaetos_gene_ensembl\nGolden eagle genes (bAquChr1.2)\nbAquChr1.2\n\n\nacitrinellus_gene_ensembl\nMidas cichlid genes (Midas_v5)\nMidas_v5\n\n\namelanoleuca_gene_ensembl\nGiant panda genes (ASM200744v2)\nASM200744v2\n\n\namexicanus_gene_ensembl\nMexican tetra genes (Astyanax_mexicanus-2.0)\nAstyanax_mexicanus-2.0\n\n\nanancymaae_gene_ensembl\nMa’s night monkey genes (Anan_2.0)\nAnan_2.0\n\n\naocellaris_gene_ensembl\nClown anemonefish genes (ASM2253959v1)\nASM2253959v1\n\n\napercula_gene_ensembl\nOrange clownfish genes (Nemo_v1)\nNemo_v1\n\n\naplatyrhynchos_gene_ensembl\nMallard genes (ASM874695v1)\nASM874695v1\n\n\napolyacanthus_gene_ensembl\nSpiny chromis genes (ASM210954v1)\nASM210954v1\n\n\napplatyrhynchos_gene_ensembl\nDuck genes (CAU_duck1.0)\nCAU_duck1.0\n\n\natestudineus_gene_ensembl\nClimbing perch genes (fAnaTes1.3)\nfAnaTes1.3\n\n\nbbbison_gene_ensembl\nAmerican bison genes (Bison_UMD1.0)\nBison_UMD1.0\n\n\nbgrunniens_gene_ensembl\nDomestic yak genes (LU_Bosgru_v3.0)\nLU_Bosgru_v3.0\n\n\nbihybrid_gene_ensembl\nHybrid - Bos Indicus genes (UOA_Brahman_1)\nUOA_Brahman_1\n\n\nbmusculus_gene_ensembl\nBlue whale genes (mBalMus1.v2)\nmBalMus1.v2\n\n\nbmutus_gene_ensembl\nWild yak genes (BosGru_v2.0)\nBosGru_v2.0\n\n\nbsplendens_gene_ensembl\nSiamese fighting fish genes (fBetSpl5.2)\nfBetSpl5.2\n\n\nbtaurus_gene_ensembl\nCow genes (ARS-UCD1.3)\nARS-UCD1.3\n\n\ncabingdonii_gene_ensembl\nAbingdon island giant tortoise genes (ASM359739v1)\nASM359739v1\n\n\ncatys_gene_ensembl\nSooty mangabey genes (Caty_1.0)\nCaty_1.0\n\n\ncauratus_gene_ensembl\nGoldfish genes (ASM336829v1)\nASM336829v1\n\n\ncccarpio_gene_ensembl\nCommon carp genes (Cypcar_WagV4.0)\nCypcar_WagV4.0\n\n\ncdromedarius_gene_ensembl\nArabian camel genes (CamDro2)\nCamDro2\n\n\ncelegans_gene_ensembl\nCaenorhabditis elegans (Nematode, N2) genes (WBcel235)\nWBcel235\n\n\ncgchok1gshd_gene_ensembl\nChinese hamster CHOK1GS genes (CHOK1GS_HDv1)\nCHOK1GS_HDv1\n\n\ncgobio_gene_ensembl\nChannel bull blenny genes (fCotGob3.1)\nfCotGob3.1\n\n\ncharengus_gene_ensembl\nAtlantic herring genes (Ch_v2.0.2v2)\nCh_v2.0.2v2\n\n\nchircus_gene_ensembl\nGoat genes (ARS1)\nARS1\n\n\nchoffmanni_gene_ensembl\nSloth genes (choHof1)\nchoHof1\n\n\nchyarkandensis_gene_ensembl\nYarkand deer genes (CEY_v1)\nCEY_v1\n\n\ncimitator_gene_ensembl\nPanamanian white-faced capuchin genes (Cebus_imitator-1.0)\nCebus_imitator-1.0\n\n\ncintestinalis_gene_ensembl\nC.intestinalis genes (KH)\nKH\n\n\ncjacchus_gene_ensembl\nWhite-tufted-ear marmoset genes (mCalJac1.pat.X)\nmCalJac1.pat.X\n\n\ncjaponica_gene_ensembl\nJapanese quail genes (Coturnix_japonica_2.0)\nCoturnix_japonica_2.0\n\n\nclanigera_gene_ensembl\nLong-tailed chinchilla genes (ChiLan1.0)\nChiLan1.0\n\n\ncldingo_gene_ensembl\nDingo genes (ASM325472v1)\nASM325472v1\n\n\nclfamiliaris_gene_ensembl\nDog genes (ROS_Cfam_1.0)\nROS_Cfam_1.0\n\n\nclumpus_gene_ensembl\nLumpfish genes (fCycLum1.pri)\nfCycLum1.pri\n\n\ncmilii_gene_ensembl\nElephant shark genes (Callorhinchus_milii-6.1.3)\nCallorhinchus_milii-6.1.3\n\n\ncpbellii_gene_ensembl\nPainted turtle genes (Chrysemys_picta_bellii-3.0.3)\nChrysemys_picta_bellii-3.0.3\n\n\ncporcellus_gene_ensembl\nGuinea Pig genes (Cavpor3.0)\nCavpor3.0\n\n\ncporosus_gene_ensembl\nAustralian saltwater crocodile genes (CroPor_comp1)\nCroPor_comp1\n\n\ncsabaeus_gene_ensembl\nVervet-AGM genes (ChlSab1.1)\nChlSab1.1\n\n\ncsavignyi_gene_ensembl\nC.savignyi genes (CSAV 2.0)\nCSAV 2.0\n\n\ncsemilaevis_gene_ensembl\nTongue sole genes (Cse_v1.0)\nCse_v1.0\n\n\ncsyrichta_gene_ensembl\nTarsier genes (Tarsius_syrichta-2.0.1)\nTarsius_syrichta-2.0.1\n\n\ncvariegatus_gene_ensembl\nSheepshead minnow genes (C_variegatus-1.0)\nC_variegatus-1.0\n\n\ncwagneri_gene_ensembl\nChacoan peccary genes (CatWag_v2_BIUU_UCD)\nCatWag_v2_BIUU_UCD\n\n\ndclupeoides_gene_ensembl\nDenticle herring genes (fDenClu1.2)\nfDenClu1.2\n\n\ndlabrax_gene_ensembl\nEuropean seabass genes (dlabrax2021)\ndlabrax2021\n\n\ndleucas_gene_ensembl\nBeluga whale genes (ASM228892v3)\nASM228892v3\n\n\ndmelanogaster_gene_ensembl\nDrosophila melanogaster (Fruit fly) genes (BDGP6.46)\nBDGP6.46\n\n\ndnovemcinctus_gene_ensembl\nArmadillo genes (Dasnov3.0)\nDasnov3.0\n\n\ndordii_gene_ensembl\nKangaroo rat genes (Dord_2.0)\nDord_2.0\n\n\ndrerio_gene_ensembl\nZebrafish genes (GRCz11)\nGRCz11\n\n\neasinus_gene_ensembl\nDonkey genes (ASM1607732v2)\nASM1607732v2\n\n\neburgeri_gene_ensembl\nHagfish genes (Eburgeri_3.2)\nEburgeri_3.2\n\n\necaballus_gene_ensembl\nHorse genes (EquCab3.0)\nEquCab3.0\n\n\necalabaricus_gene_ensembl\nReedfish genes (fErpCal1.1)\nfErpCal1.1\n\n\neelectricus_gene_ensembl\nElectric eel genes (fEleEle1.pri)\nfEleEle1.pri\n\n\neeuropaeus_gene_ensembl\nHedgehog genes (eriEur1)\neriEur1\n\n\nelucius_gene_ensembl\nNorthern pike genes (fEsoLuc1.pri)\nfEsoLuc1.pri\n\n\netelfairi_gene_ensembl\nLesser hedgehog tenrec genes (TENREC)\nTENREC\n\n\nfalbicollis_gene_ensembl\nCollared flycatcher genes (FicAlb1.5)\nFicAlb1.5\n\n\nfcatus_gene_ensembl\nCat genes (Felis_catus_9.0)\nFelis_catus_9.0\n\n\nfheteroclitus_gene_ensembl\nMummichog genes (Fundulus_heteroclitus-3.0.2)\nFundulus_heteroclitus-3.0.2\n\n\ngaculeatus_gene_ensembl\nStickleback genes (GAculeatus_UGA_version5)\nGAculeatus_UGA_version5\n\n\ngevgoodei_gene_ensembl\nGoodes thornscrub tortoise genes (rGopEvg1_v1.p)\nrGopEvg1_v1.p\n\n\ngfortis_gene_ensembl\nMedium ground-finch genes (GeoFor_1.0)\nGeoFor_1.0\n\n\nggallus_gene_ensembl\nChicken genes (bGalGal1.mat.broiler.GRCg7b)\nbGalGal1.mat.broiler.GRCg7b\n\n\nggorilla_gene_ensembl\nGorilla genes (gorGor4)\ngorGor4\n\n\ngmorhua_gene_ensembl\nAtlantic cod genes (gadMor3.0)\ngadMor3.0\n\n\nhburtoni_gene_ensembl\nBurton’s mouthbrooder genes (AstBur1.0)\nAstBur1.0\n\n\nhcomes_gene_ensembl\nTiger tail seahorse genes (H_comes_QL1_v1)\nH_comes_QL1_v1\n\n\nhgfemale_gene_ensembl\nNaked mole-rat female genes (Naked_mole-rat_maternal)\nNaked_mole-rat_maternal\n\n\nhhucho_gene_ensembl\nHuchen genes (ASM331708v1)\nASM331708v1\n\n\nhsapiens_gene_ensembl\nHuman genes (GRCh38.p14)\nGRCh38.p14\n\n\nipunctatus_gene_ensembl\nChannel catfish genes (ASM400665v3)\nASM400665v3\n\n\nitridecemlineatus_gene_ensembl\nSquirrel genes (SpeTri2.0)\nSpeTri2.0\n\n\njjaculus_gene_ensembl\nLesser Egyptian jerboa genes (JacJac1.0)\nJacJac1.0\n\n\nkmarmoratus_gene_ensembl\nMangrove rivulus genes (ASM164957v1)\nASM164957v1\n\n\nlafricana_gene_ensembl\nElephant genes (Loxafr3.0)\nLoxafr3.0\n\n\nlbergylta_gene_ensembl\nBallan wrasse genes (BallGen_V1)\nBallGen_V1\n\n\nlcalcarifer_gene_ensembl\nBarramundi perch genes (ASB_HGAPassembly_v1)\nASB_HGAPassembly_v1\n\n\nlchalumnae_gene_ensembl\nCoelacanth genes (LatCha1)\nLatCha1\n\n\nlcrocea_gene_ensembl\nLarge yellow croaker genes (L_crocea_2.0)\nL_crocea_2.0\n\n\nllaticaudata_gene_ensembl\nBlue-ringed sea krait genes (latLat_1.0)\nlatLat_1.0\n\n\nlleishanense_gene_ensembl\nLeishan spiny toad genes (ASM966780v1)\nASM966780v1\n\n\nloculatus_gene_ensembl\nSpotted gar genes (LepOcu1)\nLepOcu1\n\n\nmarmatus_gene_ensembl\nZig-zag eel genes (fMasArm1.2)\nfMasArm1.2\n\n\nmauratus_gene_ensembl\nGolden Hamster genes (MesAur1.0)\nMesAur1.0\n\n\nmcaroli_gene_ensembl\nRyukyu mouse genes (CAROLI_EIJ_v1.1)\nCAROLI_EIJ_v1.1\n\n\nmdomestica_gene_ensembl\nOpossum genes (ASM229v1)\nASM229v1\n\n\nmfascicularis_gene_ensembl\nCrab-eating macaque genes (Macaca_fascicularis_6.0)\nMacaca_fascicularis_6.0\n\n\nmgallopavo_gene_ensembl\nTurkey genes (Turkey_5.1)\nTurkey_5.1\n\n\nmleucophaeus_gene_ensembl\nDrill genes (Mleu.le_1.0)\nMleu.le_1.0\n\n\nmlucifugus_gene_ensembl\nMicrobat genes (Myoluc2.0)\nMyoluc2.0\n\n\nmmmarmota_gene_ensembl\nAlpine marmot genes (marMar2.1)\nmarMar2.1\n\n\nmmonoceros_gene_ensembl\nNarwhal genes (NGI_Narwhal_1)\nNGI_Narwhal_1\n\n\nmmoschiferus_gene_ensembl\nSiberian musk deer genes (MosMos_v2_BIUU_UCD)\nMosMos_v2_BIUU_UCD\n\n\nmmulatta_gene_ensembl\nMacaque genes (Mmul_10)\nMmul_10\n\n\nmmurdjan_gene_ensembl\nPinecone soldierfish genes (fMyrMur1.1)\nfMyrMur1.1\n\n\nmmurinus_gene_ensembl\nMouse Lemur genes (Mmur_3.0)\nMmur_3.0\n\n\nmmusculus_gene_ensembl\nMouse genes (GRCm39)\nGRCm39\n\n\nmnemestrina_gene_ensembl\nPig-tailed macaque genes (Mnem_1.0)\nMnem_1.0\n\n\nmochrogaster_gene_ensembl\nPrairie vole genes (MicOch1.0)\nMicOch1.0\n\n\nmpahari_gene_ensembl\nShrew mouse genes (PAHARI_EIJ_v1.1)\nPAHARI_EIJ_v1.1\n\n\nmpfuro_gene_ensembl\nFerret genes (MusPutFur1.0)\nMusPutFur1.0\n\n\nmspicilegus_gene_ensembl\nSteppe mouse genes (MUSP714)\nMUSP714\n\n\nmspretus_gene_ensembl\nAlgerian mouse genes (SPRET_EiJ_v1)\nSPRET_EiJ_v1\n\n\nmzebra_gene_ensembl\nZebra mbuna genes (M_zebra_UMD2a)\nM_zebra_UMD2a\n\n\nnbrichardi_gene_ensembl\nLyretail cichlid genes (NeoBri1.0)\nNeoBri1.0\n\n\nneugenii_gene_ensembl\nWallaby genes (Meug_1.0)\nMeug_1.0\n\n\nnfurzeri_gene_ensembl\nTurquoise killifish genes (Nfu_20140520)\nNfu_20140520\n\n\nngalili_gene_ensembl\nUpper Galilee mountains blind mole rat genes (S.galili_v1.0)\nS.galili_v1.0\n\n\nnleucogenys_gene_ensembl\nGibbon genes (Nleu_3.0)\nNleu_3.0\n\n\nnnaja_gene_ensembl\nIndian cobra genes (Nana_v5)\nNana_v5\n\n\nnscutatus_gene_ensembl\nMainland tiger snake genes (TS10Xv2-PRI)\nTS10Xv2-PRI\n\n\nnvison_gene_ensembl\nAmerican mink genes (NNQGG.v01)\nNNQGG.v01\n\n\nodegus_gene_ensembl\nDegu genes (OctDeg1.0)\nOctDeg1.0\n\n\nokisutch_gene_ensembl\nCoho salmon genes (Okis_V2)\nOkis_V2\n\n\noprinceps_gene_ensembl\nPika genes (OchPri2.0-Ens)\nOchPri2.0-Ens\n\n\n\n\n\nCode\n# 查找智人\nsearchDatasets(mart = ensembl, pattern = \"hsapiens\")\n\n\n\n\n\ndataset\ndescription\nversion\n\n\n80\nhsapiens_gene_ensembl\nHuman genes (GRCh38.p14)\nGRCh38.p14\n\n\n\n\nCode\n# 选择数据集\ndataset &lt;- useDataset(dataset = \"hsapiens_gene_ensembl\", mart = ensembl)\ndataset\n#&gt; Object of class 'Mart':\n#&gt;   Using the ENSEMBL_MART_ENSEMBL BioMart database\n#&gt;   Using the hsapiens_gene_ensembl dataset\nGRCh38（Genome Research Consortium human genome build 38）\nCode# 人类基因BioMart\nensembl &lt;- useEnsembl(biomart = \"ensembl\", \n                   dataset = \"hsapiens_gene_ensembl\", \n                   mirror = \"asia\")",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>注释数据库</span>"
    ]
  },
  {
    "objectID": "annotation_database.html#biomart",
    "href": "annotation_database.html#biomart",
    "title": "\n3  注释数据库\n",
    "section": "",
    "text": "3.1.1 映射\n\nCodelistMarts()\n\n\n\n\nbiomart\nversion\n\n\n\nENSEMBL_MART_ENSEMBL\nEnsembl Genes 113\n\n\nENSEMBL_MART_MOUSE\nMouse strains 113\n\n\nENSEMBL_MART_SNP\nEnsembl Variation 113\n\n\nENSEMBL_MART_FUNCGEN\nEnsembl Regulation 113\n\n\n\n\n\nCode# 连接到Ensembl BioMart\nmart &lt;- useMart(\"ENSEMBL_MART_ENSEMBL\", dataset = \"hsapiens_gene_ensembl\")\nlistAttributes(mart) %&gt;% DT::datatable()\n\n\n\n\nCode\n\n\n\ngene_ids &lt;- c(\"1017\", \"1018\", \"1019\")  \n\ngetBM(attributes = c(\"entrezgene_id\", \"ensembl_gene_id\", \"external_gene_name\"),\n                  filters = \"entrezgene_id\",\n                  values = gene_ids,\n                  mart = mart)\n\n\n\n\nentrezgene_id\nensembl_gene_id\nexternal_gene_name\n\n\n\n1017\nENSG00000123374\nCDK2\n\n\n1018\nENSG00000250506\nCDK3\n\n\n1019\nENSG00000135446\nCDK4\n\n\n\n\n\n\n\n3.1.2 使用 Ensembl 的存档版本\n\n\nCodelistEnsemblArchives()\nlistEnsembl(version = 112)\nensembl_112 &lt;- useEnsembl(biomart = 'genes', \n                       dataset = 'hsapiens_gene_ensembl',\n                       mirror = \"asia\",\n                       version = 112)\n\n\n\n3.1.3 使用 Ensembl 基因组\n\n\nCodelistEnsemblGenomes()\n\n\n\n\nbiomart\nversion\n\n\n\nprotists_mart\nEnsembl Protists Genes 60\n\n\nprotists_variations\nEnsembl Protists Variations 60\n\n\nfungi_mart\nEnsembl Fungi Genes 60\n\n\nfungi_variations\nEnsembl Fungi Variations 60\n\n\nmetazoa_mart\nEnsembl Metazoa Genes 60\n\n\nmetazoa_variations\nEnsembl Metazoa Variations 60\n\n\nplants_mart\nEnsembl Plants Genes 60\n\n\nplants_variations\nEnsembl Plants Variations 60\n\n\n\n\n\nCodeensembl_plants &lt;- useEnsemblGenomes(biomart = \"plants_mart\")\nsearchDatasets(ensembl_plants, pattern = \"Arabidopsis\")\n\n\n\n\n\ndataset\ndescription\nversion\n\n\n\n4\nahalleri_eg_gene\nArabidopsis halleri genes (Ahal2.2)\nAhal2.2\n\n\n6\nalyrata_eg_gene\nArabidopsis lyrata genes (v.1.0)\nv.1.0\n\n\n11\nathaliana_eg_gene\nArabidopsis thaliana genes (TAIR10)\nTAIR10\n\n\n\n\n\nCodeensembl_arabidopsis &lt;- useEnsemblGenomes(biomart = \"plants_mart\", \n                                         dataset = \"athaliana_eg_gene\")",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>注释数据库</span>"
    ]
  },
  {
    "objectID": "annotation_database.html#annotationhub",
    "href": "annotation_database.html#annotationhub",
    "title": "\n3  注释数据库\n",
    "section": "\n3.2 AnnotationHub\n",
    "text": "3.2 AnnotationHub\n\n基于annotationhub构建所需orgdb，用于clusterprofiler富集分析\n\nCodesuppressMessages(library(AnnotationHub))\nconflicts_prefer(BiocGenerics::setdiff)\n# proxy &lt;- httr::use_proxy(Sys.getenv('http_proxy'))\n# httr::set_config(proxy)\n# AnnotationHub::setAnnotationHubOption(\"PROXY\", proxy)\n\nah &lt;- AnnotationHub(cache = \"D:/AnnotationHub\")\nah\n#&gt; AnnotationHub with 72098 records\n#&gt; # snapshotDate(): 2024-10-28\n#&gt; # $dataprovider: Ensembl, BroadInstitute, UCSC, ftp://ftp.ncbi.nlm.nih.gov/g...\n#&gt; # $species: Homo sapiens, Mus musculus, Drosophila melanogaster, Rattus norv...\n#&gt; # $rdataclass: GRanges, TwoBitFile, BigWigFile, EnsDb, Rle, OrgDb, SQLiteFil...\n#&gt; # additional mcols(): taxonomyid, genome, description,\n#&gt; #   coordinate_1_based, maintainer, rdatadateadded, preparerclass, tags,\n#&gt; #   rdatapath, sourceurl, sourcetype \n#&gt; # retrieve records with, e.g., 'object[[\"AH5012\"]]' \n#&gt; \n#&gt;              title                                             \n#&gt;   AH5012   | Chromosome Band                                   \n#&gt;   AH5013   | STS Markers                                       \n#&gt;   AH5014   | FISH Clones                                       \n#&gt;   AH5015   | Recomb Rate                                       \n#&gt;   AH5016   | ENCODE Pilot                                      \n#&gt;   ...        ...                                               \n#&gt;   AH119504 | Ensembl 113 EnsDb for Xiphophorus maculatus       \n#&gt;   AH119505 | Ensembl 113 EnsDb for Xenopus tropicalis          \n#&gt;   AH119506 | Ensembl 113 EnsDb for Zonotrichia albicollis      \n#&gt;   AH119507 | Ensembl 113 EnsDb for Zalophus californianus      \n#&gt;   AH119508 | Ensembl 113 EnsDb for Zosterops lateralis melanops\n\n\n\nCode# 当前可用数据的更新时间\nsnapshotDate(ah)\n#&gt; [1] \"2024-10-28\"\n\n# 缓存路径\nhubCache(ah)\n#&gt; [1] \"D:/AnnotationHub\"\n\n# https://annotationhub.bioconductor.org\nhubUrl(ah)\n#&gt; [1] \"https://annotationhub.bioconductor.org\"\nisLocalHub(ah)\n#&gt; [1] FALSE\ndbconn(ah)\n#&gt; &lt;SQLiteConnection&gt;\n#&gt;   Path: D:\\AnnotationHub\\39283aec6c3b_annotationhub.sqlite3\n#&gt;   Extensions: TRUE\n\n\n\nCodelength(ah)\n#&gt; [1] 72098\nah$dataprovider |&gt; unique()\n#&gt;  [1] \"UCSC\"                                                                                                      \n#&gt;  [2] \"Ensembl\"                                                                                                   \n#&gt;  [3] \"RefNet\"                                                                                                    \n#&gt;  [4] \"Inparanoid8\"                                                                                               \n#&gt;  [5] \"NHLBI\"                                                                                                     \n#&gt;  [6] \"ChEA\"                                                                                                      \n#&gt;  [7] \"Pazar\"                                                                                                     \n#&gt;  [8] \"NIH Pathway Interaction Database\"                                                                          \n#&gt;  [9] \"Haemcode\"                                                                                                  \n#&gt; [10] \"BroadInstitute\"                                                                                            \n#&gt; [11] \"PRIDE\"                                                                                                     \n#&gt; [12] \"Gencode\"                                                                                                   \n#&gt; [13] \"CRIBI\"                                                                                                     \n#&gt; [14] \"Genoscope\"                                                                                                 \n#&gt; [15] \"MISO, VAST-TOOLS, UCSC\"                                                                                    \n#&gt; [16] \"Stanford\"                                                                                                  \n#&gt; [17] \"dbSNP\"                                                                                                     \n#&gt; [18] \"BioMart\"                                                                                                   \n#&gt; [19] \"GeneOntology\"                                                                                              \n#&gt; [20] \"KEGG\"                                                                                                      \n#&gt; [21] \"URGI\"                                                                                                      \n#&gt; [22] \"EMBL-EBI\"                                                                                                  \n#&gt; [23] \"MicrosporidiaDB\"                                                                                           \n#&gt; [24] \"FungiDB\"                                                                                                   \n#&gt; [25] \"TriTrypDB\"                                                                                                 \n#&gt; [26] \"ToxoDB\"                                                                                                    \n#&gt; [27] \"AmoebaDB\"                                                                                                  \n#&gt; [28] \"PlasmoDB\"                                                                                                  \n#&gt; [29] \"PiroplasmaDB\"                                                                                              \n#&gt; [30] \"CryptoDB\"                                                                                                  \n#&gt; [31] \"TrichDB\"                                                                                                   \n#&gt; [32] \"GiardiaDB\"                                                                                                 \n#&gt; [33] \"The Gene Ontology Consortium\"                                                                              \n#&gt; [34] \"ENCODE Project\"                                                                                            \n#&gt; [35] \"SchistoDB\"                                                                                                 \n#&gt; [36] \"NCBI/UniProt\"                                                                                              \n#&gt; [37] \"GENCODE\"                                                                                                   \n#&gt; [38] \"http://www.pantherdb.org\"                                                                                  \n#&gt; [39] \"RMBase v2.0\"                                                                                               \n#&gt; [40] \"snoRNAdb\"                                                                                                  \n#&gt; [41] \"tRNAdb\"                                                                                                    \n#&gt; [42] \"NCBI\"                                                                                                      \n#&gt; [43] \"DrugAge, DrugBank, Broad Institute\"                                                                        \n#&gt; [44] \"DrugAge\"                                                                                                   \n#&gt; [45] \"DrugBank\"                                                                                                  \n#&gt; [46] \"Broad Institute\"                                                                                           \n#&gt; [47] \"HMDB, EMBL-EBI, EPA\"                                                                                       \n#&gt; [48] \"STRING\"                                                                                                    \n#&gt; [49] \"OMA\"                                                                                                       \n#&gt; [50] \"OrthoDB\"                                                                                                   \n#&gt; [51] \"PathBank\"                                                                                                  \n#&gt; [52] \"EBI/EMBL\"                                                                                                  \n#&gt; [53] \"NCBI,DBCLS\"                                                                                                \n#&gt; [54] \"FANTOM5,DLRP,IUPHAR,HPRD,STRING,SWISSPROT,TREMBL,ENSEMBL,CELLPHONEDB,BADERLAB,SINGLECELLSIGNALR,HOMOLOGENE\"\n#&gt; [55] \"WikiPathways\"                                                                                              \n#&gt; [56] \"VAST-TOOLS\"                                                                                                \n#&gt; [57] \"pyGenomeTracks \"                                                                                           \n#&gt; [58] \"NA\"                                                                                                        \n#&gt; [59] \"UoE\"                                                                                                       \n#&gt; [60] \"TargetScan,miRTarBase,USCS,ENSEMBL\"                                                                        \n#&gt; [61] \"TargetScan\"                                                                                                \n#&gt; [62] \"QuickGO\"                                                                                                   \n#&gt; [63] \"CIS-BP\"                                                                                                    \n#&gt; [64] \"CTCFBSDB 2.0\"                                                                                              \n#&gt; [65] \"HOCOMOCO v11\"                                                                                              \n#&gt; [66] \"JASPAR 2022\"                                                                                               \n#&gt; [67] \"Jolma 2013\"                                                                                                \n#&gt; [68] \"SwissRegulon\"                                                                                              \n#&gt; [69] \"ENCODE SCREEN v3\"                                                                                          \n#&gt; [70] \"MassBank\"                                                                                                  \n#&gt; [71] \"excluderanges\"                                                                                             \n#&gt; [72] \"ENCODE\"                                                                                                    \n#&gt; [73] \"GitHub\"                                                                                                    \n#&gt; [74] \"Stanford.edu\"                                                                                              \n#&gt; [75] \"Publication\"                                                                                               \n#&gt; [76] \"CHM13\"                                                                                                     \n#&gt; [77] \"UCSChub\"                                                                                                   \n#&gt; [78] \"Google DeepMind\"                                                                                           \n#&gt; [79] \"UWashington\"                                                                                               \n#&gt; [80] \"Bioconductor\"                                                                                              \n#&gt; [81] \"ENCODE cCREs\"                                                                                              \n#&gt; [82] \"The Human Phenotype Ontology\"                                                                              \n#&gt; [83] \"MGI\"                                                                                                       \n#&gt; [84] \"ftp://ftp.ncbi.nlm.nih.gov/gene/DATA/\"\n\n\n\nCodeunique(ah$species) %&gt;% as.data.frame() %&gt;% DT::datatable()\n\n\n\n\nCodeunique(ah$rdataclass) \n#&gt;  [1] \"GRanges\"                           \"data.frame\"                       \n#&gt;  [3] \"Inparanoid8Db\"                     \"TwoBitFile\"                       \n#&gt;  [5] \"ChainFile\"                         \"SQLiteConnection\"                 \n#&gt;  [7] \"biopax\"                            \"BigWigFile\"                       \n#&gt;  [9] \"AAStringSet\"                       \"MSnSet\"                           \n#&gt; [11] \"mzRident\"                          \"list\"                             \n#&gt; [13] \"TxDb\"                              \"Rle\"                              \n#&gt; [15] \"EnsDb\"                             \"VcfFile\"                          \n#&gt; [17] \"igraph\"                            \"data.frame, DNAStringSet, GRanges\"\n#&gt; [19] \"sqlite\"                            \"data.table\"                       \n#&gt; [21] \"character\"                         \"SQLite\"                           \n#&gt; [23] \"SQLiteFile\"                        \"Tibble\"                           \n#&gt; [25] \"Rda\"                               \"FaFile\"                           \n#&gt; [27] \"String\"                            \"CompDb\"                           \n#&gt; [29] \"OrgDb\"\n\n\n\n3.2.1 子集\n\nCodeah[ah$dataprovider==\"UCSC\"]\n#&gt; AnnotationHub with 11204 records\n#&gt; # snapshotDate(): 2024-10-28\n#&gt; # $dataprovider: UCSC\n#&gt; # $species: Homo sapiens, Mus musculus, Drosophila melanogaster, Bos taurus,...\n#&gt; # $rdataclass: GRanges, Rle, ChainFile, TxDb, TwoBitFile\n#&gt; # additional mcols(): taxonomyid, genome, description,\n#&gt; #   coordinate_1_based, maintainer, rdatadateadded, preparerclass, tags,\n#&gt; #   rdatapath, sourceurl, sourcetype \n#&gt; # retrieve records with, e.g., 'object[[\"AH5012\"]]' \n#&gt; \n#&gt;              title                                    \n#&gt;   AH5012   | Chromosome Band                          \n#&gt;   AH5013   | STS Markers                              \n#&gt;   AH5014   | FISH Clones                              \n#&gt;   AH5015   | Recomb Rate                              \n#&gt;   AH5016   | ENCODE Pilot                             \n#&gt;   ...        ...                                      \n#&gt;   AH114096 | TxDb.Mmusculus.UCSC.mm39.refGene.sqlite  \n#&gt;   AH116719 | TxDb.Hsapiens.UCSC.hg38.refGene.sqlite   \n#&gt;   AH116720 | TxDb.Mmusculus.UCSC.mm39.refGene.sqlite  \n#&gt;   AH117076 | TxDb.Hsapiens.UCSC.hg38.knownGene.sqlite \n#&gt;   AH117077 | TxDb.Mmusculus.UCSC.mm39.knownGene.sqlite\n\nsubset(ah, species == \"homo sapiens\")\n#&gt; AnnotationHub with 71 records\n#&gt; # snapshotDate(): 2024-10-28\n#&gt; # $dataprovider: Ensembl\n#&gt; # $species: homo sapiens\n#&gt; # $rdataclass: GRanges, TwoBitFile\n#&gt; # additional mcols(): taxonomyid, genome, description,\n#&gt; #   coordinate_1_based, maintainer, rdatadateadded, preparerclass, tags,\n#&gt; #   rdatapath, sourceurl, sourcetype \n#&gt; # retrieve records with, e.g., 'object[[\"AH83649\"]]' \n#&gt; \n#&gt;              title                                           \n#&gt;   AH83649  | Homo_sapiens.GRCh38.101.abinitio.gtf            \n#&gt;   AH83650  | Homo_sapiens.GRCh38.101.chr.gtf                 \n#&gt;   AH83651  | Homo_sapiens.GRCh38.101.chr_patch_hapl_scaff.gtf\n#&gt;   AH83652  | Homo_sapiens.GRCh38.101.gtf                     \n#&gt;   AH84627  | Homo_sapiens.GRCh38.cdna.all.2bit               \n#&gt;   ...        ...                                             \n#&gt;   AH110100 | Homo_sapiens.GRCh38.108.gtf                     \n#&gt;   AH110866 | Homo_sapiens.GRCh38.109.abinitio.gtf            \n#&gt;   AH110867 | Homo_sapiens.GRCh38.109.chr.gtf                 \n#&gt;   AH110868 | Homo_sapiens.GRCh38.109.chr_patch_hapl_scaff.gtf\n#&gt;   AH110869 | Homo_sapiens.GRCh38.109.gtf\n\n\n\n3.2.2 查询\n\nCodequery(ah, c(\"Ensembl\"))\n#&gt; AnnotationHub with 37283 records\n#&gt; # snapshotDate(): 2024-10-28\n#&gt; # $dataprovider: Ensembl, FANTOM5,DLRP,IUPHAR,HPRD,STRING,SWISSPROT,TREMBL,E...\n#&gt; # $species: Mus musculus, Sus scrofa, Homo sapiens, Rattus norvegicus, Danio...\n#&gt; # $rdataclass: TwoBitFile, GRanges, EnsDb, SQLiteFile, data.frame, OrgDb, li...\n#&gt; # additional mcols(): taxonomyid, genome, description,\n#&gt; #   coordinate_1_based, maintainer, rdatadateadded, preparerclass, tags,\n#&gt; #   rdatapath, sourceurl, sourcetype \n#&gt; # retrieve records with, e.g., 'object[[\"AH5046\"]]' \n#&gt; \n#&gt;              title                                             \n#&gt;   AH5046   | Ensembl Genes                                     \n#&gt;   AH5160   | Ensembl Genes                                     \n#&gt;   AH5311   | Ensembl Genes                                     \n#&gt;   AH5434   | Ensembl Genes                                     \n#&gt;   AH5435   | Ensembl EST Genes                                 \n#&gt;   ...        ...                                               \n#&gt;   AH119504 | Ensembl 113 EnsDb for Xiphophorus maculatus       \n#&gt;   AH119505 | Ensembl 113 EnsDb for Xenopus tropicalis          \n#&gt;   AH119506 | Ensembl 113 EnsDb for Zonotrichia albicollis      \n#&gt;   AH119507 | Ensembl 113 EnsDb for Zalophus californianus      \n#&gt;   AH119508 | Ensembl 113 EnsDb for Zosterops lateralis melanops\nquery(ah, c(\"Gencode\"))\n#&gt; AnnotationHub with 5426 records\n#&gt; # snapshotDate(): 2024-10-28\n#&gt; # $dataprovider: UCSC, GENCODE, Gencode, ENCODE, BroadInstitute\n#&gt; # $species: Homo sapiens, Mus musculus, Rattus norvegicus, Pan troglodytes, ...\n#&gt; # $rdataclass: GRanges, list, TxDb, SQLiteConnection\n#&gt; # additional mcols(): taxonomyid, genome, description,\n#&gt; #   coordinate_1_based, maintainer, rdatadateadded, preparerclass, tags,\n#&gt; #   rdatapath, sourceurl, sourcetype \n#&gt; # retrieve records with, e.g., 'object[[\"AH5073\"]]' \n#&gt; \n#&gt;              title                                                \n#&gt;   AH5073   | Affy RNA Loc                                         \n#&gt;   AH5079   | CSHL Small RNA-seq                                   \n#&gt;   AH5080   | GIS RNA PET                                          \n#&gt;   AH5084   | RIKEN CAGE Loc                                       \n#&gt;   AH5088   | SUNY SwitchGear                                      \n#&gt;   ...        ...                                                  \n#&gt;   AH107317 | hg19.Crawford.wgEncodeDukeMapabilityRegionsExcludable\n#&gt;   AH116727 | ENCODE_dELS_regions                                  \n#&gt;   AH116728 | ENCODE_pELS_regions                                  \n#&gt;   AH116729 | ENCODE_PLS_regions                                   \n#&gt;   AH116730 | GENCODE basic gene annotation v40\n\n\n\nCode# Web界面\nBiocHubsShiny::BiocHubsShiny()",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>注释数据库</span>"
    ]
  },
  {
    "objectID": "annotation_database.html#bsgenome",
    "href": "annotation_database.html#bsgenome",
    "title": "\n3  注释数据库\n",
    "section": "\n3.3 BSgenome",
    "text": "3.3 BSgenome\n\nCodelibrary(BSgenome)\nconflicts_prefer(Biostrings::setdiff)\navailable.genomes()\n#&gt;   [1] \"BSgenome.Alyrata.JGI.v1\"                           \n#&gt;   [2] \"BSgenome.Amellifera.BeeBase.assembly4\"             \n#&gt;   [3] \"BSgenome.Amellifera.NCBI.AmelHAv3.1\"               \n#&gt;   [4] \"BSgenome.Amellifera.UCSC.apiMel2\"                  \n#&gt;   [5] \"BSgenome.Amellifera.UCSC.apiMel2.masked\"           \n#&gt;   [6] \"BSgenome.Aofficinalis.NCBI.V1\"                     \n#&gt;   [7] \"BSgenome.Athaliana.TAIR.04232008\"                  \n#&gt;   [8] \"BSgenome.Athaliana.TAIR.TAIR9\"                     \n#&gt;   [9] \"BSgenome.Btaurus.UCSC.bosTau3\"                     \n#&gt;  [10] \"BSgenome.Btaurus.UCSC.bosTau3.masked\"              \n#&gt;  [11] \"BSgenome.Btaurus.UCSC.bosTau4\"                     \n#&gt;  [12] \"BSgenome.Btaurus.UCSC.bosTau4.masked\"              \n#&gt;  [13] \"BSgenome.Btaurus.UCSC.bosTau6\"                     \n#&gt;  [14] \"BSgenome.Btaurus.UCSC.bosTau6.masked\"              \n#&gt;  [15] \"BSgenome.Btaurus.UCSC.bosTau8\"                     \n#&gt;  [16] \"BSgenome.Btaurus.UCSC.bosTau9\"                     \n#&gt;  [17] \"BSgenome.Btaurus.UCSC.bosTau9.masked\"              \n#&gt;  [18] \"BSgenome.Carietinum.NCBI.v1\"                       \n#&gt;  [19] \"BSgenome.Celegans.UCSC.ce10\"                       \n#&gt;  [20] \"BSgenome.Celegans.UCSC.ce11\"                       \n#&gt;  [21] \"BSgenome.Celegans.UCSC.ce2\"                        \n#&gt;  [22] \"BSgenome.Celegans.UCSC.ce6\"                        \n#&gt;  [23] \"BSgenome.Cfamiliaris.UCSC.canFam2\"                 \n#&gt;  [24] \"BSgenome.Cfamiliaris.UCSC.canFam2.masked\"          \n#&gt;  [25] \"BSgenome.Cfamiliaris.UCSC.canFam3\"                 \n#&gt;  [26] \"BSgenome.Cfamiliaris.UCSC.canFam3.masked\"          \n#&gt;  [27] \"BSgenome.Cjacchus.UCSC.calJac3\"                    \n#&gt;  [28] \"BSgenome.Cjacchus.UCSC.calJac4\"                    \n#&gt;  [29] \"BSgenome.CneoformansVarGrubiiKN99.NCBI.ASM221672v1\"\n#&gt;  [30] \"BSgenome.Creinhardtii.JGI.v5.6\"                    \n#&gt;  [31] \"BSgenome.Dmelanogaster.UCSC.dm2\"                   \n#&gt;  [32] \"BSgenome.Dmelanogaster.UCSC.dm2.masked\"            \n#&gt;  [33] \"BSgenome.Dmelanogaster.UCSC.dm3\"                   \n#&gt;  [34] \"BSgenome.Dmelanogaster.UCSC.dm3.masked\"            \n#&gt;  [35] \"BSgenome.Dmelanogaster.UCSC.dm6\"                   \n#&gt;  [36] \"BSgenome.Drerio.UCSC.danRer10\"                     \n#&gt;  [37] \"BSgenome.Drerio.UCSC.danRer11\"                     \n#&gt;  [38] \"BSgenome.Drerio.UCSC.danRer5\"                      \n#&gt;  [39] \"BSgenome.Drerio.UCSC.danRer5.masked\"               \n#&gt;  [40] \"BSgenome.Drerio.UCSC.danRer6\"                      \n#&gt;  [41] \"BSgenome.Drerio.UCSC.danRer6.masked\"               \n#&gt;  [42] \"BSgenome.Drerio.UCSC.danRer7\"                      \n#&gt;  [43] \"BSgenome.Drerio.UCSC.danRer7.masked\"               \n#&gt;  [44] \"BSgenome.Dvirilis.Ensembl.dvircaf1\"                \n#&gt;  [45] \"BSgenome.Ecoli.NCBI.20080805\"                      \n#&gt;  [46] \"BSgenome.Gaculeatus.UCSC.gasAcu1\"                  \n#&gt;  [47] \"BSgenome.Gaculeatus.UCSC.gasAcu1.masked\"           \n#&gt;  [48] \"BSgenome.Ggallus.UCSC.galGal3\"                     \n#&gt;  [49] \"BSgenome.Ggallus.UCSC.galGal3.masked\"              \n#&gt;  [50] \"BSgenome.Ggallus.UCSC.galGal4\"                     \n#&gt;  [51] \"BSgenome.Ggallus.UCSC.galGal4.masked\"              \n#&gt;  [52] \"BSgenome.Ggallus.UCSC.galGal5\"                     \n#&gt;  [53] \"BSgenome.Ggallus.UCSC.galGal6\"                     \n#&gt;  [54] \"BSgenome.Gmax.NCBI.Gmv40\"                          \n#&gt;  [55] \"BSgenome.Hsapiens.1000genomes.hs37d5\"              \n#&gt;  [56] \"BSgenome.Hsapiens.NCBI.GRCh38\"                     \n#&gt;  [57] \"BSgenome.Hsapiens.NCBI.T2T.CHM13v2.0\"              \n#&gt;  [58] \"BSgenome.Hsapiens.UCSC.hg17\"                       \n#&gt;  [59] \"BSgenome.Hsapiens.UCSC.hg17.masked\"                \n#&gt;  [60] \"BSgenome.Hsapiens.UCSC.hg18\"                       \n#&gt;  [61] \"BSgenome.Hsapiens.UCSC.hg18.masked\"                \n#&gt;  [62] \"BSgenome.Hsapiens.UCSC.hg19\"                       \n#&gt;  [63] \"BSgenome.Hsapiens.UCSC.hg19.masked\"                \n#&gt;  [64] \"BSgenome.Hsapiens.UCSC.hg38\"                       \n#&gt;  [65] \"BSgenome.Hsapiens.UCSC.hg38.dbSNP151.major\"        \n#&gt;  [66] \"BSgenome.Hsapiens.UCSC.hg38.dbSNP151.minor\"        \n#&gt;  [67] \"BSgenome.Hsapiens.UCSC.hg38.masked\"                \n#&gt;  [68] \"BSgenome.Hsapiens.UCSC.hs1\"                        \n#&gt;  [69] \"BSgenome.Mdomestica.UCSC.monDom5\"                  \n#&gt;  [70] \"BSgenome.Mfascicularis.NCBI.5.0\"                   \n#&gt;  [71] \"BSgenome.Mfascicularis.NCBI.6.0\"                   \n#&gt;  [72] \"BSgenome.Mfuro.UCSC.musFur1\"                       \n#&gt;  [73] \"BSgenome.Mmulatta.UCSC.rheMac10\"                   \n#&gt;  [74] \"BSgenome.Mmulatta.UCSC.rheMac2\"                    \n#&gt;  [75] \"BSgenome.Mmulatta.UCSC.rheMac2.masked\"             \n#&gt;  [76] \"BSgenome.Mmulatta.UCSC.rheMac3\"                    \n#&gt;  [77] \"BSgenome.Mmulatta.UCSC.rheMac3.masked\"             \n#&gt;  [78] \"BSgenome.Mmulatta.UCSC.rheMac8\"                    \n#&gt;  [79] \"BSgenome.Mmusculus.UCSC.mm10\"                      \n#&gt;  [80] \"BSgenome.Mmusculus.UCSC.mm10.masked\"               \n#&gt;  [81] \"BSgenome.Mmusculus.UCSC.mm39\"                      \n#&gt;  [82] \"BSgenome.Mmusculus.UCSC.mm8\"                       \n#&gt;  [83] \"BSgenome.Mmusculus.UCSC.mm8.masked\"                \n#&gt;  [84] \"BSgenome.Mmusculus.UCSC.mm9\"                       \n#&gt;  [85] \"BSgenome.Mmusculus.UCSC.mm9.masked\"                \n#&gt;  [86] \"BSgenome.Osativa.MSU.MSU7\"                         \n#&gt;  [87] \"BSgenome.Ppaniscus.UCSC.panPan1\"                   \n#&gt;  [88] \"BSgenome.Ppaniscus.UCSC.panPan2\"                   \n#&gt;  [89] \"BSgenome.Ptroglodytes.UCSC.panTro2\"                \n#&gt;  [90] \"BSgenome.Ptroglodytes.UCSC.panTro2.masked\"         \n#&gt;  [91] \"BSgenome.Ptroglodytes.UCSC.panTro3\"                \n#&gt;  [92] \"BSgenome.Ptroglodytes.UCSC.panTro3.masked\"         \n#&gt;  [93] \"BSgenome.Ptroglodytes.UCSC.panTro5\"                \n#&gt;  [94] \"BSgenome.Ptroglodytes.UCSC.panTro6\"                \n#&gt;  [95] \"BSgenome.Rnorvegicus.UCSC.rn4\"                     \n#&gt;  [96] \"BSgenome.Rnorvegicus.UCSC.rn4.masked\"              \n#&gt;  [97] \"BSgenome.Rnorvegicus.UCSC.rn5\"                     \n#&gt;  [98] \"BSgenome.Rnorvegicus.UCSC.rn5.masked\"              \n#&gt;  [99] \"BSgenome.Rnorvegicus.UCSC.rn6\"                     \n#&gt; [100] \"BSgenome.Rnorvegicus.UCSC.rn7\"                     \n#&gt; [101] \"BSgenome.Scerevisiae.UCSC.sacCer1\"                 \n#&gt; [102] \"BSgenome.Scerevisiae.UCSC.sacCer2\"                 \n#&gt; [103] \"BSgenome.Scerevisiae.UCSC.sacCer3\"                 \n#&gt; [104] \"BSgenome.Sscrofa.UCSC.susScr11\"                    \n#&gt; [105] \"BSgenome.Sscrofa.UCSC.susScr3\"                     \n#&gt; [106] \"BSgenome.Sscrofa.UCSC.susScr3.masked\"              \n#&gt; [107] \"BSgenome.Tgondii.ToxoDB.7.0\"                       \n#&gt; [108] \"BSgenome.Tguttata.UCSC.taeGut1\"                    \n#&gt; [109] \"BSgenome.Tguttata.UCSC.taeGut1.masked\"             \n#&gt; [110] \"BSgenome.Tguttata.UCSC.taeGut2\"                    \n#&gt; [111] \"BSgenome.Vvinifera.URGI.IGGP12Xv0\"                 \n#&gt; [112] \"BSgenome.Vvinifera.URGI.IGGP12Xv2\"                 \n#&gt; [113] \"BSgenome.Vvinifera.URGI.IGGP8X\"\n\n\n从UCSC hg38中加载智人的全基因组序列，计算14号染色体GC含量\nBSgenome.Hsapiens.UCSC.hg38\n\nCodelibrary(BSgenome.Hsapiens.UCSC.hg38)\nchr14_range = GRanges(seqnames = \"chr14\",\n                      ranges =  IRanges(start = 1, \n                                       end = seqlengths(Hsapiens)[\"chr14\"])\n                      )\nchr14_dna &lt;- getSeq(Hsapiens, chr14_range)\nletterFrequency(chr14_dna, letters = \"GC\", as.prob=TRUE)\n#&gt;            G|C\n#&gt; [1,] 0.3454924",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>注释数据库</span>"
    ]
  },
  {
    "objectID": "annotation_database.html#annotationdbi",
    "href": "annotation_database.html#annotationdbi",
    "title": "\n3  注释数据库\n",
    "section": "\n3.4 AnnotationDbi",
    "text": "3.4 AnnotationDbi\nhttps://bioconductor.org/packages/release/bioc/html/AnnotationDbi.html\n\n\nPackage Name\nContents\n\n\n\norg.Hs.eg.db\nGenome wide annotation for Human；useful for mapping between gene IDs, Names, Symbols, GO and KEGG identifiers, etc.\n\n\norg.Mm.eg.db\nGenome wide annotation for Mouse\n\n\nGO.db\nA set of annotation maps describing the entire Gene Ontology\n\n\nHPO.db\nA set of annotation maps describing the entire Human Phenotype Ontology\n\n\nMPO.db\nA set of annotation maps describing the Mouse Phenotype Ontology\n\n\n\n\n\n\n\n\n3.4.1 OrgDb\norg.Hs.eg.db\n\nCodelibrary(AnnotationDbi)\nlibrary(org.Hs.eg.db)\n\n\nkeytypes(org.Hs.eg.db) \n#&gt;  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n#&gt;  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n#&gt; [11] \"GENETYPE\"     \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"         \n#&gt; [16] \"OMIM\"         \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"        \n#&gt; [21] \"PMID\"         \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"      \n#&gt; [26] \"UNIPROT\"\n# 等价 AnnotationDbi::columns(org.Hs.eg.db)\n\n# 示例 GeneId\ngene_ids &lt;- c(\"1017\", \"1018\", \"1019\")  # 替换为你自己的 GeneId\n\n# 进行映射\nAnnotationDbi::select(org.Hs.eg.db, \n                       keys = gene_ids, \n                       columns = c(\"GENENAME\",\"SYMBOL\",\"GO\",\"ONTOLOGY\"), \n                       keytype = \"ENTREZID\") %&gt;% \n  head()\n\n\n\n\n\n\n\n\n\n\n\n\nENTREZID\nGENENAME\nSYMBOL\nGO\nEVIDENCE\nONTOLOGY\n\n\n\n1017\ncyclin dependent kinase 2\nCDK2\nGO:0000082\nIBA\nBP\n\n\n1017\ncyclin dependent kinase 2\nCDK2\nGO:0000082\nNAS\nBP\n\n\n1017\ncyclin dependent kinase 2\nCDK2\nGO:0000086\nNAS\nBP\n\n\n1017\ncyclin dependent kinase 2\nCDK2\nGO:0000122\nIEA\nBP\n\n\n1017\ncyclin dependent kinase 2\nCDK2\nGO:0000287\nIEA\nMF\n\n\n1017\ncyclin dependent kinase 2\nCDK2\nGO:0000307\nIBA\nCC\n\n\n\n\n\nCode\n\n# mapIds can only use one column.\nmapIds(org.Hs.eg.db, \n     keys = gene_ids, \n     column = c(\"GENENAME\"), \n     keytype = \"ENTREZID\") %&gt;% as.data.frame()\n\n\n\n\n\n.\n\n\n\n1017\ncyclin dependent kinase 2\n\n\n1018\ncyclin dependent kinase 3\n\n\n1019\ncyclin dependent kinase 4",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>注释数据库</span>"
    ]
  },
  {
    "objectID": "annotation_database.html#experimenthub",
    "href": "annotation_database.html#experimenthub",
    "title": "\n3  注释数据库\n",
    "section": "\n3.5 ExperimentHub",
    "text": "3.5 ExperimentHub",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>注释数据库</span>"
    ]
  },
  {
    "objectID": "ExpressionSet.html",
    "href": "ExpressionSet.html",
    "title": "\n4  ExpressionSet\n",
    "section": "",
    "text": "4.1 组件",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>`ExpressionSet`</span>"
    ]
  },
  {
    "objectID": "ExpressionSet.html#组件",
    "href": "ExpressionSet.html#组件",
    "title": "\n4  ExpressionSet\n",
    "section": "",
    "text": "4.1.1 Assay data\n包含实际的表达数据。通常是一个矩阵，其中行代表基因，列代表样本。数据可以是原始计数值、归一化的表达值等。\n\nCodedataDirectory &lt;- system.file(\"extdata\", package=\"Biobase\")\nexprsFile &lt;- file.path(dataDirectory, \"exprsData.txt\")\n\nexprs &lt;- as.matrix(read.table(exprsFile, header=TRUE, sep=\"\\t\",\n                              row.names=1,as.is=TRUE))\nclass(exprs)\n#&gt; [1] \"matrix\" \"array\"\ndim(exprs)\n#&gt; [1] 500  26\ncolnames(exprs)\n#&gt;  [1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" \"H\" \"I\" \"J\" \"K\" \"L\" \"M\" \"N\" \"O\" \"P\" \"Q\" \"R\" \"S\"\n#&gt; [20] \"T\" \"U\" \"V\" \"W\" \"X\" \"Y\" \"Z\"\nhead(exprs[,1:5])\n#&gt;                        A         B        C        D        E\n#&gt; AFFX-MurIL2_at  192.7420  85.75330 176.7570 135.5750 64.49390\n#&gt; AFFX-MurIL10_at  97.1370 126.19600  77.9216  93.3713 24.39860\n#&gt; AFFX-MurIL4_at   45.8192   8.83135  33.0632  28.7072  5.94492\n#&gt; AFFX-MurFAS_at   22.5445   3.60093  14.6883  12.3397 36.86630\n#&gt; AFFX-BioB-5_at   96.7875  30.43800  46.1271  70.9319 56.17440\n#&gt; AFFX-BioB-M_at   89.0730  25.84610  57.2033  69.9766 49.58220\n\n\n\n4.1.2 样本元数据\n包含样本的元数据。这个部分存储有关样本的信息，比如样本的处理条件、时间点等。通常以 AnnotatedDataFrame 的形式存储。\n\nCodepDataFile &lt;- file.path(dataDirectory, \"pData.txt\")\npData &lt;- read.table(pDataFile,row.names=1, header=TRUE, sep=\"\\t\")\n\ndim(pData)\n#&gt; [1] 26  3\ncolnames(pData)\n#&gt; [1] \"gender\" \"type\"   \"score\"\nsapply(pData, class)\n#&gt;      gender        type       score \n#&gt; \"character\" \"character\"   \"numeric\"\n\nrownames(pData)\n#&gt;  [1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\" \"G\" \"H\" \"I\" \"J\" \"K\" \"L\" \"M\" \"N\" \"O\" \"P\" \"Q\" \"R\" \"S\"\n#&gt; [20] \"T\" \"U\" \"V\" \"W\" \"X\" \"Y\" \"Z\"\n\nsummary(pData)\n#&gt;     gender              type               score       \n#&gt;  Length:26          Length:26          Min.   :0.1000  \n#&gt;  Class :character   Class :character   1st Qu.:0.3275  \n#&gt;  Mode  :character   Mode  :character   Median :0.4150  \n#&gt;                                        Mean   :0.5369  \n#&gt;                                        3rd Qu.:0.7650  \n#&gt;                                        Max.   :0.9800\n\nall(rownames(pData)==colnames(exprs))\n#&gt; [1] TRUE\n\n\n元数据\n\nCodemetadata &lt;- data.frame(labelDescription= c(\"Patient gender\",\"Case/control status\",\n                                           \"Tumor progress on XYZ scale\"),\n                       row.names=c(\"gender\", \"type\", \"score\"))\nmetadata\n\n\n\n\n\nlabelDescription\n\n\n\ngender\nPatient gender\n\n\ntype\nCase/control status\n\n\nscore\nTumor progress on XYZ scale\n\n\n\n\n\n\nBiobase 提供了AnnotatedDataFrame 类来保存表型数据及其元数据\n\nCodephenoData &lt;- new(\"AnnotatedDataFrame\",data=pData, varMetadata=metadata)\nphenoData\n#&gt; An object of class 'AnnotatedDataFrame'\n#&gt;   rowNames: A B ... Z (26 total)\n#&gt;   varLabels: gender type score\n#&gt;   varMetadata: labelDescription\n\n\n切片\n\nCodehead(pData(phenoData))\n\n\n\n\n\ngender\ntype\nscore\n\n\n\nA\nFemale\nControl\n0.75\n\n\nB\nMale\nCase\n0.40\n\n\nC\nMale\nControl\n0.73\n\n\nD\nMale\nCase\n0.42\n\n\nE\nFemale\nCase\n0.93\n\n\nF\nMale\nControl\n0.22\n\n\n\n\n\nCode\nphenoData[c(\"A\",\"Z\"),\"gender\"]\n#&gt; An object of class 'AnnotatedDataFrame'\n#&gt;   rowNames: A Z\n#&gt;   varLabels: gender\n#&gt;   varMetadata: labelDescription\npData(phenoData[phenoData$score&gt;0.8,])\n\n\n\n\n\ngender\ntype\nscore\n\n\n\nE\nFemale\nCase\n0.93\n\n\nG\nMale\nCase\n0.96\n\n\nX\nMale\nControl\n0.98\n\n\nY\nFemale\nCase\n0.94\n\n\n\n\n\n\n\n4.1.3 基因元数据及其注释\n包含基因的元数据。这个部分存储有关基因的信息，比如基因的注释、位置等。通常以 AnnotatedDataFrame 的形式存储。\nannotation和AnnotationDbi包为元数据包提供了基本的数据操作\n\nCodeannotation &lt;- \"hgu95av2\"\n\n\n\n4.1.4 实验元数据\n包含实验的元数据，比如实验设计、数据处理流程等。\nMIAME ob ject\n\nCodeexperimentData &lt;- new(\"MIAME\",name=\"Pierre Fermat\",lab=\"Francis Galton Lab\",\n                      contact=\"pfermat@lab.not.exist\",\n                      title=\"Smoking-Cancer Experiment\",\n                      abstract=\"An example ExpressionSet\",\n                      url=\"www.lab.not.exist\",\n                      other=list(\n                        notes=\"Created from text files\"\n                        )\n                      )\nexperimentData\n#&gt; Experiment data\n#&gt;   Experimenter name: Pierre Fermat \n#&gt;   Laboratory: Francis Galton Lab \n#&gt;   Contact information: pfermat@lab.not.exist \n#&gt;   Title: Smoking-Cancer Experiment \n#&gt;   URL: www.lab.not.exist \n#&gt;   PMIDs:  \n#&gt; \n#&gt;   Abstract: A 3 word abstract is available. Use 'abstract' method.\n#&gt;   notes:\n#&gt;    notes:     \n#&gt;       Created from text files",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>`ExpressionSet`</span>"
    ]
  },
  {
    "objectID": "ExpressionSet.html#构造expressionset",
    "href": "ExpressionSet.html#构造expressionset",
    "title": "\n4  ExpressionSet\n",
    "section": "\n4.2 构造ExpressionSet",
    "text": "4.2 构造ExpressionSet\n\nCode#help(\"ExpressionSet-class\")\nminiSet &lt;- ExpressionSet(assayData=exprs)\nminiSet\n#&gt; ExpressionSet (storageMode: lockedEnvironment)\n#&gt; assayData: 500 features, 26 samples \n#&gt;   element names: exprs \n#&gt; protocolData: none\n#&gt; phenoData: none\n#&gt; featureData: none\n#&gt; experimentData: use 'experimentData(object)'\n#&gt; Annotation:\n\nexampleSet &lt;- ExpressionSet(assayData=exprs,\n                            phenoData=phenoData,\n                            experimentData=experimentData,\n                            annotation=\"hgu95av2\")\n\nexampleSet\n#&gt; ExpressionSet (storageMode: lockedEnvironment)\n#&gt; assayData: 500 features, 26 samples \n#&gt;   element names: exprs \n#&gt; protocolData: none\n#&gt; phenoData\n#&gt;   sampleNames: A B ... Z (26 total)\n#&gt;   varLabels: gender type score\n#&gt;   varMetadata: labelDescription\n#&gt; featureData: none\n#&gt; experimentData: use 'experimentData(object)'\n#&gt; Annotation: hgu95av2\n\n\n\n4.2.1 访问\n\nCodeexprs(exampleSet) %&gt;% head()\n#&gt;                        A         B        C        D        E       F        G\n#&gt; AFFX-MurIL2_at  192.7420  85.75330 176.7570 135.5750 64.49390 76.3569 160.5050\n#&gt; AFFX-MurIL10_at  97.1370 126.19600  77.9216  93.3713 24.39860 85.5088  98.9086\n#&gt; AFFX-MurIL4_at   45.8192   8.83135  33.0632  28.7072  5.94492 28.2925  30.9694\n#&gt; AFFX-MurFAS_at   22.5445   3.60093  14.6883  12.3397 36.86630 11.2568  23.0034\n#&gt; AFFX-BioB-5_at   96.7875  30.43800  46.1271  70.9319 56.17440 42.6756  86.5156\n#&gt; AFFX-BioB-M_at   89.0730  25.84610  57.2033  69.9766 49.58220 26.1262  75.0083\n#&gt;                       H       I         J        K       L       M       N\n#&gt; AFFX-MurIL2_at  65.9631 56.9039 135.60800 63.44320 78.2126 83.0943 89.3372\n#&gt; AFFX-MurIL10_at 81.6932 97.8015  90.48380 70.57330 94.5418 75.3455 68.5827\n#&gt; AFFX-MurIL4_at  14.7923 14.2399  34.48740 20.35210 14.1554 20.6251 15.9231\n#&gt; AFFX-MurFAS_at  16.2134 12.0375   4.54978  8.51782 27.2852 10.1616 20.2488\n#&gt; AFFX-BioB-5_at  30.7927 19.7183  46.35200 39.13260 41.7698 80.2197 36.4903\n#&gt; AFFX-BioB-M_at  42.3352 41.1207  91.53070 39.91360 49.8397 63.4794 24.7007\n#&gt;                       O       P        Q        R         S       T         U\n#&gt; AFFX-MurIL2_at  91.0615 95.9377 179.8450 152.4670 180.83400 85.4146 157.98900\n#&gt; AFFX-MurIL10_at 87.4050 84.4581  87.6806 108.0320 134.26300 91.4031  -8.68811\n#&gt; AFFX-MurIL4_at  20.1579 27.8139  32.7911  33.5292  19.81720 20.4190  26.87200\n#&gt; AFFX-MurFAS_at  15.7849 14.3276  15.9488  14.6753  -7.91911 12.8875  11.91860\n#&gt; AFFX-BioB-5_at  36.4021 35.3054  58.6239 114.0620  93.44020 22.5168  48.64620\n#&gt; AFFX-BioB-M_at  47.4641 47.3578  58.1331 104.1220 115.83100 58.1224  73.42210\n#&gt;                        V       W         X       Y         Z\n#&gt; AFFX-MurIL2_at  146.8000 93.8829 103.85500 64.4340 175.61500\n#&gt; AFFX-MurIL10_at  85.0212 79.2998  71.65520 64.2369  78.70680\n#&gt; AFFX-MurIL4_at   31.1488 22.3420  19.01350 12.1686  17.37800\n#&gt; AFFX-MurFAS_at   12.8324 11.1390   7.55564 19.9849   8.96849\n#&gt; AFFX-BioB-5_at   90.2215 42.0053  57.57380 44.8216  61.70440\n#&gt; AFFX-BioB-M_at   64.6066 40.3068  41.82090 46.1087  49.41220\n\npData(exampleSet)\n\n\n\n\n\ngender\ntype\nscore\n\n\n\nA\nFemale\nControl\n0.75\n\n\nB\nMale\nCase\n0.40\n\n\nC\nMale\nControl\n0.73\n\n\nD\nMale\nCase\n0.42\n\n\nE\nFemale\nCase\n0.93\n\n\nF\nMale\nControl\n0.22\n\n\nG\nMale\nCase\n0.96\n\n\nH\nMale\nCase\n0.79\n\n\nI\nFemale\nCase\n0.37\n\n\nJ\nMale\nControl\n0.63\n\n\nK\nMale\nCase\n0.26\n\n\nL\nFemale\nControl\n0.36\n\n\nM\nMale\nCase\n0.41\n\n\nN\nMale\nCase\n0.80\n\n\nO\nFemale\nCase\n0.10\n\n\nP\nFemale\nControl\n0.41\n\n\nQ\nFemale\nCase\n0.16\n\n\nR\nMale\nControl\n0.72\n\n\nS\nMale\nCase\n0.17\n\n\nT\nFemale\nCase\n0.74\n\n\nU\nMale\nControl\n0.35\n\n\nV\nFemale\nControl\n0.77\n\n\nW\nMale\nControl\n0.27\n\n\nX\nMale\nControl\n0.98\n\n\nY\nFemale\nCase\n0.94\n\n\nZ\nFemale\nCase\n0.32\n\n\n\n\n\nCode\nfData(exampleSet)\n\n\n\n\nAFFX-MurIL2_at\n\n\nAFFX-MurIL10_at\n\n\nAFFX-MurIL4_at\n\n\nAFFX-MurFAS_at\n\n\nAFFX-BioB-5_at\n\n\nAFFX-BioB-M_at\n\n\nAFFX-BioB-3_at\n\n\nAFFX-BioC-5_at\n\n\nAFFX-BioC-3_at\n\n\nAFFX-BioDn-5_at\n\n\nAFFX-BioDn-3_at\n\n\nAFFX-CreX-5_at\n\n\nAFFX-CreX-3_at\n\n\nAFFX-BioB-5_st\n\n\nAFFX-BioB-M_st\n\n\nAFFX-BioB-3_st\n\n\nAFFX-BioC-5_st\n\n\nAFFX-BioC-3_st\n\n\nAFFX-BioDn-5_st\n\n\nAFFX-BioDn-3_st\n\n\nAFFX-CreX-5_st\n\n\nAFFX-CreX-3_st\n\n\nAFFX-hum_alu_at\n\n\nAFFX-DapX-5_at\n\n\nAFFX-DapX-M_at\n\n\nAFFX-DapX-3_at\n\n\nAFFX-LysX-5_at\n\n\nAFFX-LysX-M_at\n\n\nAFFX-LysX-3_at\n\n\nAFFX-PheX-5_at\n\n\nAFFX-PheX-M_at\n\n\nAFFX-PheX-3_at\n\n\nAFFX-ThrX-5_at\n\n\nAFFX-ThrX-M_at\n\n\nAFFX-ThrX-3_at\n\n\nAFFX-TrpnX-5_at\n\n\nAFFX-TrpnX-M_at\n\n\nAFFX-TrpnX-3_at\n\n\nAFFX-HUMISGF3A/M97935_5_at\n\n\nAFFX-HUMISGF3A/M97935_MA_at\n\n\nAFFX-HUMISGF3A/M97935_MB_at\n\n\nAFFX-HUMISGF3A/M97935_3_at\n\n\nAFFX-HUMRGE/M10098_5_at\n\n\nAFFX-HUMRGE/M10098_M_at\n\n\nAFFX-HUMRGE/M10098_3_at\n\n\nAFFX-HUMGAPDH/M33197_5_at\n\n\nAFFX-HUMGAPDH/M33197_M_at\n\n\nAFFX-HUMGAPDH/M33197_3_at\n\n\nAFFX-HSAC07/X00351_5_at\n\n\nAFFX-HSAC07/X00351_M_at\n\n\nAFFX-HSAC07/X00351_3_at\n\n\nAFFX-HUMTFRR/M11507_5_at\n\n\nAFFX-HUMTFRR/M11507_M_at\n\n\nAFFX-HUMTFRR/M11507_3_at\n\n\nAFFX-M27830_5_at\n\n\nAFFX-M27830_M_at\n\n\nAFFX-M27830_3_at\n\n\nAFFX-HSAC07/X00351_3_st\n\n\nAFFX-HUMGAPDH/M33197_5_st\n\n\nAFFX-HUMGAPDH/M33197_M_st\n\n\nAFFX-HUMGAPDH/M33197_3_st\n\n\nAFFX-HSAC07/X00351_5_st\n\n\nAFFX-HSAC07/X00351_M_st\n\n\nAFFX-YEL002c/WBP1_at\n\n\nAFFX-YEL018w/_at\n\n\nAFFX-YEL024w/RIP1_at\n\n\nAFFX-YEL021w/URA3_at\n\n\n31307_at\n\n\n31308_at\n\n\n31309_r_at\n\n\n31310_at\n\n\n31311_at\n\n\n31312_at\n\n\n31313_at\n\n\n31314_at\n\n\n31315_at\n\n\n31316_at\n\n\n31317_r_at\n\n\n31318_at\n\n\n31319_at\n\n\n31320_at\n\n\n31321_at\n\n\n31322_at\n\n\n31323_r_at\n\n\n31324_at\n\n\n31325_at\n\n\n31326_at\n\n\n31327_at\n\n\n31328_at\n\n\n31329_at\n\n\n31330_at\n\n\n31331_at\n\n\n31332_at\n\n\n31333_at\n\n\n31334_at\n\n\n31335_at\n\n\n31336_at\n\n\n31337_at\n\n\n31338_at\n\n\n31339_at\n\n\n31340_at\n\n\n31341_at\n\n\n31342_at\n\n\n31343_at\n\n\n31344_at\n\n\n31345_at\n\n\n31346_at\n\n\n31347_at\n\n\n31348_at\n\n\n31349_at\n\n\n31350_at\n\n\n31351_at\n\n\n31352_at\n\n\n31353_f_at\n\n\n31354_r_at\n\n\n31355_at\n\n\n31356_at\n\n\n31357_at\n\n\n31358_at\n\n\n31359_at\n\n\n31360_at\n\n\n31361_at\n\n\n31362_at\n\n\n31363_at\n\n\n31364_i_at\n\n\n31365_f_at\n\n\n31366_at\n\n\n31367_at\n\n\n31368_at\n\n\n31369_at\n\n\n31370_at\n\n\n31371_at\n\n\n31372_at\n\n\n31373_at\n\n\n31374_at\n\n\n31375_at\n\n\n31376_at\n\n\n31377_r_at\n\n\n31378_at\n\n\n31379_at\n\n\n31380_at\n\n\n31381_at\n\n\n31382_f_at\n\n\n31383_at\n\n\n31384_at\n\n\n31385_at\n\n\n31386_at\n\n\n31387_at\n\n\n31388_at\n\n\n31389_at\n\n\n31390_at\n\n\n31391_at\n\n\n31392_r_at\n\n\n31393_r_at\n\n\n31394_at\n\n\n31395_i_at\n\n\n31396_r_at\n\n\n31397_at\n\n\n31398_at\n\n\n31399_at\n\n\n31400_at\n\n\n31401_r_at\n\n\n31402_at\n\n\n31403_at\n\n\n31404_at\n\n\n31405_at\n\n\n31406_at\n\n\n31407_at\n\n\n31408_at\n\n\n31409_at\n\n\n31410_at\n\n\n31411_at\n\n\n31412_at\n\n\n31413_at\n\n\n31414_at\n\n\n31415_at\n\n\n31416_at\n\n\n31417_at\n\n\n31418_at\n\n\n31419_r_at\n\n\n31420_at\n\n\n31421_at\n\n\n31422_at\n\n\n31423_at\n\n\n31424_at\n\n\n31425_g_at\n\n\n31426_at\n\n\n31427_at\n\n\n31428_at\n\n\n31429_at\n\n\n31430_at\n\n\n31431_at\n\n\n31432_g_at\n\n\n31433_at\n\n\n31434_at\n\n\n31435_at\n\n\n31436_s_at\n\n\n31437_r_at\n\n\n31438_s_at\n\n\n31439_f_at\n\n\n31440_at\n\n\n31441_at\n\n\n31442_at\n\n\n31443_at\n\n\n31444_s_at\n\n\n31445_at\n\n\n31446_s_at\n\n\n31447_at\n\n\n31448_s_at\n\n\n31449_at\n\n\n31450_s_at\n\n\n31451_at\n\n\n31452_at\n\n\n31453_s_at\n\n\n31454_f_at\n\n\n31455_r_at\n\n\n31456_at\n\n\n31457_at\n\n\n31458_at\n\n\n31459_i_at\n\n\n31460_f_at\n\n\n31461_at\n\n\n31462_f_at\n\n\n31463_s_at\n\n\n31464_at\n\n\n31465_g_at\n\n\n31466_at\n\n\n31467_at\n\n\n31468_f_at\n\n\n31469_s_at\n\n\n31470_at\n\n\n31471_at\n\n\n31472_s_at\n\n\n31473_s_at\n\n\n31474_r_at\n\n\n31475_at\n\n\n31476_g_at\n\n\n31477_at\n\n\n31478_at\n\n\n31479_f_at\n\n\n31480_f_at\n\n\n31481_s_at\n\n\n31482_at\n\n\n31483_g_at\n\n\n31484_at\n\n\n31485_at\n\n\n31486_s_at\n\n\n31487_at\n\n\n31488_s_at\n\n\n31489_at\n\n\n31490_at\n\n\n31491_s_at\n\n\n31492_at\n\n\n31493_s_at\n\n\n31494_at\n\n\n31495_at\n\n\n31496_g_at\n\n\n31497_at\n\n\n31498_f_at\n\n\n31499_s_at\n\n\n31500_at\n\n\n31501_at\n\n\n31502_at\n\n\n31503_at\n\n\n31504_at\n\n\n31505_at\n\n\n31506_s_at\n\n\n31507_at\n\n\n31508_at\n\n\n31509_at\n\n\n31510_s_at\n\n\n31511_at\n\n\n31512_at\n\n\n31513_at\n\n\n31514_at\n\n\n31515_at\n\n\n31516_f_at\n\n\n31517_f_at\n\n\n31518_i_at\n\n\n31519_f_at\n\n\n31520_at\n\n\n31521_f_at\n\n\n31522_f_at\n\n\n31523_f_at\n\n\n31524_f_at\n\n\n31525_s_at\n\n\n31526_f_at\n\n\n31527_at\n\n\n31528_f_at\n\n\n31529_at\n\n\n31530_at\n\n\n31531_g_at\n\n\n31532_at\n\n\n31533_s_at\n\n\n31534_at\n\n\n31535_i_at\n\n\n31536_at\n\n\n31537_at\n\n\n31538_at\n\n\n31539_r_at\n\n\n31540_at\n\n\n31541_at\n\n\n31542_at\n\n\n31543_at\n\n\n31544_at\n\n\n31545_at\n\n\n31546_at\n\n\n31547_at\n\n\n31548_at\n\n\n31549_at\n\n\n31550_at\n\n\n31551_at\n\n\n31552_at\n\n\n31553_at\n\n\n31554_at\n\n\n31555_at\n\n\n31556_at\n\n\n31557_at\n\n\n31558_at\n\n\n31559_at\n\n\n31560_at\n\n\n31561_at\n\n\n31562_at\n\n\n31563_at\n\n\n31564_at\n\n\n31565_at\n\n\n31566_at\n\n\n31567_at\n\n\n31568_at\n\n\n31569_at\n\n\n31570_at\n\n\n31571_at\n\n\n31572_at\n\n\n31573_at\n\n\n31574_i_at\n\n\n31575_f_at\n\n\n31576_at\n\n\n31577_at\n\n\n31578_at\n\n\n31579_at\n\n\n31580_at\n\n\n31581_at\n\n\n31582_at\n\n\n31583_at\n\n\n31584_at\n\n\n31585_at\n\n\n31586_f_at\n\n\n31587_at\n\n\n31588_at\n\n\n31589_at\n\n\n31590_g_at\n\n\n31591_s_at\n\n\n31592_at\n\n\n31593_at\n\n\n31594_at\n\n\n31595_at\n\n\n31596_f_at\n\n\n31597_r_at\n\n\n31598_s_at\n\n\n31599_f_at\n\n\n31600_s_at\n\n\n31601_s_at\n\n\n31602_at\n\n\n31603_at\n\n\n31604_at\n\n\n31605_at\n\n\n31606_at\n\n\n31607_at\n\n\n31608_g_at\n\n\n31609_s_at\n\n\n31610_at\n\n\n31611_s_at\n\n\n31612_at\n\n\n31613_at\n\n\n31614_at\n\n\n31615_i_at\n\n\n31616_r_at\n\n\n31617_at\n\n\n31618_at\n\n\n31619_at\n\n\n31620_at\n\n\n31621_s_at\n\n\n31622_f_at\n\n\n31623_f_at\n\n\n31624_at\n\n\n31625_at\n\n\n31626_i_at\n\n\n31627_f_at\n\n\n31628_at\n\n\n31629_at\n\n\n31630_at\n\n\n31631_f_at\n\n\n31632_at\n\n\n31633_g_at\n\n\n31634_at\n\n\n31635_g_at\n\n\n31636_s_at\n\n\n31637_s_at\n\n\n31638_at\n\n\n31639_f_at\n\n\n31640_r_at\n\n\n31641_s_at\n\n\n31642_at\n\n\n31643_at\n\n\n31644_at\n\n\n31645_at\n\n\n31646_at\n\n\n31647_at\n\n\n31648_at\n\n\n31649_at\n\n\n31650_g_at\n\n\n31651_at\n\n\n31652_at\n\n\n31653_at\n\n\n31654_at\n\n\n31655_at\n\n\n31656_at\n\n\n31657_at\n\n\n31658_at\n\n\n31659_at\n\n\n31660_at\n\n\n31661_at\n\n\n31662_at\n\n\n31663_at\n\n\n31664_at\n\n\n31665_s_at\n\n\n31666_f_at\n\n\n31667_r_at\n\n\n31668_f_at\n\n\n31669_s_at\n\n\n31670_s_at\n\n\n31671_at\n\n\n31672_g_at\n\n\n31673_s_at\n\n\n31674_s_at\n\n\n31675_s_at\n\n\n31676_at\n\n\n31677_at\n\n\n31678_at\n\n\n31679_at\n\n\n31680_at\n\n\n31681_at\n\n\n31682_s_at\n\n\n31683_at\n\n\n31684_at\n\n\n31685_at\n\n\n31686_at\n\n\n31687_f_at\n\n\n31688_at\n\n\n31689_at\n\n\n31690_at\n\n\n31691_g_at\n\n\n31692_at\n\n\n31693_f_at\n\n\n31694_at\n\n\n31695_g_at\n\n\n31696_at\n\n\n31697_s_at\n\n\n31698_at\n\n\n31699_at\n\n\n31700_at\n\n\n31701_r_at\n\n\n31702_at\n\n\n31703_at\n\n\n31704_at\n\n\n31705_at\n\n\n31706_at\n\n\n31707_at\n\n\n31708_at\n\n\n31709_at\n\n\n31710_at\n\n\n31711_at\n\n\n31712_at\n\n\n31713_s_at\n\n\n31714_at\n\n\n31715_at\n\n\n31716_at\n\n\n31717_at\n\n\n31718_at\n\n\n31719_at\n\n\n31720_s_at\n\n\n31721_at\n\n\n31722_at\n\n\n31723_at\n\n\n31724_at\n\n\n31725_s_at\n\n\n31726_at\n\n\n31727_at\n\n\n31728_at\n\n\n31729_at\n\n\n31730_at\n\n\n31731_at\n\n\n31732_at\n\n\n31733_at\n\n\n31734_at\n\n\n31735_at\n\n\n31736_at\n\n\n31737_at\n\n\n31738_at\n\n\n31739_at\n\n\n\n\nCodeexperimentData(exampleSet)\n#&gt; Experiment data\n#&gt;   Experimenter name: Pierre Fermat \n#&gt;   Laboratory: Francis Galton Lab \n#&gt;   Contact information: pfermat@lab.not.exist \n#&gt;   Title: Smoking-Cancer Experiment \n#&gt;   URL: www.lab.not.exist \n#&gt;   PMIDs:  \n#&gt; \n#&gt;   Abstract: A 3 word abstract is available. Use 'abstract' method.\n#&gt;   notes:\n#&gt;    notes:     \n#&gt;       Created from text files\n\n\n\n4.2.2 切片\n\nCodeexampleSet$gender[1:5]\n#&gt; [1] \"Female\" \"Male\"   \"Male\"   \"Male\"   \"Female\"\nexampleSet$gender[1:5] == \"Female\"\n#&gt; [1]  TRUE FALSE FALSE FALSE  TRUE\n\nfeatureNames(exampleSet)[1:5]\n#&gt; [1] \"AFFX-MurIL2_at\"  \"AFFX-MurIL10_at\" \"AFFX-MurIL4_at\"  \"AFFX-MurFAS_at\" \n#&gt; [5] \"AFFX-BioB-5_at\"\nsampleNames(exampleSet)[1:5]\n#&gt; [1] \"A\" \"B\" \"C\" \"D\" \"E\"\nvarLabels(exampleSet)\n#&gt; [1] \"gender\" \"type\"   \"score\"\nexprs(exampleSet)[1:6,1:5]\n#&gt;                        A         B        C        D        E\n#&gt; AFFX-MurIL2_at  192.7420  85.75330 176.7570 135.5750 64.49390\n#&gt; AFFX-MurIL10_at  97.1370 126.19600  77.9216  93.3713 24.39860\n#&gt; AFFX-MurIL4_at   45.8192   8.83135  33.0632  28.7072  5.94492\n#&gt; AFFX-MurFAS_at   22.5445   3.60093  14.6883  12.3397 36.86630\n#&gt; AFFX-BioB-5_at   96.7875  30.43800  46.1271  70.9319 56.17440\n#&gt; AFFX-BioB-M_at   89.0730  25.84610  57.2033  69.9766 49.58220",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>`ExpressionSet`</span>"
    ]
  },
  {
    "objectID": "SummarizedExperiment.html",
    "href": "SummarizedExperiment.html",
    "title": "\n5  SummarizedExperiment\n",
    "section": "",
    "text": "5.1 构造SummarizedExperiment实例\nSummarizeExperiment 如 Figure 5.1 所示\n具体可参考 SummarizedExperiment docs 。\nCode# 计数矩阵\nnrows &lt;- 200\nncols &lt;- 6\ncounts &lt;- matrix(runif(nrows * ncols, 1, 1e4), nrows)\nhead(counts)\n#&gt;           [,1]     [,2]      [,3]     [,4]     [,5]     [,6]\n#&gt; [1,] 9716.5615 5785.166 6787.2718 9230.371 2980.809 6003.592\n#&gt; [2,]  526.7021 7399.303 4174.6909 8129.570 7930.471 9444.718\n#&gt; [3,] 3638.8988 5585.446 3146.2578 1827.896 9523.883 1823.681\n#&gt; [4,] 4043.9146 9632.294  606.9306 8414.168 9299.789 1467.223\n#&gt; [5,]  144.7185 5088.270 8735.6897 5399.352 8930.863 9889.022\n#&gt; [6,] 3421.2014 8510.405 9424.0854 9902.199 3764.500 7555.098\n\n# 基因元数据\nrowData &lt;- GRanges(seqnames = rep(c(\"chr1\", \"chr2\"), c(50, 150)),\n                   ranges = IRanges(floor(runif(200, 1e5, 1e6)), width=100),\n                   strand=sample(c(\"+\", \"-\"), 200, TRUE),\n                   gene_id=sprintf(\"ID%03d\", 1:200))\nrowData[1:6,]\n#&gt; GRanges object with 6 ranges and 1 metadata column:\n#&gt;       seqnames        ranges strand |     gene_id\n#&gt;          &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;\n#&gt;   [1]     chr1 842135-842234      + |       ID001\n#&gt;   [2]     chr1 893167-893266      - |       ID002\n#&gt;   [3]     chr1 143410-143509      - |       ID003\n#&gt;   [4]     chr1 389155-389254      + |       ID004\n#&gt;   [5]     chr1 837386-837485      + |       ID005\n#&gt;   [6]     chr1 383201-383300      - |       ID006\n#&gt;   -------\n#&gt;   seqinfo: 2 sequences from an unspecified genome; no seqlengths\n\n\n# 样本元数据\ncolData &lt;- DataFrame(Treatment=rep(c(\"ChIP\", \"Input\"), 3),\n                     row.names=LETTERS[1:6])\ncolData\n#&gt; DataFrame with 6 rows and 1 column\n#&gt;     Treatment\n#&gt;   &lt;character&gt;\n#&gt; A        ChIP\n#&gt; B       Input\n#&gt; C        ChIP\n#&gt; D       Input\n#&gt; E        ChIP\n#&gt; F       Input\n# 实验元数据\nmetadata &lt;- \"A example of how to create an instance of SummarizedExperiment\" \n\nse &lt;- SummarizedExperiment(assays=list(counts=counts),\n                           rowRanges=rowData, \n                           colData=colData,\n                           metadata=metadata)\nse\n#&gt; class: RangedSummarizedExperiment \n#&gt; dim: 200 6 \n#&gt; metadata(1): ''\n#&gt; assays(1): counts\n#&gt; rownames: NULL\n#&gt; rowData names(1): gene_id\n#&gt; colnames(6): A B ... E F\n#&gt; colData names(1): Treatment\nCodedim(se)\n#&gt; [1] 200   6\n\nSummarizedExperiment::assay(se) %&gt;% head()\n#&gt;              A        B         C        D        E        F\n#&gt; [1,] 9716.5615 5785.166 6787.2718 9230.371 2980.809 6003.592\n#&gt; [2,]  526.7021 7399.303 4174.6909 8129.570 7930.471 9444.718\n#&gt; [3,] 3638.8988 5585.446 3146.2578 1827.896 9523.883 1823.681\n#&gt; [4,] 4043.9146 9632.294  606.9306 8414.168 9299.789 1467.223\n#&gt; [5,]  144.7185 5088.270 8735.6897 5399.352 8930.863 9889.022\n#&gt; [6,] 3421.2014 8510.405 9424.0854 9902.199 3764.500 7555.098\nSummarizedExperiment::rowData(se)\n#&gt; DataFrame with 200 rows and 1 column\n#&gt;         gene_id\n#&gt;     &lt;character&gt;\n#&gt; 1         ID001\n#&gt; 2         ID002\n#&gt; 3         ID003\n#&gt; 4         ID004\n#&gt; 5         ID005\n#&gt; ...         ...\n#&gt; 196       ID196\n#&gt; 197       ID197\n#&gt; 198       ID198\n#&gt; 199       ID199\n#&gt; 200       ID200\nSummarizedExperiment::rowRanges(se)\n#&gt; GRanges object with 200 ranges and 1 metadata column:\n#&gt;         seqnames        ranges strand |     gene_id\n#&gt;            &lt;Rle&gt;     &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;\n#&gt;     [1]     chr1 842135-842234      + |       ID001\n#&gt;     [2]     chr1 893167-893266      - |       ID002\n#&gt;     [3]     chr1 143410-143509      - |       ID003\n#&gt;     [4]     chr1 389155-389254      + |       ID004\n#&gt;     [5]     chr1 837386-837485      + |       ID005\n#&gt;     ...      ...           ...    ... .         ...\n#&gt;   [196]     chr2 828198-828297      + |       ID196\n#&gt;   [197]     chr2 897222-897321      - |       ID197\n#&gt;   [198]     chr2 815142-815241      - |       ID198\n#&gt;   [199]     chr2 990951-991050      + |       ID199\n#&gt;   [200]     chr2 153508-153607      - |       ID200\n#&gt;   -------\n#&gt;   seqinfo: 2 sequences from an unspecified genome; no seqlengths\nSummarizedExperiment::colData(se)\n#&gt; DataFrame with 6 rows and 1 column\n#&gt;     Treatment\n#&gt;   &lt;character&gt;\n#&gt; A        ChIP\n#&gt; B       Input\n#&gt; C        ChIP\n#&gt; D       Input\n#&gt; E        ChIP\n#&gt; F       Input",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>`SummarizedExperiment`</span>"
    ]
  },
  {
    "objectID": "SingleCellExperiment.html",
    "href": "SingleCellExperiment.html",
    "title": "\n6  SingleCellExperiment\n",
    "section": "",
    "text": "6.1 表达矩阵（raw/transformed counts）\n该数据结构实际上是从 SummarizedExperiment 继承而来。\nSingleCellExperiment 如 Figure 6.1 所示。\n要构造一个SingleCellExperiment对象，我们只需要导入assays ( Figure 6.1 ,蓝色框 )，其中行对应于特征（基因），列对应于样本（细胞）。下载：counts_Calero_20160113.tsv。",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>`SingleCellExperiment`</span>"
    ]
  },
  {
    "objectID": "SingleCellExperiment.html#表达矩阵rawtransformed-counts",
    "href": "SingleCellExperiment.html#表达矩阵rawtransformed-counts",
    "title": "\n6  SingleCellExperiment\n",
    "section": "",
    "text": "6.1.1 assays\n\n\nCodelibrary(data.table)\nlibrary(dtplyr)\ndf &lt;- fread(\"data/SingleCellExperiment/counts_Calero_20160113.tsv\")\n\ndf %&gt;% \n  pull(GeneID) %&gt;% \n  str_sub(start = 1,end = 7) %&gt;% \n  table()\n#&gt; .\n#&gt; CBFB-MY ENSMUSG ERCC-00   SIRV1   SIRV2   SIRV3   SIRV4   SIRV5   SIRV6   SIRV7 \n#&gt;       1   46603      92       1       1       1       1       1       1       1\n\n\n\n\n\n\n\n\n外部RNA对照联盟 （External RNA Controls Consortium，ERCC） 就是一个专门为了定制一套spike-in RNA而成立的组织。\nSIRVs (Spike-in RNA Variant Control Mixes)\n\n\n\n\nCode# 分离出spike-in RNA\nspike.df &lt;- df[str_detect(df$GeneID,pattern = \"^ERCC-\"),]\n\n# 只考虑内源性基因\ndf_ens&lt;- df[str_detect(df$GeneID,pattern = \"^ENSMUSG\"),]\n\n# 分离基因长度\ngene_length &lt;- df_ens$Length\n\n\n# geneID --&gt;行标识符\ndf_ens &lt;- df_ens |&gt; column_to_rownames(var = \"GeneID\") \n\n\n# 计数矩阵\ncounts&lt;- df_ens %&gt;% select(-Length) %&gt;% as.matrix()\ndim(counts)\n#&gt; [1] 46603    96\n\n\n# \n# fwrite(df_ens, file = \"data/SingleCellExperiment/df_ens.csv\", \n#        row.names = T)\n\n\n\n6.1.2 增加assays\n\n使用函数 SingleCellExperiment() 以命名列表的形式提供数据，其中列表的每个对象都是一个矩阵。\n\nCodelibrary(SingleCellExperiment)\nconflicts_prefer(GenomicRanges::setdiff)\n\n\n\nCodesce &lt;- SingleCellExperiment(assays = list(counts = counts))\nsce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(0):\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(0):\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):\n\n\n\n6.1.2.1 标准化变换\n\nCodesce &lt;- scuttle::logNormCounts(sce) #对数变换标准化表达矩阵\nsce    #  assays 多了一个  \"logcounts\"\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(0):\n#&gt; assays(2): counts logcounts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(0):\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(1): sizeFactor\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):\ndim(logcounts(sce))\n#&gt; [1] 46603    96\n\n\n\n6.1.2.2 线性变换\n\nCodecounts_100 &lt;- counts(sce) + 100\nassay(sce, \"counts_100\") &lt;- counts_100 \nassays(sce) \n#&gt; List of length 3\n#&gt; names(3): counts logcounts counts_100\n\n\n\n6.1.2.3 访问和切片\n\nCode#访问计数矩阵\nassayNames(sce)\n#&gt; [1] \"counts\"     \"logcounts\"  \"counts_100\"\nmat2 &lt;- assay(sce, \"counts\")  #通用\nmat3 &lt;- counts(sce)           #特殊名称 counts  \nlog_mat &lt;- logcounts(sce)\n\nnames(assays(sce))\n#&gt; [1] \"counts\"     \"logcounts\"  \"counts_100\"\n# 切片\nassays(sce) &lt;- assays(sce)[1]\nassayNames(sce)\n#&gt; [1] \"counts\"",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>`SingleCellExperiment`</span>"
    ]
  },
  {
    "objectID": "SingleCellExperiment.html#cell-metadatacoldata",
    "href": "SingleCellExperiment.html#cell-metadatacoldata",
    "title": "\n6  SingleCellExperiment\n",
    "section": "\n6.2 cell metadata（colData）",
    "text": "6.2 cell metadata（colData）\n为了进一步构造对象SingleCellExperiment，需要添加列元数据colData注释细胞或样本，该对象DataFrame中的行对应于细胞，列对应于样本元数据字段，例如原产地批次batch of origin、处理条件treatment condition等（ Figure 6.1 ,橙色框）。下载：E-MTAB-5522.sdrf.txt（第2页）\n\n6.2.1 colData\n\n\nCodesdrf &lt;- fread(\"data/SingleCellExperiment//E-MTAB-5522.sdrf.txt\")\n\n# 仅保留在计数矩阵的细胞  第44列==\"counts_Calero_20160113.tsv\"\ncoldata &lt;- sdrf[sdrf$`Derived Array Data File` == \"counts_Calero_20160113.tsv\", ]\n\n# 仅保留部分列和设置行标识符\ncoldata &lt;- DataFrame(\n  genotype=coldata$`Characteristics[genotype]`,\n  phenotype=coldata$`Characteristics[phenotype]`,\n  spike_in=coldata$`Factor Value[spike-in addition]`,\n  row.names = coldata$`Source Name`\n)\ncoldata\n#&gt; DataFrame with 96 rows and 3 columns\n#&gt;                                                    genotype\n#&gt;                                                 &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; ...                                                     ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt;                                                   phenotype    spike_in\n#&gt;                                                 &lt;character&gt; &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; ...                                                     ...         ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1    wild type phenotype    Premixed\n\n\n添加之前确保colData的行名与计数矩阵的列名相同\n\nCodeidentical(rownames(coldata), colnames(counts))\n#&gt; [1] TRUE\n\n\n\n6.2.2 添加colData\n\n\n6.2.2.1 从头开始\n\nCodesce0 &lt;- SingleCellExperiment(assays = list(counts=counts), \n                             colData= coldata)\nsce0\ncolData(sce0)\n\n\n\n6.2.2.2 向现有对象添加\n\nCodesce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(0):\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(1): sizeFactor\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):\ncolData(sce) &lt;- coldata\nsce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(0):\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(3): genotype phenotype spike_in\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):\n\n\n或者 分块添加\n\nCodesce1 &lt;- SingleCellExperiment(list(counts=counts))\nsce1$phenotype &lt;- coldata$phenotype\ncolData(sce1)\n#&gt; DataFrame with 96 rows and 1 column\n#&gt;                                                   phenotype\n#&gt;                                                 &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    wild type phenotype\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1    wild type phenotype\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1    wild type phenotype\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..\n#&gt; ...                                                     ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1    wild type phenotype\n\n\n\n6.2.3 函数自动添加\n某些函数在colData中返回额外样本元数据字段，自动添加列元数据。\n\nCodesce &lt;- scuttle::addPerCellQC(sce)  #quality control metrics质量控制指标\ncolData(sce)\n#&gt; DataFrame with 96 rows and 6 columns\n#&gt;                                                    genotype\n#&gt;                                                 &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; ...                                                     ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt;                                                   phenotype    spike_in\n#&gt;                                                 &lt;character&gt; &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; ...                                                     ...         ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1    wild type phenotype    Premixed\n#&gt;                                            sum  detected     total\n#&gt;                                      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    854171      7617    854171\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   1044243      7520   1044243\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   1152450      8305   1152450\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   1193876      8142   1193876\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1   1521472      7153   1521472\n#&gt; ...                                        ...       ...       ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1    203221      5608    203221\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1   1059853      6948   1059853\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1   1672343      6879   1672343\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1   1939537      7213   1939537\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1   1436899      8469   1436899\nsce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(0):\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(6): genotype phenotype ... detected total\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>`SingleCellExperiment`</span>"
    ]
  },
  {
    "objectID": "SingleCellExperiment.html#featuregene-metadata-rowdata",
    "href": "SingleCellExperiment.html#featuregene-metadata-rowdata",
    "title": "\n6  SingleCellExperiment\n",
    "section": "\n6.3 feature/gene metadata ( rowData)",
    "text": "6.3 feature/gene metadata ( rowData)\n添加行元数据rawData注释基因，DataFrame中每行对应一个基因，每列对应一个基因元数据字段，例如转录本长度、基因符号等注释。（ Figure 6.1 ,绿色框）\n\n6.3.0.1 rowData\n\n\nCoderowData(sce)\n#&gt; DataFrame with 46603 rows and 0 columns\nrowData(sce)$Length &lt;- gene_length\nrowData(sce)\n#&gt; DataFrame with 46603 rows and 1 column\n#&gt;                       Length\n#&gt;                    &lt;integer&gt;\n#&gt; ENSMUSG00000102693      1070\n#&gt; ENSMUSG00000064842       110\n#&gt; ENSMUSG00000051951      6094\n#&gt; ENSMUSG00000102851       480\n#&gt; ENSMUSG00000103377      2819\n#&gt; ...                      ...\n#&gt; ENSMUSG00000094431       100\n#&gt; ENSMUSG00000094621       121\n#&gt; ENSMUSG00000098647        99\n#&gt; ENSMUSG00000096730      3077\n#&gt; ENSMUSG00000095742       243\n\n\n某些函数在rowData中返回额外基因元数据字段，自动添加行元数据。\n\nCodesce &lt;- scuttle::addPerFeatureQC(sce)\nrowData(sce)\n#&gt; DataFrame with 46603 rows and 3 columns\n#&gt;                       Length      mean  detected\n#&gt;                    &lt;integer&gt; &lt;numeric&gt; &lt;numeric&gt;\n#&gt; ENSMUSG00000102693      1070 0.0000000   0.00000\n#&gt; ENSMUSG00000064842       110 0.0000000   0.00000\n#&gt; ENSMUSG00000051951      6094 0.0000000   0.00000\n#&gt; ENSMUSG00000102851       480 0.0000000   0.00000\n#&gt; ENSMUSG00000103377      2819 0.0208333   1.04167\n#&gt; ...                      ...       ...       ...\n#&gt; ENSMUSG00000094431       100         0         0\n#&gt; ENSMUSG00000094621       121         0         0\n#&gt; ENSMUSG00000098647        99         0         0\n#&gt; ENSMUSG00000096730      3077         0         0\n#&gt; ENSMUSG00000095742       243         0         0\n\n\n\n6.3.0.2 rowRanges\n\nrowRanges：以GRangesList或 GRanges的形式保存基因组坐标，描述了特征（基因、基因组区域）的染色体、起始坐标和结束坐标。\n\nCodeSummarizedExperiment::rowRanges(sce)  #empty\n#&gt; GRangesList object of length 46603:\n#&gt; $ENSMUSG00000102693\n#&gt; GRanges object with 0 ranges and 0 metadata columns:\n#&gt;    seqnames    ranges strand\n#&gt;       &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   -------\n#&gt;   seqinfo: no sequences\n#&gt; \n#&gt; $ENSMUSG00000064842\n#&gt; GRanges object with 0 ranges and 0 metadata columns:\n#&gt;    seqnames    ranges strand\n#&gt;       &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   -------\n#&gt;   seqinfo: no sequences\n#&gt; \n#&gt; $ENSMUSG00000051951\n#&gt; GRanges object with 0 ranges and 0 metadata columns:\n#&gt;    seqnames    ranges strand\n#&gt;       &lt;Rle&gt; &lt;IRanges&gt;  &lt;Rle&gt;\n#&gt;   -------\n#&gt;   seqinfo: no sequences\n#&gt; \n#&gt; ...\n#&gt; &lt;46600 more elements&gt;\n\n\n填充 rowRanges的方式取决于在比对和定量过程中使用的生物体种类和注释文件。 常用的是Ensembl 标识符，因此我们可以使用rtracklayer从包含 Ensembl 注释的 GTF 文件中载入GRanges。下载：Mus_musculus.GRCm38.82.gtf.gz\n\nCodegene_data &lt;- rtracklayer::import(\"data/SingleCellExperiment/Mus_musculus.GRCm38.82.gtf.gz\")\nhead(gene_data)\n#&gt; GRanges object with 6 ranges and 26 metadata columns:\n#&gt;       seqnames          ranges strand |   source       type     score     phase\n#&gt;          &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; | &lt;factor&gt;   &lt;factor&gt; &lt;numeric&gt; &lt;integer&gt;\n#&gt;   [1]        1 3073253-3074322      + |  havana  gene              NA      &lt;NA&gt;\n#&gt;   [2]        1 3073253-3074322      + |  havana  transcript        NA      &lt;NA&gt;\n#&gt;   [3]        1 3073253-3074322      + |  havana  exon              NA      &lt;NA&gt;\n#&gt;   [4]        1 3102016-3102125      + |  ensembl gene              NA      &lt;NA&gt;\n#&gt;   [5]        1 3102016-3102125      + |  ensembl transcript        NA      &lt;NA&gt;\n#&gt;   [6]        1 3102016-3102125      + |  ensembl exon              NA      &lt;NA&gt;\n#&gt;                  gene_id gene_version     gene_name gene_source gene_biotype\n#&gt;              &lt;character&gt;  &lt;character&gt;   &lt;character&gt; &lt;character&gt;  &lt;character&gt;\n#&gt;   [1] ENSMUSG00000102693            1 4933401J01Rik      havana          TEC\n#&gt;   [2] ENSMUSG00000102693            1 4933401J01Rik      havana          TEC\n#&gt;   [3] ENSMUSG00000102693            1 4933401J01Rik      havana          TEC\n#&gt;   [4] ENSMUSG00000064842            1       Gm26206     ensembl        snRNA\n#&gt;   [5] ENSMUSG00000064842            1       Gm26206     ensembl        snRNA\n#&gt;   [6] ENSMUSG00000064842            1       Gm26206     ensembl        snRNA\n#&gt;              havana_gene havana_gene_version      transcript_id\n#&gt;              &lt;character&gt;         &lt;character&gt;        &lt;character&gt;\n#&gt;   [1] OTTMUSG00000049935                   1               &lt;NA&gt;\n#&gt;   [2] OTTMUSG00000049935                   1 ENSMUST00000193812\n#&gt;   [3] OTTMUSG00000049935                   1 ENSMUST00000193812\n#&gt;   [4]               &lt;NA&gt;                &lt;NA&gt;               &lt;NA&gt;\n#&gt;   [5]               &lt;NA&gt;                &lt;NA&gt; ENSMUST00000082908\n#&gt;   [6]               &lt;NA&gt;                &lt;NA&gt; ENSMUST00000082908\n#&gt;       transcript_version   transcript_name transcript_source transcript_biotype\n#&gt;              &lt;character&gt;       &lt;character&gt;       &lt;character&gt;        &lt;character&gt;\n#&gt;   [1]               &lt;NA&gt;              &lt;NA&gt;              &lt;NA&gt;               &lt;NA&gt;\n#&gt;   [2]                  1 4933401J01Rik-001            havana                TEC\n#&gt;   [3]                  1 4933401J01Rik-001            havana                TEC\n#&gt;   [4]               &lt;NA&gt;              &lt;NA&gt;              &lt;NA&gt;               &lt;NA&gt;\n#&gt;   [5]                  1       Gm26206-201           ensembl              snRNA\n#&gt;   [6]                  1       Gm26206-201           ensembl              snRNA\n#&gt;        havana_transcript havana_transcript_version         tag\n#&gt;              &lt;character&gt;               &lt;character&gt; &lt;character&gt;\n#&gt;   [1]               &lt;NA&gt;                      &lt;NA&gt;        &lt;NA&gt;\n#&gt;   [2] OTTMUST00000127109                         1       basic\n#&gt;   [3] OTTMUST00000127109                         1       basic\n#&gt;   [4]               &lt;NA&gt;                      &lt;NA&gt;        &lt;NA&gt;\n#&gt;   [5]               &lt;NA&gt;                      &lt;NA&gt;       basic\n#&gt;   [6]               &lt;NA&gt;                      &lt;NA&gt;       basic\n#&gt;       transcript_support_level exon_number            exon_id exon_version\n#&gt;                    &lt;character&gt; &lt;character&gt;        &lt;character&gt;  &lt;character&gt;\n#&gt;   [1]                     &lt;NA&gt;        &lt;NA&gt;               &lt;NA&gt;         &lt;NA&gt;\n#&gt;   [2]                       NA        &lt;NA&gt;               &lt;NA&gt;         &lt;NA&gt;\n#&gt;   [3]                       NA           1 ENSMUSE00001343744            1\n#&gt;   [4]                     &lt;NA&gt;        &lt;NA&gt;               &lt;NA&gt;         &lt;NA&gt;\n#&gt;   [5]                       NA        &lt;NA&gt;               &lt;NA&gt;         &lt;NA&gt;\n#&gt;   [6]                       NA           1 ENSMUSE00000522066            1\n#&gt;           ccds_id  protein_id protein_version\n#&gt;       &lt;character&gt; &lt;character&gt;     &lt;character&gt;\n#&gt;   [1]        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;\n#&gt;   [2]        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;\n#&gt;   [3]        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;\n#&gt;   [4]        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;\n#&gt;   [5]        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;\n#&gt;   [6]        &lt;NA&gt;        &lt;NA&gt;            &lt;NA&gt;\n#&gt;   -------\n#&gt;   seqinfo: 45 sequences from an unspecified genome; no seqlengths\n\n# 整理数据\ngene_data &lt;- gene_data[gene_data$type==\"gene\",]\nnames(gene_data) &lt;- gene_data$gene_id\n\n#DataFrame：mcols(gene_data) \nis.gene.related &lt;- str_detect(colnames(mcols(gene_data)),\"gene_\") #  6 TRUE\nmcols(gene_data) &lt;- mcols(gene_data)[,is.gene.related]\nmcols(gene_data)  # 46603 × 6\n#&gt; DataFrame with 46603 rows and 6 columns\n#&gt;                               gene_id gene_version      gene_name\n#&gt;                           &lt;character&gt;  &lt;character&gt;    &lt;character&gt;\n#&gt; ENSMUSG00000102693 ENSMUSG00000102693            1  4933401J01Rik\n#&gt; ENSMUSG00000064842 ENSMUSG00000064842            1        Gm26206\n#&gt; ENSMUSG00000051951 ENSMUSG00000051951            5           Xkr4\n#&gt; ENSMUSG00000102851 ENSMUSG00000102851            1        Gm18956\n#&gt; ENSMUSG00000103377 ENSMUSG00000103377            1        Gm37180\n#&gt; ...                               ...          ...            ...\n#&gt; ENSMUSG00000094431 ENSMUSG00000094431            1 CAAA01205117.1\n#&gt; ENSMUSG00000094621 ENSMUSG00000094621            1 CAAA01098150.1\n#&gt; ENSMUSG00000098647 ENSMUSG00000098647            1 CAAA01064564.1\n#&gt; ENSMUSG00000096730 ENSMUSG00000096730            6       Vmn2r122\n#&gt; ENSMUSG00000095742 ENSMUSG00000095742            1 CAAA01147332.1\n#&gt;                       gene_source         gene_biotype havana_gene_version\n#&gt;                       &lt;character&gt;          &lt;character&gt;         &lt;character&gt;\n#&gt; ENSMUSG00000102693         havana                  TEC                   1\n#&gt; ENSMUSG00000064842        ensembl                snRNA                  NA\n#&gt; ENSMUSG00000051951 ensembl_havana       protein_coding                   2\n#&gt; ENSMUSG00000102851         havana processed_pseudogene                   1\n#&gt; ENSMUSG00000103377         havana                  TEC                   1\n#&gt; ...                           ...                  ...                 ...\n#&gt; ENSMUSG00000094431        ensembl                miRNA                  NA\n#&gt; ENSMUSG00000094621        ensembl                miRNA                  NA\n#&gt; ENSMUSG00000098647        ensembl                miRNA                  NA\n#&gt; ENSMUSG00000096730        ensembl       protein_coding                  NA\n#&gt; ENSMUSG00000095742        ensembl       protein_coding                  NA\n\n#rownames(sce) 46603行 观测基因\nSummarizedExperiment::rowRanges(sce) &lt;- gene_data[rownames(sce)]\nSummarizedExperiment::rowRanges(sce)[1:6,]\n#&gt; GRanges object with 6 ranges and 6 metadata columns:\n#&gt;                      seqnames          ranges strand |            gene_id\n#&gt;                         &lt;Rle&gt;       &lt;IRanges&gt;  &lt;Rle&gt; |        &lt;character&gt;\n#&gt;   ENSMUSG00000102693        1 3073253-3074322      + | ENSMUSG00000102693\n#&gt;   ENSMUSG00000064842        1 3102016-3102125      + | ENSMUSG00000064842\n#&gt;   ENSMUSG00000051951        1 3205901-3671498      - | ENSMUSG00000051951\n#&gt;   ENSMUSG00000102851        1 3252757-3253236      + | ENSMUSG00000102851\n#&gt;   ENSMUSG00000103377        1 3365731-3368549      - | ENSMUSG00000103377\n#&gt;   ENSMUSG00000104017        1 3375556-3377788      - | ENSMUSG00000104017\n#&gt;                      gene_version     gene_name    gene_source\n#&gt;                       &lt;character&gt;   &lt;character&gt;    &lt;character&gt;\n#&gt;   ENSMUSG00000102693            1 4933401J01Rik         havana\n#&gt;   ENSMUSG00000064842            1       Gm26206        ensembl\n#&gt;   ENSMUSG00000051951            5          Xkr4 ensembl_havana\n#&gt;   ENSMUSG00000102851            1       Gm18956         havana\n#&gt;   ENSMUSG00000103377            1       Gm37180         havana\n#&gt;   ENSMUSG00000104017            1       Gm37363         havana\n#&gt;                              gene_biotype havana_gene_version\n#&gt;                               &lt;character&gt;         &lt;character&gt;\n#&gt;   ENSMUSG00000102693                  TEC                   1\n#&gt;   ENSMUSG00000064842                snRNA                &lt;NA&gt;\n#&gt;   ENSMUSG00000051951       protein_coding                   2\n#&gt;   ENSMUSG00000102851 processed_pseudogene                   1\n#&gt;   ENSMUSG00000103377                  TEC                   1\n#&gt;   ENSMUSG00000104017                  TEC                   1\n#&gt;   -------\n#&gt;   seqinfo: 45 sequences from an unspecified genome; no seqlengths\n\nsce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(6): gene_id gene_version ... gene_biotype\n#&gt;   havana_gene_version\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(6): genotype phenotype ... detected total\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):\n\n\n\n6.3.1 其他元数据\n其他注释以命名列表存储在metadata 中。 例如，实验元数据，高度可变基因（highly variable genes）。。。，缺点是与表达矩阵的行或列的操作不同步。\n\nCodeDEG_up &lt;- c(\"gene_x\", \"gene_y\")\nmetadata(sce) &lt;- list(HVGs = DEG_up)\nmetadata(sce)\n#&gt; $HVGs\n#&gt; [1] \"gene_x\" \"gene_y\"\nDEG_down &lt;- c(\"gene_a\", \"gene_b\")\nmetadata(sce)$DEG_down &lt;- DEG_down\nmetadata(sce)\n#&gt; $HVGs\n#&gt; [1] \"gene_x\" \"gene_y\"\n#&gt; \n#&gt; $DEG_down\n#&gt; [1] \"gene_a\" \"gene_b\"\nsce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(2): HVGs DEG_down\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(6): gene_id gene_version ... gene_biotype\n#&gt;   havana_gene_version\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(6): genotype phenotype ... detected total\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>`SingleCellExperiment`</span>"
    ]
  },
  {
    "objectID": "SingleCellExperiment.html#子集和组合",
    "href": "SingleCellExperiment.html#子集和组合",
    "title": "\n6  SingleCellExperiment\n",
    "section": "\n6.4 子集和组合",
    "text": "6.4 子集和组合\n\n6.4.1 子集\n\nCodefirst.10 &lt;- sce[,1:10]\nncol(counts(first.10)) #  计数矩阵仅有 10 列\n#&gt; [1] 10\ncolData(first.10) # only 10 rows.\n#&gt; DataFrame with 10 rows and 6 columns\n#&gt;                                                    genotype\n#&gt;                                                 &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S508.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N702_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N702_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt;                                                   phenotype    spike_in\n#&gt;                                                 &lt;character&gt; &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S508.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S517.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N702_S502.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N702_S503.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt;                                            sum  detected     total\n#&gt;                                      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    854171      7617    854171\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   1044243      7520   1044243\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   1152450      8305   1152450\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   1193876      8142   1193876\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1   1521472      7153   1521472\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1    866705      6828    866705\n#&gt; SLX-9555.N701_S508.C89V9ANXX.s_1.r_1    608581      6966    608581\n#&gt; SLX-9555.N701_S517.C89V9ANXX.s_1.r_1   1113526      8634   1113526\n#&gt; SLX-9555.N702_S502.C89V9ANXX.s_1.r_1   1308250      8364   1308250\n#&gt; SLX-9555.N702_S503.C89V9ANXX.s_1.r_1    778605      8665    778605\n\n\n只想要野生型细胞\n\nCodewt.only &lt;- sce[, sce$phenotype == \"wild type phenotype\"]\nncol(counts(wt.only))\n#&gt; [1] 48\ncolData(wt.only)\n#&gt; DataFrame with 48 rows and 6 columns\n#&gt;                                                    genotype           phenotype\n#&gt;                                                 &lt;character&gt;         &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N701_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N702_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; ...                                                     ...                 ...\n#&gt; SLX-9555.N711_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N712_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N712_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N712_S504.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl.. wild type phenotype\n#&gt;                                         spike_in       sum  detected     total\n#&gt;                                      &lt;character&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1   ERCC+SIRV    854171      7617    854171\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   ERCC+SIRV   1044243      7520   1044243\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   ERCC+SIRV   1152450      8305   1152450\n#&gt; SLX-9555.N701_S517.C89V9ANXX.s_1.r_1   ERCC+SIRV   1113526      8634   1113526\n#&gt; SLX-9555.N702_S502.C89V9ANXX.s_1.r_1   ERCC+SIRV   1308250      8364   1308250\n#&gt; ...                                          ...       ...       ...       ...\n#&gt; SLX-9555.N711_S517.C89V9ANXX.s_1.r_1    Premixed   1317671      8581   1317671\n#&gt; SLX-9555.N712_S502.C89V9ANXX.s_1.r_1    Premixed   1736189      9687   1736189\n#&gt; SLX-9555.N712_S503.C89V9ANXX.s_1.r_1    Premixed   1521132      8983   1521132\n#&gt; SLX-9555.N712_S504.C89V9ANXX.s_1.r_1    Premixed   1759166      8480   1759166\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1    Premixed   1436899      8469   1436899\n\n\n只想保留蛋白质编码基因\n\nCodecoding.only &lt;- sce[rowData(sce)$gene_biotype == \"protein_coding\",]\nnrow(counts(coding.only))\n#&gt; [1] 22013\nrowData(coding.only)\n#&gt; DataFrame with 22013 rows and 6 columns\n#&gt;                               gene_id gene_version      gene_name\n#&gt;                           &lt;character&gt;  &lt;character&gt;    &lt;character&gt;\n#&gt; ENSMUSG00000051951 ENSMUSG00000051951            5           Xkr4\n#&gt; ENSMUSG00000025900 ENSMUSG00000025900            9            Rp1\n#&gt; ENSMUSG00000025902 ENSMUSG00000025902           12          Sox17\n#&gt; ENSMUSG00000033845 ENSMUSG00000033845           12         Mrpl15\n#&gt; ENSMUSG00000025903 ENSMUSG00000025903           13         Lypla1\n#&gt; ...                               ...          ...            ...\n#&gt; ENSMUSG00000079808 ENSMUSG00000079808            3     AC168977.1\n#&gt; ENSMUSG00000095041 ENSMUSG00000095041            6           PISD\n#&gt; ENSMUSG00000063897 ENSMUSG00000063897            3          DHRSX\n#&gt; ENSMUSG00000096730 ENSMUSG00000096730            6       Vmn2r122\n#&gt; ENSMUSG00000095742 ENSMUSG00000095742            1 CAAA01147332.1\n#&gt;                       gene_source   gene_biotype havana_gene_version\n#&gt;                       &lt;character&gt;    &lt;character&gt;         &lt;character&gt;\n#&gt; ENSMUSG00000051951 ensembl_havana protein_coding                   2\n#&gt; ENSMUSG00000025900 ensembl_havana protein_coding                   2\n#&gt; ENSMUSG00000025902 ensembl_havana protein_coding                   6\n#&gt; ENSMUSG00000033845 ensembl_havana protein_coding                   3\n#&gt; ENSMUSG00000025903 ensembl_havana protein_coding                   3\n#&gt; ...                           ...            ...                 ...\n#&gt; ENSMUSG00000079808        ensembl protein_coding                  NA\n#&gt; ENSMUSG00000095041        ensembl protein_coding                  NA\n#&gt; ENSMUSG00000063897        ensembl protein_coding                  NA\n#&gt; ENSMUSG00000096730        ensembl protein_coding                  NA\n#&gt; ENSMUSG00000095742        ensembl protein_coding                  NA\n\n\n\n6.4.2 组合\n按列组合，假设所有涉及的对象都具有相同的行注释值和兼容的列注释字段\n\nCodesce2 &lt;- cbind(sce, sce)\nncol(counts(sce2)) # twice as many columns\n#&gt; [1] 192\ncolData(sce2) # twice as many rows\n#&gt; DataFrame with 192 rows and 6 columns\n#&gt;                                                    genotype\n#&gt;                                                 &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; ...                                                     ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1 Doxycycline-inducibl..\n#&gt;                                                   phenotype    spike_in\n#&gt;                                                 &lt;character&gt; &lt;character&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1    wild type phenotype   ERCC+SIRV\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..   ERCC+SIRV\n#&gt; ...                                                     ...         ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1 induced CBFB-MYH11 o..    Premixed\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1    wild type phenotype    Premixed\n#&gt;                                            sum  detected     total\n#&gt;                                      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1    854171      7617    854171\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   1044243      7520   1044243\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   1152450      8305   1152450\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   1193876      8142   1193876\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1   1521472      7153   1521472\n#&gt; ...                                        ...       ...       ...\n#&gt; SLX-9555.N712_S505.C89V9ANXX.s_1.r_1    203221      5608    203221\n#&gt; SLX-9555.N712_S506.C89V9ANXX.s_1.r_1   1059853      6948   1059853\n#&gt; SLX-9555.N712_S507.C89V9ANXX.s_1.r_1   1672343      6879   1672343\n#&gt; SLX-9555.N712_S508.C89V9ANXX.s_1.r_1   1939537      7213   1939537\n#&gt; SLX-9555.N712_S517.C89V9ANXX.s_1.r_1   1436899      8469   1436899\n\n\n按行组合，假设所有对象都具有相同的列注释值和兼容的行注释字段。\n\nCodesce2 &lt;- rbind(sce, sce)\nnrow(counts(sce2)) # twice as many rows\n#&gt; [1] 93206\nrowData(sce2) # twice as many rows\n#&gt; DataFrame with 93206 rows and 6 columns\n#&gt;                               gene_id gene_version      gene_name\n#&gt;                           &lt;character&gt;  &lt;character&gt;    &lt;character&gt;\n#&gt; ENSMUSG00000102693 ENSMUSG00000102693            1  4933401J01Rik\n#&gt; ENSMUSG00000064842 ENSMUSG00000064842            1        Gm26206\n#&gt; ENSMUSG00000051951 ENSMUSG00000051951            5           Xkr4\n#&gt; ENSMUSG00000102851 ENSMUSG00000102851            1        Gm18956\n#&gt; ENSMUSG00000103377 ENSMUSG00000103377            1        Gm37180\n#&gt; ...                               ...          ...            ...\n#&gt; ENSMUSG00000094431 ENSMUSG00000094431            1 CAAA01205117.1\n#&gt; ENSMUSG00000094621 ENSMUSG00000094621            1 CAAA01098150.1\n#&gt; ENSMUSG00000098647 ENSMUSG00000098647            1 CAAA01064564.1\n#&gt; ENSMUSG00000096730 ENSMUSG00000096730            6       Vmn2r122\n#&gt; ENSMUSG00000095742 ENSMUSG00000095742            1 CAAA01147332.1\n#&gt;                       gene_source         gene_biotype havana_gene_version\n#&gt;                       &lt;character&gt;          &lt;character&gt;         &lt;character&gt;\n#&gt; ENSMUSG00000102693         havana                  TEC                   1\n#&gt; ENSMUSG00000064842        ensembl                snRNA                  NA\n#&gt; ENSMUSG00000051951 ensembl_havana       protein_coding                   2\n#&gt; ENSMUSG00000102851         havana processed_pseudogene                   1\n#&gt; ENSMUSG00000103377         havana                  TEC                   1\n#&gt; ...                           ...                  ...                 ...\n#&gt; ENSMUSG00000094431        ensembl                miRNA                  NA\n#&gt; ENSMUSG00000094621        ensembl                miRNA                  NA\n#&gt; ENSMUSG00000098647        ensembl                miRNA                  NA\n#&gt; ENSMUSG00000096730        ensembl       protein_coding                  NA\n#&gt; ENSMUSG00000095742        ensembl       protein_coding                  NA",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>`SingleCellExperiment`</span>"
    ]
  },
  {
    "objectID": "SingleCellExperiment.html#单细胞特定字段",
    "href": "SingleCellExperiment.html#单细胞特定字段",
    "title": "\n6  SingleCellExperiment\n",
    "section": "\n6.5 单细胞特定字段",
    "text": "6.5 单细胞特定字段\n\n6.5.1 降维 reducedDims\n\n降维结果保存在一个列表中，列表的每一个对象是一个代表计数矩阵的低维的数值矩阵，其中行表示计数矩阵的列（如细胞），列表示维度。\n\nPCAsce\n#&gt; class: SingleCellExperiment \n#&gt; dim: 46603 96 \n#&gt; metadata(2): HVGs DEG_down\n#&gt; assays(1): counts\n#&gt; rownames(46603): ENSMUSG00000102693 ENSMUSG00000064842 ...\n#&gt;   ENSMUSG00000096730 ENSMUSG00000095742\n#&gt; rowData names(6): gene_id gene_version ... gene_biotype\n#&gt;   havana_gene_version\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(6): genotype phenotype ... detected total\n#&gt; reducedDimNames(0):\n#&gt; mainExpName: NULL\n#&gt; altExpNames(0):\nsce &lt;- scater::logNormCounts(sce)\nsce &lt;- scater::runPCA(sce)\nhead(reducedDim(sce, \"PCA\"))\n#&gt;                                              PC1        PC2        PC3\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -25.3211829  29.255059 -19.924611\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  -8.5853041  24.268878  18.126000\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 -47.1785847  10.430627 -19.918057\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   0.7246197 -42.677052  18.786200\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  44.8772729  -7.165398   2.557318\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  38.3072406  -7.030712   6.703706\n#&gt;                                            PC4         PC5       PC6       PC7\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  2.353028   0.7134296 -4.657165 -4.529785\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  9.457525   6.6261762 -7.374656  9.479859\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  9.043069   0.5371746  5.369461 -4.579162\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 10.052217 -11.2629834  5.066610 -3.989710\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  2.063798  23.2470805  9.972536 -2.224446\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 35.617030  11.8510185 -5.534609 -1.628105\n#&gt;                                             PC8        PC9       PC10      PC11\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -12.739486 -5.3528313 17.4712747 -6.272022\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  -9.933231  3.0253703  7.7697509  8.628675\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   5.394808  0.2653627 -1.9569984  1.742621\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1  -1.609922  5.9842292 -4.2662705 -7.924183\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  -0.922675  3.3105931 10.4905096  3.991925\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  10.031722 -1.3764729  0.6400844  2.048618\n#&gt;                                            PC12       PC13         PC14\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1   1.309453  -2.142689  -3.21487530\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -23.782808 -13.086537  -0.07695582\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   5.794494  -1.081155   5.37813494\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   4.118848   1.318160  -3.08602026\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1   2.945433  -7.997875  -2.60771987\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  16.074028   1.601696 -14.46500274\n#&gt;                                           PC15        PC16        PC17\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -3.586042   0.8868563  -8.3092835\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -1.622621 -16.5055262   7.0968297\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 -4.204543   2.4987753  -6.1373345\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 -1.632896 -14.2865809 -10.6386401\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 19.278739  10.3415881   2.3761618\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 -9.901801 -14.8844890   0.5659762\n#&gt;                                           PC18       PC19       PC20      PC21\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  8.254021  3.2032199  -8.400580 -6.046180\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -7.479420  2.3893440 -11.335409  2.781302\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 -6.841587  2.0491731  12.153631  7.230595\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1  6.811841  4.3494316 -11.066570  4.998028\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 -7.564805 -0.5513294   2.781294 14.916002\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  2.644617  3.7978583  -1.368715 16.096460\n#&gt;                                             PC22       PC23       PC24\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  -0.3084271 15.4402055  -4.681700\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -10.9606893  0.9337166  12.282928\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  -4.2540263 -3.7111678   2.971526\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   3.7927570 -5.8715888   7.261821\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1   0.6490183 -5.7146241   6.742021\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1   1.5767236  1.6884199 -15.742625\n#&gt;                                            PC25        PC26      PC27\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  6.8980048   6.9414484 -2.542829\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  7.7927146  15.5028217 -4.475004\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  1.0340304  -3.0595966  7.788931\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 -0.1469728   0.3389878  4.334259\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 -9.0437395 -13.3845540  4.173710\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 -2.8595182  -1.0181258 -3.088050\n#&gt;                                            PC28        PC29         PC30\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  -9.985183  3.49240985 -15.80727198\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   8.571937 -1.37038588  11.10310511\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   3.190580  0.07106325  -0.01329056\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 -13.180193 12.61790029  -1.88963759\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  -5.856713 -2.51899198 -12.55439568\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  17.295198  3.71292452 -11.41168626\n#&gt;                                            PC31       PC32       PC33\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -0.5220196  -7.013530   6.114895\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -6.5958587 -13.719887 -11.659703\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  7.0592846  -3.650680  -4.115808\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 18.5238767  -2.819896   9.079732\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  1.9920756  -8.699811  -8.695278\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  4.4201476  -5.879863   1.344748\n#&gt;                                            PC34      PC35       PC36      PC37\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  8.0054624  8.761877 -8.7666596 -4.146180\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -5.4103879  5.109168  2.3577599 -8.559027\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1 -2.7495522 -2.431918  3.9233042  2.049022\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1  0.6305226 -6.234937 -4.1432864  8.396337\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  6.0949988  4.720441  6.2858893 -2.584457\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  3.3667688  5.063130  0.7113685 10.266019\n#&gt;                                            PC38      PC39        PC40      PC41\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  -4.632087  7.384395   5.3545001  3.939611\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  -1.528232  6.537447  -0.6943536  8.165024\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   2.601003  5.790073   0.4880258  3.556190\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1  -5.866749  4.707630   5.3081910 -1.450141\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 -11.548363  6.699724 -17.0674135 -7.091337\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1   4.807745 -6.021079   1.2115131  1.975210\n#&gt;                                            PC42       PC43        PC44\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -13.753571  -2.933861 -7.10867875\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   8.682295  -5.419327 -0.09050594\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  11.034037   1.609018 -0.63401272\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   3.135220   3.758943  4.57483870\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1   9.855553   7.788290 -9.95694103\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1   1.080137 -14.012539 -1.94998479\n#&gt;                                           PC45      PC46        PC47\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -2.744699  0.355707  2.91053223\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -3.099078 -3.056113 -0.99066811\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  7.388260 -4.830818 -0.05645294\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 -6.691166 -4.624828 -1.52788619\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  3.096031  4.881210 -4.97966497\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 -0.468822 -6.805307 11.00800688\n#&gt;                                             PC48       PC49      PC50\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1 -12.9108877 -0.9585282 -1.467739\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1   3.8658064  9.6253994 -4.673170\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1   7.4661407 14.3185947 -4.003987\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1   0.7401263  0.2276260  1.547810\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1  -6.4756485 -7.2104770  2.538169\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1  -2.5984816 -3.5582484 -7.319542\n\n\n\ntSNEsce &lt;- scater::runTSNE(sce, perplexity = 0.1)\n#&gt; Perplexity should be lower than K!\nhead(reducedDim(sce, \"TSNE\"))\n#&gt;                                          TSNE1     TSNE2\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  185.3256 -158.7972\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 -679.3032  252.8552\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  166.8519  736.3854\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 -893.5536  140.0351\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 -416.8389 -526.3867\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 -452.0712  297.4060\n\n\n\nUMAPsce &lt;- scater::runUMAP(sce)\nhead(reducedDim(sce,\"UMAP\"))\n#&gt;                                           UMAP1     UMAP2\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  1.5431335 -4.268510\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  1.5042079 -3.235889\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  1.7226377 -4.767628\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1 -0.5918661 -4.665864\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 -0.5290605  5.023812\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 -0.4545190  6.061823\n\n\n\n手动添加UMAPu &lt;- uwot::umap(t(logcounts(sce)), n_neighbors = 2)\nreducedDim(sce, \"UMAP_uwot\") &lt;- u\nreducedDims(sce) # Now stored in the object.\n#&gt; List of length 4\n#&gt; names(4): PCA TSNE UMAP UMAP_uwot\nhead(reducedDim(sce, \"UMAP_uwot\"))\n#&gt;                                           [,1]       [,2]\n#&gt; SLX-9555.N701_S502.C89V9ANXX.s_1.r_1  5.834239  2.5875897\n#&gt; SLX-9555.N701_S503.C89V9ANXX.s_1.r_1  7.348785 -0.1624644\n#&gt; SLX-9555.N701_S504.C89V9ANXX.s_1.r_1  6.387993  1.5034396\n#&gt; SLX-9555.N701_S505.C89V9ANXX.s_1.r_1  9.859190 -3.5148664\n#&gt; SLX-9555.N701_S506.C89V9ANXX.s_1.r_1 -2.128991 -4.4457545\n#&gt; SLX-9555.N701_S507.C89V9ANXX.s_1.r_1 -4.087962 -0.7742339\n\n\n\nCodereducedDims(sce) \n#&gt; List of length 4\n#&gt; names(4): PCA TSNE UMAP UMAP_uwot\n\n\n\n6.5.2 替代试验 Alternative Experiments\nSingleCellExperiment提供了”替代实验”的概念，其是一组不同特征但同一组样本/细胞的数据。经典应用是存储加标转录（spike-in transcripts）的每细胞计数，能够保留这些数据以供下游使用，但要将其与保存的内源性基因计数分离，因为此类替代特征通常需要单独处理。\n\nCodespike.df &lt;- spike.df |&gt; column_to_rownames(\"GeneID\")\nspike_length &lt;- spike.df$Length\nspike.mat&lt;- as.matrix(spike.df[,-1]) \nspike.mat[1:2,1:2]\n#&gt;            SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt; ERCC-00002                                12948\n#&gt; ERCC-00003                                  220\n#&gt;            SLX-9555.N701_S503.C89V9ANXX.s_1.r_1\n#&gt; ERCC-00002                                11287\n#&gt; ERCC-00003                                  911\n\n\n首先创建一个单独的对象SummarizedExperiment\n\nCodespike_se &lt;- SummarizedExperiment(list(counts=spike.mat))\nspike_se\n#&gt; class: SummarizedExperiment \n#&gt; dim: 92 96 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(92): ERCC-00002 ERCC-00003 ... ERCC-00170 ERCC-00171\n#&gt; rowData names(0):\n#&gt; colnames(96): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1 ...\n#&gt;   SLX-9555.N712_S508.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N712_S517.C89V9ANXX.s_1.r_1\n#&gt; colData names(0):\n\n\n\nCodealtExp(sce, \"spike\") &lt;- spike_se\n\naltExps(sce) \n#&gt; List of length 1\n#&gt; names(1): spike\n\n\n替代实验概念确保单细胞数据集的所有相关方面都可以保存在单个对象中，并且确保我们的加标数据与内源性基因的数据同步。\n\nCodesub &lt;- sce[,1:2] # retain only two samples.\naltExp(sub, \"spike\")\n#&gt; class: SummarizedExperiment \n#&gt; dim: 92 2 \n#&gt; metadata(0):\n#&gt; assays(1): counts\n#&gt; rownames(92): ERCC-00002 ERCC-00003 ... ERCC-00170 ERCC-00171\n#&gt; rowData names(0):\n#&gt; colnames(2): SLX-9555.N701_S502.C89V9ANXX.s_1.r_1\n#&gt;   SLX-9555.N701_S503.C89V9ANXX.s_1.r_1\n#&gt; colData names(0):\n\n\n任何SummarizedExperiment对象都可以存储为alternative Experiment, 包括另一个 SingleCellExperiment。\n\n6.5.3 缩放因子sizeFactors\n\n\nCode# 反卷积deconvolution-based size factors\nsce &lt;- scran::computeSumFactors(sce) \nsummary(sizeFactors(sce))\n#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#&gt;  0.1513  0.7417  0.9478  1.0000  1.1239  3.5583\n\n\n\n6.5.4 文库大小因子\n\nCode# library size-derived factors\nsizeFactors(sce) &lt;- scater::librarySizeFactors(sce) \nsummary(sizeFactors(sce))\n#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#&gt;  0.1703  0.7657  0.9513  1.0000  1.1064  3.6050\n\n\n\n6.5.5 列标签\n该函数允许我们获取或设置每个细胞标签的向量或因子，通常对应于由无监督聚类分析的分组 或从分类算法预测细胞类型身份。\n\nCodecolLabels(sce) &lt;- scran::clusterCells(sce, use.dimred=\"PCA\")\ntable(colLabels(sce))\n#&gt; \n#&gt;  1  2 \n#&gt; 47 49",
    "crumbs": [
      "数据结构与数据库",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>`SingleCellExperiment`</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html",
    "href": "DEGs_Analysis.html",
    "title": "\n7  差异表达基因分析\n",
    "section": "",
    "text": "7.1 数据\nhttps://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html\n肺腺癌\nLung Adenocarcinoma (LUAD) gene expression RNAseq HTSeq - Counts （n=585） GDC 中心 和Phenotype (n=877)",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#assays",
    "href": "DEGs_Analysis.html#assays",
    "title": "\n7  差异表达基因分析\n",
    "section": "\n7.2 Assays",
    "text": "7.2 Assays\n\n7.2.1 对数计数矩阵\n\nCodelibrary(arrow, warn.conflicts = FALSE)\n\nlogCount &lt;- read_tsv_arrow(\"data/DEGs_Analysis/TCGA-LUAD.htseq_counts.tsv.gz\")\n# 读取计数矩阵 log2(count+1)  # 60488 个gene ×  586 个sample",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#基因元数据",
    "href": "DEGs_Analysis.html#基因元数据",
    "title": "\n7  差异表达基因分析\n",
    "section": "\n7.3 基因元数据",
    "text": "7.3 基因元数据\n如果分析总的转录本，不需要把mRNA、lncRNA等挑出来，所以下载的这个自带注释文件ID/Gene Mapping\n\nCodegtf_v22_transcripts &lt;- read_delim(\"data/DEGs_Analysis/gencode.v22.annotation.gene.probeMap\")\n\n\n如果只想用蛋白质编码（protein_coding）相关基因，用全基因编码注释文件 gencode.v46.annotation.gtf.gz\n\nCode# 全基因编码  BiocManager::install(\"rtracklayer\")\ngtf_v46 &lt;- rtracklayer::import('data/DEGs_Analysis/gencode.v46.annotation.gtf.gz') |&gt;\n as_tibble()\n\ndistinct(gtf_v46,gene_type)\ndistinct(gtf_v46,gene_name)\n\n# 选择 蛋白编码mRNA相关基因\ngtf_v46_mRNA &lt;- dplyr::select(gtf_v46,\n                              c(\"gene_id\",\"gene_type\", \"gene_name\"))|&gt; \n    dplyr::filter(gene_type == \"protein_coding\") |&gt;  \n    distinct()\n\nhead(gtf_v46_mRNA )\nwrite.csv(gtf_v46_mRNA,\"data/gtf_v46_mRNA.csv\")\n\n\n\n7.3.1 根据 ENSEBML 编码内连接\n\nCodegene_logCount &lt;- logCount |&gt; \n  inner_join(gtf_v22_transcripts, by = c(\"Ensembl_ID\" = \"id\")) |&gt; \n  dplyr::select(gene, starts_with(\"TCGA\") )\n\n\n\nCodedim(gene_logCount)\n#&gt; [1] 60483   586\ngene_logCount[1:6,1:3]\n\n\n\n\ngene\nTCGA-97-7938-01A\nTCGA-55-7574-01A\n\n\n\nTSPAN6\n10.989394\n9.967226\n\n\nTNMD\n4.000000\n0.000000\n\n\nDPM1\n10.253847\n9.541097\n\n\nSCYL3\n9.776433\n9.131857\n\n\nC1orf112\n7.971544\n8.348728\n\n\nFGR\n8.724514\n9.703904\n\n\n\n\n\n\n\n7.3.2 还原原始数据\n先去对数 log2(count+1)\n\nCodelibrary(Rcpp)\nRcpp::sourceCpp(\"data/DEGs_Analysis/exponential_base2_transform.cpp\")\n\n# 该函数将 `log2(count + 1)` 转换为原始计数\ngene_Count &lt;- gene_logCount %&gt;%\n  mutate_if(is.numeric, ~ exponential_base2_transform(.))\n\n\n基因名是有重复的，查看重复情况\n\nCodegene_Count |&gt; distinct(gene) |&gt; dim()\n#&gt; [1] 58387     1\nrepeat_n &lt;- gene_Count |&gt; summarise(n=n(),.by = gene) |&gt; ungroup() |&gt; \n  summarise(重复n次的基因个数=n(),.by =n ) |&gt; arrange(n)\n# 唯一基因个数\nsum(repeat_n$重复n次的基因个数)\n#&gt; [1] 58387\n\n\n根据基因名分组，重复则取平均值去重，去掉重复的行\n\nCodelibrary(data.table)\nsetDT(gene_Count)\nCounts &lt;- gene_Count[,lapply(.SD,mean),by=gene, .SDcols=patterns(\"^(TCGA)\")]\n\n\n\nCodeCounts &lt;- Counts |&gt; column_to_rownames(\"gene\")\ndim(Counts)\n#&gt; [1] 58387   585\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nCodedf &lt;- tibble(\n    g=c('A','B','A','C','C'),\n    x=c(1:5),\n    y=c(3:7),\n    \n)\ndf\n\n\n\n\ng\nx\ny\n\n\n\nA\n1\n3\n\n\nB\n2\n4\n\n\nA\n3\n5\n\n\nC\n4\n6\n\n\nC\n5\n7\n\n\n\n\n\nCode# 数据多太慢了\ndf|&gt; group_by(g) |&gt; summarise_all(list(mean))\n\n\n\n\ng\nx\ny\n\n\n\nA\n2.0\n4.0\n\n\nB\n2.0\n4.0\n\n\nC\n4.5\n6.5\n\n\n\n\n\nCode\n\n# 转化成data.table\n# library(data.table) 非常快\n\nsetDT(df)\n# 对基因g进行分组，并对x和y列计算均值\ndf[, lapply(.SD, mean), by = g, .SDcols = patterns(\"x|y\")]\n\n\n\n\ng\nx\ny\n\n\n\nA\n2.0\n4.0\n\n\nB\n2.0\n4.0\n\n\nC\n4.5\n6.5\n\n\n\n\n\n\n\n\n提取lncRNA、miRNA等也是类似的操作",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#sample-metadata",
    "href": "DEGs_Analysis.html#sample-metadata",
    "title": "\n7  差异表达基因分析\n",
    "section": "\n7.4 Sample metadata",
    "text": "7.4 Sample metadata\n\n7.4.1 表型注释文件\n\nCode#首先载入下载好胆管癌的样本信息文件\n# 877 个sample × 125 个样本变量\ncolData &lt;- fread(\"data/DEGs_Analysis/TCGA-LUAD.GDC_phenotype.tsv.gz\", sep = \"\\t\", header = TRUE)\n\n\n# 选择样本  放疗与kras基因\ntable(colData$radiation_therapy,colData$kras_mutation_found)\n#&gt;      \n#&gt;            NO YES\n#&gt;       230   1   3\n#&gt;   NO  491  41  24\n#&gt;   YES  72  11   4\n\npf &lt;- colData |&gt; dplyr::filter(kras_mutation_found!= \"\") |&gt; \n  dplyr::filter(radiation_therapy!= \"\") |&gt; \n  dplyr::select(submitter_id.samples,submitter_id,radiation_therapy,kras_mutation_found)\n\n\nxtabs(formula = ~radiation_therapy+kras_mutation_found,data = pf,subset = NULL)\n#&gt;                  kras_mutation_found\n#&gt; radiation_therapy NO YES\n#&gt;               NO  41  24\n#&gt;               YES 11   4\n\n\n到这里，就从877个样本中挑出了80个样本，但是，我们只要这80个样本中成对样本的表达数据，即同一个病人既有癌旁正常细胞的表达蛋白，又有肿瘤细胞的异常表达蛋白。\n\n7.4.2 colData的成对样本\n\nCodeID &lt;- pf$submitter_id  # 前1~12字符\n\n\n# 21对配对样本\ntable(ID)[table(ID)==2] |&gt; length()\n#&gt; [1] 21\n\nPairedSample &lt;- pf |&gt; summarise(n=n(),.by = \"submitter_id\")|&gt; dplyr::filter(n==2)\nPairedSample \n\n\n\n\nsubmitter_id\nn\n\n\n\nTCGA-50-8457\n2\n\n\nTCGA-55-7913\n2\n\n\nTCGA-55-8089\n2\n\n\nTCGA-44-6148\n2\n\n\nTCGA-50-6593\n2\n\n\nTCGA-99-8028\n2\n\n\nTCGA-50-8459\n2\n\n\nTCGA-50-6594\n2\n\n\nTCGA-50-5936\n2\n\n\nTCGA-55-8205\n2\n\n\nTCGA-49-6744\n2\n\n\nTCGA-50-8460\n2\n\n\nTCGA-49-6742\n2\n\n\nTCGA-99-8033\n2\n\n\nTCGA-49-6745\n2\n\n\nTCGA-91-6848\n2\n\n\nTCGA-50-5066\n2\n\n\nTCGA-50-5935\n2\n\n\nTCGA-J2-8192\n2\n\n\nTCGA-44-6145\n2\n\n\nTCGA-55-7914\n2\n\n\n\n\n\nCodesample &lt;-  left_join(PairedSample,pf,by=join_by(\"submitter_id\"))\nsample\n\n\n\n\n\n\n\n\n\n\n\nsubmitter_id\nn\nsubmitter_id.samples\nradiation_therapy\nkras_mutation_found\n\n\n\nTCGA-50-8457\n2\nTCGA-50-8457-01A\nNO\nYES\n\n\nTCGA-50-8457\n2\nTCGA-50-8457-11A\nNO\nYES\n\n\nTCGA-55-7913\n2\nTCGA-55-7913-01B\nNO\nNO\n\n\nTCGA-55-7913\n2\nTCGA-55-7913-11A\nNO\nNO\n\n\nTCGA-55-8089\n2\nTCGA-55-8089-01A\nNO\nNO\n\n\nTCGA-55-8089\n2\nTCGA-55-8089-11A\nNO\nNO\n\n\nTCGA-44-6148\n2\nTCGA-44-6148-01A\nNO\nNO\n\n\nTCGA-44-6148\n2\nTCGA-44-6148-11A\nNO\nNO\n\n\nTCGA-50-6593\n2\nTCGA-50-6593-01A\nYES\nNO\n\n\nTCGA-50-6593\n2\nTCGA-50-6593-11A\nYES\nNO\n\n\nTCGA-99-8028\n2\nTCGA-99-8028-01A\nNO\nYES\n\n\nTCGA-99-8028\n2\nTCGA-99-8028-11A\nNO\nYES\n\n\nTCGA-50-8459\n2\nTCGA-50-8459-01A\nNO\nYES\n\n\nTCGA-50-8459\n2\nTCGA-50-8459-11A\nNO\nYES\n\n\nTCGA-50-6594\n2\nTCGA-50-6594-01A\nNO\nNO\n\n\nTCGA-50-6594\n2\nTCGA-50-6594-11A\nNO\nNO\n\n\nTCGA-50-5936\n2\nTCGA-50-5936-01A\nNO\nYES\n\n\nTCGA-50-5936\n2\nTCGA-50-5936-11A\nNO\nYES\n\n\nTCGA-55-8205\n2\nTCGA-55-8205-01A\nNO\nNO\n\n\nTCGA-55-8205\n2\nTCGA-55-8205-11A\nNO\nNO\n\n\nTCGA-49-6744\n2\nTCGA-49-6744-01A\nNO\nYES\n\n\nTCGA-49-6744\n2\nTCGA-49-6744-11A\nNO\nYES\n\n\nTCGA-50-8460\n2\nTCGA-50-8460-01A\nYES\nNO\n\n\nTCGA-50-8460\n2\nTCGA-50-8460-11A\nYES\nNO\n\n\nTCGA-49-6742\n2\nTCGA-49-6742-01A\nNO\nNO\n\n\nTCGA-49-6742\n2\nTCGA-49-6742-11A\nNO\nNO\n\n\nTCGA-99-8033\n2\nTCGA-99-8033-01A\nYES\nNO\n\n\nTCGA-99-8033\n2\nTCGA-99-8033-11A\nYES\nNO\n\n\nTCGA-49-6745\n2\nTCGA-49-6745-01A\nNO\nNO\n\n\nTCGA-49-6745\n2\nTCGA-49-6745-11A\nNO\nNO\n\n\nTCGA-91-6848\n2\nTCGA-91-6848-01A\nNO\nNO\n\n\nTCGA-91-6848\n2\nTCGA-91-6848-11A\nNO\nNO\n\n\nTCGA-50-5066\n2\nTCGA-50-5066-01A\nNO\nNO\n\n\nTCGA-50-5066\n2\nTCGA-50-5066-02A\nNO\nNO\n\n\nTCGA-50-5935\n2\nTCGA-50-5935-01A\nYES\nYES\n\n\nTCGA-50-5935\n2\nTCGA-50-5935-11A\nYES\nYES\n\n\nTCGA-J2-8192\n2\nTCGA-J2-8192-01A\nNO\nNO\n\n\nTCGA-J2-8192\n2\nTCGA-J2-8192-11A\nNO\nNO\n\n\nTCGA-44-6145\n2\nTCGA-44-6145-01A\nNO\nNO\n\n\nTCGA-44-6145\n2\nTCGA-44-6145-11A\nNO\nNO\n\n\nTCGA-55-7914\n2\nTCGA-55-7914-01A\nNO\nYES\n\n\nTCGA-55-7914\n2\nTCGA-55-7914-11A\nNO\nYES\n\n\n\n\n\nCodetable(sample$radiation_therapy,sample$kras_mutation_found)\n#&gt;      \n#&gt;       NO YES\n#&gt;   NO  22  12\n#&gt;   YES  6   2\n\n\n\n7.4.3 匹配 assays的成对样本\n并且colData 中出现的成对样本（21对）要匹配到assays 中的成对样本（60对）。（取交集）\n\nCode# 表达矩阵  \npatient_of_counts &lt;- str_sub(colnames(Counts),1,12)\n\n\npaired_patient &lt;- table(patient_of_counts)[table(patient_of_counts)==2]|&gt; \n names()  # 筛选出60对成对数据\npaired_patient |&gt; length()\n#&gt; [1] 60\n\n\n取sample和paired_patient的交集，有8对成对数据\n\nCode# 取交集\nfinal_sample &lt;- lubridate::intersect(sample$submitter_id,paired_patient)\nfinal_sample\n#&gt; [1] \"TCGA-44-6148\" \"TCGA-50-5936\" \"TCGA-49-6744\" \"TCGA-49-6742\" \"TCGA-49-6745\"\n#&gt; [6] \"TCGA-50-5066\" \"TCGA-50-5935\" \"TCGA-44-6145\"\n\nsample &lt;- sample |&gt;\n  dplyr::filter(sample$submitter_id %in% final_sample) |&gt;\n  dplyr::select(-submitter_id, -n) |&gt;\n  dplyr::rename(\"sample_id\" = \"submitter_id.samples\") |&gt;\n  arrange(sample_id)\n\nsample\n\n\n\n\nsample_id\nradiation_therapy\nkras_mutation_found\n\n\n\nTCGA-44-6145-01A\nNO\nNO\n\n\nTCGA-44-6145-11A\nNO\nNO\n\n\nTCGA-44-6148-01A\nNO\nNO\n\n\nTCGA-44-6148-11A\nNO\nNO\n\n\nTCGA-49-6742-01A\nNO\nNO\n\n\nTCGA-49-6742-11A\nNO\nNO\n\n\nTCGA-49-6744-01A\nNO\nYES\n\n\nTCGA-49-6744-11A\nNO\nYES\n\n\nTCGA-49-6745-01A\nNO\nNO\n\n\nTCGA-49-6745-11A\nNO\nNO\n\n\nTCGA-50-5066-01A\nNO\nNO\n\n\nTCGA-50-5066-02A\nNO\nNO\n\n\nTCGA-50-5935-01A\nYES\nYES\n\n\nTCGA-50-5935-11A\nYES\nYES\n\n\nTCGA-50-5936-01A\nNO\nYES\n\n\nTCGA-50-5936-11A\nNO\nYES\n\n\n\n\n\nCodetable(sample$radiation_therapy,sample$kras_mutation_found)\n#&gt;      \n#&gt;       NO YES\n#&gt;   NO  10   4\n#&gt;   YES  0   2\n\n\n\n\n# 最后的表达矩阵\nexprCounts &lt;- Counts  |&gt; dplyr::select(which(colnames(Counts) %in% sample$sample_id)) \n\nexprCounts &lt;- dplyr::select(exprCounts,order(colnames(exprCounts)))\ncolnames(exprCounts)\n#&gt;  [1] \"TCGA-44-6145-01A\" \"TCGA-44-6145-11A\" \"TCGA-44-6148-01A\" \"TCGA-44-6148-11A\"\n#&gt;  [5] \"TCGA-49-6742-01A\" \"TCGA-49-6742-11A\" \"TCGA-49-6744-01A\" \"TCGA-49-6744-11A\"\n#&gt;  [9] \"TCGA-49-6745-01A\" \"TCGA-49-6745-11A\" \"TCGA-50-5066-01A\" \"TCGA-50-5066-02A\"\n#&gt; [13] \"TCGA-50-5935-01A\" \"TCGA-50-5935-11A\" \"TCGA-50-5936-01A\" \"TCGA-50-5936-11A\"\ndim(exprCounts)\n#&gt; [1] 58387    16\n\n# 去除所有样本都不表达的基因\nexprCounts &lt;- exprCounts |&gt;\n    mutate(rowsum = apply(exprCounts,1,sum)) |&gt;\n    dplyr::filter(rowsum!=0) |&gt; \n    dplyr::select(-rowsum)\n\ndim(exprCounts)\n#&gt; [1] 46488    16\n\n\n\nCode# 检查计数矩阵和列数据，看看它们在样本顺序方面是否一致。\ncolnames(exprCounts)\n#&gt;  [1] \"TCGA-44-6145-01A\" \"TCGA-44-6145-11A\" \"TCGA-44-6148-01A\" \"TCGA-44-6148-11A\"\n#&gt;  [5] \"TCGA-49-6742-01A\" \"TCGA-49-6742-11A\" \"TCGA-49-6744-01A\" \"TCGA-49-6744-11A\"\n#&gt;  [9] \"TCGA-49-6745-01A\" \"TCGA-49-6745-11A\" \"TCGA-50-5066-01A\" \"TCGA-50-5066-02A\"\n#&gt; [13] \"TCGA-50-5935-01A\" \"TCGA-50-5935-11A\" \"TCGA-50-5936-01A\" \"TCGA-50-5936-11A\"\nsample$sample_id\n#&gt;  [1] \"TCGA-44-6145-01A\" \"TCGA-44-6145-11A\" \"TCGA-44-6148-01A\" \"TCGA-44-6148-11A\"\n#&gt;  [5] \"TCGA-49-6742-01A\" \"TCGA-49-6742-11A\" \"TCGA-49-6744-01A\" \"TCGA-49-6744-11A\"\n#&gt;  [9] \"TCGA-49-6745-01A\" \"TCGA-49-6745-11A\" \"TCGA-50-5066-01A\" \"TCGA-50-5066-02A\"\n#&gt; [13] \"TCGA-50-5935-01A\" \"TCGA-50-5935-11A\" \"TCGA-50-5936-01A\" \"TCGA-50-5936-11A\"\n\nall(sample$sample_id%in% colnames(exprCounts))\n#&gt; [1] TRUE\nall(sample$SampleID == colnames(exprCounts))\n#&gt; [1] TRUE",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#构造deg实例",
    "href": "DEGs_Analysis.html#构造deg实例",
    "title": "\n7  差异表达基因分析\n",
    "section": "\n7.5 构造DEG实例",
    "text": "7.5 构造DEG实例\n\nCodedim(exprCounts)\n#&gt; [1] 46488    16\ndim(sample)\n#&gt; [1] 16  3\nexprCounts &lt;- ceiling(exprCounts)\n\n\n根据TCGA样本的命名可以区分正常组织和肿瘤样本的测序结果 其中编号01-09表示肿瘤，10-19表示正常\n\nCode# 字符14~15，\nsample$condition &lt;- factor(\n ifelse(as.numeric(str_sub(sample$sample_id,14,15)) &lt; 10,'tumor','normal'),\n levels = c(\"normal\",\"tumor\"),\n ) \n\nsample &lt;- column_to_rownames(sample,var =\"sample_id\" )\nsample\n\n\n\n\n\nradiation_therapy\nkras_mutation_found\ncondition\n\n\n\nTCGA-44-6145-01A\nNO\nNO\ntumor\n\n\nTCGA-44-6145-11A\nNO\nNO\nnormal\n\n\nTCGA-44-6148-01A\nNO\nNO\ntumor\n\n\nTCGA-44-6148-11A\nNO\nNO\nnormal\n\n\nTCGA-49-6742-01A\nNO\nNO\ntumor\n\n\nTCGA-49-6742-11A\nNO\nNO\nnormal\n\n\nTCGA-49-6744-01A\nNO\nYES\ntumor\n\n\nTCGA-49-6744-11A\nNO\nYES\nnormal\n\n\nTCGA-49-6745-01A\nNO\nNO\ntumor\n\n\nTCGA-49-6745-11A\nNO\nNO\nnormal\n\n\nTCGA-50-5066-01A\nNO\nNO\ntumor\n\n\nTCGA-50-5066-02A\nNO\nNO\ntumor\n\n\nTCGA-50-5935-01A\nYES\nYES\ntumor\n\n\nTCGA-50-5935-11A\nYES\nYES\nnormal\n\n\nTCGA-50-5936-01A\nNO\nYES\ntumor\n\n\nTCGA-50-5936-11A\nNO\nYES\nnormal\n\n\n\n\n\n\n\nCode# BiocManager::install(\"DESeq2\")\nlibrary(DESeq2)\nconflicts_prefer(GenomicRanges::setdiff)\ndds &lt;- DESeqDataSetFromMatrix(countData = exprCounts,\n                              colData = sample,\n                              design = ~ condition)\ndds\n#&gt; class: DESeqDataSet \n#&gt; dim: 46488 16 \n#&gt; metadata(1): version\n#&gt; assays(1): counts\n#&gt; rownames(46488): TSPAN6 TNMD ... LINC01144 RP11-418H16.1\n#&gt; rowData names(0):\n#&gt; colnames(16): TCGA-44-6145-01A TCGA-44-6145-11A ... TCGA-50-5936-01A\n#&gt;   TCGA-50-5936-11A\n#&gt; colData names(3): radiation_therapy kras_mutation_found condition\n\n\n\n7.5.1 预过滤\n\nCodesmallestGroupSize &lt;- 8\n\nkeep &lt;- rowSums(counts(dds) &gt;= 10) &gt;= smallestGroupSize\ndds &lt;- dds[keep,]\ndds\n#&gt; class: DESeqDataSet \n#&gt; dim: 19562 16 \n#&gt; metadata(1): version\n#&gt; assays(1): counts\n#&gt; rownames(19562): TSPAN6 DPM1 ... RP11-274B21.13 LINC01144\n#&gt; rowData names(0):\n#&gt; colnames(16): TCGA-44-6145-01A TCGA-44-6145-11A ... TCGA-50-5936-01A\n#&gt;   TCGA-50-5936-11A\n#&gt; colData names(3): radiation_therapy kras_mutation_found condition\n\n\n\nCodedds$condition\n#&gt;  [1] tumor  normal tumor  normal tumor  normal tumor  normal tumor  normal\n#&gt; [11] tumor  tumor  tumor  normal tumor  normal\n#&gt; Levels: normal tumor\n\ndds@colData\n#&gt; DataFrame with 16 rows and 3 columns\n#&gt;                  radiation_therapy kras_mutation_found condition\n#&gt;                        &lt;character&gt;         &lt;character&gt;  &lt;factor&gt;\n#&gt; TCGA-44-6145-01A                NO                  NO    tumor \n#&gt; TCGA-44-6145-11A                NO                  NO    normal\n#&gt; TCGA-44-6148-01A                NO                  NO    tumor \n#&gt; TCGA-44-6148-11A                NO                  NO    normal\n#&gt; TCGA-49-6742-01A                NO                  NO    tumor \n#&gt; ...                            ...                 ...       ...\n#&gt; TCGA-50-5066-02A                NO                  NO    tumor \n#&gt; TCGA-50-5935-01A               YES                 YES    tumor \n#&gt; TCGA-50-5935-11A               YES                 YES    normal\n#&gt; TCGA-50-5936-01A                NO                 YES    tumor \n#&gt; TCGA-50-5936-11A                NO                 YES    normal\nhead(counts(dds)) #  19562   ×   16 \n#&gt;          TCGA-44-6145-01A TCGA-44-6145-11A TCGA-44-6148-01A TCGA-44-6148-11A\n#&gt; TSPAN6               1407              783             4794             3163\n#&gt; DPM1                 1293             1003              982             1158\n#&gt; SCYL3                 758              389              985              885\n#&gt; C1orf112              340               74              173              183\n#&gt; FGR                   747             3617              759             3076\n#&gt; CFH                  5718             2611            30270             8703\n#&gt;          TCGA-49-6742-01A TCGA-49-6742-11A TCGA-49-6744-01A TCGA-49-6744-11A\n#&gt; TSPAN6               3275             1696             2798             1360\n#&gt; DPM1                  922              986             1453              846\n#&gt; SCYL3                 838              498              808              514\n#&gt; C1orf112              261               95              271              119\n#&gt; FGR                   286             2126             1470             2712\n#&gt; CFH                  1574             5208             5880             3922\n#&gt;          TCGA-49-6745-01A TCGA-49-6745-11A TCGA-50-5066-01A TCGA-50-5066-02A\n#&gt; TSPAN6               2700             2194             3589             8759\n#&gt; DPM1                 1159             1584             2848             4398\n#&gt; SCYL3                 555              570              602             2118\n#&gt; C1orf112              386               98              483             1518\n#&gt; FGR                  1065             1631              541             1169\n#&gt; CFH                  6554             4153             2071             9081\n#&gt;          TCGA-50-5935-01A TCGA-50-5935-11A TCGA-50-5936-01A TCGA-50-5936-11A\n#&gt; TSPAN6               2199             1202             2537              725\n#&gt; DPM1                 1129              715              621              769\n#&gt; SCYL3                1349              441              556              553\n#&gt; C1orf112              386               60              346               80\n#&gt; FGR                   560             1831              519             3600\n#&gt; CFH                  1869             3667             4488             1881",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "DEGs_Analysis.html#差异分析",
    "href": "DEGs_Analysis.html#差异分析",
    "title": "\n7  差异表达基因分析\n",
    "section": "\n7.6 差异分析",
    "text": "7.6 差异分析\n\nCodedes &lt;- DESeq(dds)\n\nresults &lt;- results(\n  object = des,\n  contrast = c(\"condition\", \"tumor\", \"normal\"),\n  alpha = 0.05,\n  filter = rowMeans(counts(des, normalized = TRUE)),# 独立过滤\n  theta = c(0.025, 0.975),\n  pAdjustMethod = \"BH\",\n)\nmetadata(results)[\"alpha\"]\n#&gt; $alpha\n#&gt; [1] 0.05\n\nresults[1:6,]\n#&gt; log2 fold change (MLE): condition tumor vs normal \n#&gt; Wald test p-value: condition tumor vs normal \n#&gt; DataFrame with 6 rows and 6 columns\n#&gt;           baseMean log2FoldChange     lfcSE      stat      pvalue        padj\n#&gt;          &lt;numeric&gt;      &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;   &lt;numeric&gt;\n#&gt; TSPAN6    2491.784       1.009957  0.284407   3.55110 3.83631e-04 2.72195e-03\n#&gt; DPM1      1318.670       0.500631  0.336588   1.48737 1.36918e-01 2.72805e-01\n#&gt; SCYL3      734.633       0.605618  0.202489   2.99087 2.78184e-03 1.38997e-02\n#&gt; C1orf112   268.645       1.951846  0.287025   6.80026 1.04432e-11 7.96688e-10\n#&gt; FGR       1655.039      -1.947828  0.290586  -6.70310 2.04049e-11 1.44134e-09\n#&gt; CFH       5564.337       0.608888  0.464523   1.31078 1.89932e-01 3.45383e-01\nsummary(results)\n#&gt; \n#&gt; out of 19562 with nonzero total read count\n#&gt; adjusted p-value &lt; 0.05\n#&gt; LFC &gt; 0 (up)       : 3248, 17%\n#&gt; LFC &lt; 0 (down)     : 2160, 11%\n#&gt; outliers [1]       : 0, 0%\n#&gt; low counts [2]     : 490, 2.5%\n#&gt; (mean count &lt; 13)\n#&gt; [1] see 'cooksCutoff' argument of ?results\n#&gt; [2] see 'independentFiltering' argument of ?results\nsum(results$padj &lt; 0.05, na.rm=TRUE)\n#&gt; [1] 5408\n\n# 根据padj 升序\nresOrdered &lt;- results[order(results$padj),]\n\n\n\n7.6.1 保存结果\n保存csv以备热图、火山图、富集分析。\n\nCodex &lt;- as.data.frame(resOrdered) |&gt; rownames_to_column(var = \"gene\")\nwrite_csv(x, file=\"data/DEGs_Analysis/resOrdered.csv\")\n\n\n\nCodemcols(resOrdered)$description\n#&gt; [1] \"mean of normalized counts for all samples\"        \n#&gt; [2] \"log2 fold change (MLE): condition tumor vs normal\"\n#&gt; [3] \"standard error: condition tumor vs normal\"        \n#&gt; [4] \"Wald statistic: condition tumor vs normal\"        \n#&gt; [5] \"Wald test p-value: condition tumor vs normal\"     \n#&gt; [6] \"BH adjusted p-values\"\n\n\npvalue，是统计学检验变量，代表差异显著性，一般认为P &lt; 0.05 为显著， P &lt;0.01 为非常显著。其含义为：由抽样误差导致样本间差异的概率小于0.05 或0.01。\npadj，是对pvalue进行多重假设检验校正后的结果。转录组测序的差异表达分析是对大量的基因表达值进行的独立统计假设检验，存在假阳性（Family-Wise Error Rate，FWER），Bonferroni矫正\nqvalue，False Discovery Rate，FDR，所有假阳性结果占所有拒绝零假设结果的比例，假阳性结果的比例不超过预设的FDR水平（0.05/0.1）,基于pvalue的分布。多重假设检验校正方法：Benjamini-Hochberg，\nlog2FoldChange：对数倍数变化，1.5倍差异即0.585，2倍差异即1。\n\n\n\n\n\nCodeDEG &lt;- read_csv(\"data/DEGs_Analysis/resOrdered.csv\")\n\nDESeq2_DEG &lt;- na.omit(DEG) \nnrDEG &lt;- DESeq2_DEG\nnrDEG[1:25,]\n\n\n\n\n\n\n\n\n\n\n\n\n\ngene\nbaseMean\nlog2FoldChange\nlfcSE\nstat\npvalue\npadj\n\n\n\nMGAT3\n1412.43862\n-4.320278\n0.2750470\n-15.707414\n0\n0\n\n\nRTKN2\n5130.81804\n-4.640307\n0.3175103\n-14.614667\n0\n0\n\n\nGPM6A\n1228.70589\n-5.145635\n0.3599700\n-14.294621\n0\n0\n\n\nSERTM1\n298.17214\n-6.886260\n0.5455626\n-12.622309\n0\n0\n\n\nLIMS2\n1926.05684\n-2.660279\n0.2146619\n-12.392878\n0\n0\n\n\nEMP2\n31710.06920\n-2.671839\n0.2229468\n-11.984199\n0\n0\n\n\nCNTN6\n352.36029\n-4.393899\n0.3796112\n-11.574736\n0\n0\n\n\nKANK3\n495.11283\n-2.848364\n0.2522794\n-11.290513\n0\n0\n\n\nRP1-78O14.1\n240.67218\n-4.394661\n0.3899644\n-11.269390\n0\n0\n\n\nGPM6B\n796.26123\n-2.528567\n0.2297754\n-11.004520\n0\n0\n\n\nWNT3A\n280.08606\n-5.270964\n0.4854622\n-10.857621\n0\n0\n\n\nPDLIM2\n1757.53896\n-2.207799\n0.2064731\n-10.692915\n0\n0\n\n\nITLN2\n655.86747\n-5.904468\n0.5588234\n-10.565893\n0\n0\n\n\nSLC6A13\n35.46976\n-3.659195\n0.3472796\n-10.536740\n0\n0\n\n\nGRK5\n2389.94916\n-2.795107\n0.2712779\n-10.303480\n0\n0\n\n\nEDNRB\n3236.38793\n-3.288481\n0.3211332\n-10.240242\n0\n0\n\n\nKCNN4\n1240.55071\n3.836884\n0.3783283\n10.141679\n0\n0\n\n\nCLIC5\n8327.11939\n-3.732657\n0.3685299\n-10.128505\n0\n0\n\n\nRASAL1\n261.44562\n4.538838\n0.4504928\n10.075272\n0\n0\n\n\nRP11-371A19.2\n54.44687\n-5.168047\n0.5162906\n-10.009957\n0\n0\n\n\nPTPN21\n2327.21817\n-2.527771\n0.2538084\n-9.959365\n0\n0\n\n\nCLEC3B\n2091.74017\n-4.223742\n0.4294719\n-9.834733\n0\n0\n\n\nCTD-2135D7.5\n38.21341\n-3.366170\n0.3434858\n-9.800029\n0\n0\n\n\nFAM83A\n2565.85011\n6.377845\n0.6514036\n9.790927\n0\n0\n\n\nPTPRH\n490.58361\n6.130422\n0.6281505\n9.759480\n0\n0\n\n\n\n\n\n\n\n7.6.2 热图\n\nCode\nlog2exprCounts &lt;- log2(counts(des)+1)\nlibrary(pheatmap)\n\npheatmap(log2exprCounts[(head(DESeq2_DEG$gene,n=25)) , ])\n\n\n\n\n\n\n\n\n7.6.3 配对图\n挑选指定第一个基因看它在同一个病人的配对表达情况\n\nCodelibrary(ggpubr)\n\ndf &lt;- tibble(\n  group = sample$condition,\n  patient = colnames(exprCounts),\n  expressionValue = as.numeric(exprCounts[DESeq2_DEG$gene[1],]),\n  )\n\nggpubr::ggpaired(df, x = \"group\", y = \"expressionValue\",color = \"group\", \n                 line.color = \"gray\", line.size = 0.4,palette = \"npg\")+\n    stat_compare_means()\n\n\n\n\n\n\n\n\n7.6.4 火山图\n\nCodenrDEG$group &lt;- factor(\n    if_else(nrDEG$padj&lt;0.05& abs(nrDEG$log2FoldChange)&gt;=1,\n            if_else(nrDEG$log2FoldChange&gt;=1,\"up\",\"down\"),\n            \"NS\",),\n    levels =c(\"up\",\"down\",\"NS\") )\ntable(nrDEG$group)\n#&gt; \n#&gt;    up  down    NS \n#&gt;  2073  1641 15358\n\ngene_labels &lt;- dplyr::filter(nrDEG,nrDEG$padj&lt;0.05 & \n                                 abs(nrDEG$log2FoldChange)&gt;=1)|&gt; \n    slice_head(n=25) \n\n\nggplot(nrDEG,aes( x = log2FoldChange,y = -log10(padj),color=group,shape=group))+\n    geom_point(alpha=0.5,size=1.5)+\n    scale_color_manual(values = c(\"red\",\"green\",\"gray\"))+\n    #scale_shape_manual(values = c(2,25,4))+\n    geom_vline(xintercept = c(-1,0,1),lty=3,color=\"grey25\",lwd=0.8)+\n    geom_hline(yintercept = -log10(0.05),lty=3,color=\"grey25\",lwd=0.8)+\n    ggrepel::geom_text_repel(\n        data = gene_labels,\n        aes(label=gene),\n        color=\"black\",\n        size=2)+\n    theme_pubr()\n\n\n\n\n\n\n\n\n7.6.5 EnhancedVolcano\n\n\nCodeif(!require(EnhancedVolcano))\n  BiocManager::install('EnhancedVolcano')\n\n\n\n7.6.6 LFC收缩和pagj\n\nCoderesultsNames(des)\n#&gt; [1] \"Intercept\"                 \"condition_tumor_vs_normal\"\n# BiocManager::install(\"apeglm\")  自适应 t 先验收缩估计器  默认\n# resLFC &lt;- lfcShrink(des, coef=\"condition_tumor_vs_normal\", type=\"apeglm\")\n\n# `normal`是原始的 DESeq2 收缩估计器，是先验的自适应正态分布\nresNorm &lt;- lfcShrink(des, coef=2, type=\"normal\")\n\n# BiocManager::install(\"ashr\")\n# resAsh &lt;- lfcShrink(des, coef=2, type=\"ashr\")\n\n\n## 先验信息\n\n# priorInfo(resLFC)\npriorInfo(resNorm)\n#&gt; $type\n#&gt; [1] \"normal\"\n#&gt; \n#&gt; $package\n#&gt; [1] \"DESeq2\"\n#&gt; \n#&gt; $version\n#&gt; [1] '1.44.0'\n#&gt; \n#&gt; $betaPriorVar\n#&gt;      Intercept conditiontumor \n#&gt;   1.000000e+06   1.658755e+00\n# priorInfo(resAsh)\n\n\n\n7.6.7 MA图 Mean-AbsDeviation plot\n\nCode# 对gene添加“是否呈现显著差异表达”的标签\nDESeq2_DEG$significant &lt;- factor(ifelse(DESeq2_DEG$padj &lt;0.05, \"Significant\", \"NS\"),\nlevels = c(\"Significant\", \"NS\"))\n\ntable(DESeq2_DEG$significant)\n#&gt; \n#&gt; Significant          NS \n#&gt;        5408       13664\n# 以baseMean作为x，log2FoldChange作为y   以significant作为分类变量\nggplot(DESeq2_DEG, aes(baseMean, log2FoldChange, colour=significant)) + \n geom_point(size=1) + \n scale_y_continuous(limits=c(-3, 3)) + \n scale_x_log10() + \n geom_hline(yintercept = 0, colour=\"black\", linewidth=1) + \n labs(x=\"mean of normalized counts\", y=\"log2FoldChange\") + \n scale_colour_manual(name=\"padj\", \n                     values=c(\"Significant\"=\"blue\",\"NS\"=\"grey50\")) +\n theme_classic()\n\n\n\n\n\n\n\n\nCodexlim &lt;- c(1,10e6)\nylim &lt;- c(-3,3)\nplotMA(resOrdered,  xlim=xlim, ylim=ylim,main=\"none\")\n\n\n\n\n\n\nCode# plotMA(resLFC, xlim=xlim, ylim=ylim, main=\"apeglm\")\nplotMA(resNorm, xlim=xlim, ylim=ylim, main=\"normal\")\n\n\n\n\n\n\nCode# plotMA(resAsh, xlim=xlim, ylim=ylim, main=\"ashr\")\n\n\n\n7.6.8 读取计数\n\nCode#  the counts of reads for a single gene across the groups\nplotCounts(des, gene=which.min(resOrdered$padj), \n  intgroup=\"condition\",returnData=TRUE) |&gt; \n ggplot(aes(x=condition, y=count)) + \n geom_point(position=position_jitter(w=0.1,h=0))\n\n\n\n\n\n\n\n\n7.6.9 异常观测\n\nCodeW &lt;- resOrdered$stat\nmaxCooks &lt;- apply(assays(des)[[\"cooks\"]],1,max)\nidx &lt;- !is.na(W)\nplot(rank(W[idx]), maxCooks[idx], xlab=\"rank of Wald statistic\", \n  ylab=\"maximum Cook's distance per gene\",\n  ylim=c(0,5), cex=.4, col=rgb(0,0,0,.3))\nm &lt;- ncol(des)\np &lt;- 3\nabline(h=qf(.99, p, m - p))\n\n\n\n\n\n\n\n\n7.6.10 多因素设计\n\nCodecolData(dds)\n#&gt; DataFrame with 16 rows and 3 columns\n#&gt;                  radiation_therapy kras_mutation_found condition\n#&gt;                        &lt;character&gt;         &lt;character&gt;  &lt;factor&gt;\n#&gt; TCGA-44-6145-01A                NO                  NO    tumor \n#&gt; TCGA-44-6145-11A                NO                  NO    normal\n#&gt; TCGA-44-6148-01A                NO                  NO    tumor \n#&gt; TCGA-44-6148-11A                NO                  NO    normal\n#&gt; TCGA-49-6742-01A                NO                  NO    tumor \n#&gt; ...                            ...                 ...       ...\n#&gt; TCGA-50-5066-02A                NO                  NO    tumor \n#&gt; TCGA-50-5935-01A               YES                 YES    tumor \n#&gt; TCGA-50-5935-11A               YES                 YES    normal\n#&gt; TCGA-50-5936-01A                NO                 YES    tumor \n#&gt; TCGA-50-5936-11A                NO                 YES    normal",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>差异表达基因分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html",
    "href": "EnrichmentAnalysis.html",
    "title": "\n8  富集分析\n",
    "section": "",
    "text": "8.1 基因集富集分析 GSEA\n基因集表示基因集中基因的一般共享生物属性的先验知识。",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#基因集富集分析-gsea",
    "href": "EnrichmentAnalysis.html#基因集富集分析-gsea",
    "title": "\n8  富集分析\n",
    "section": "",
    "text": "8.1.1 over-representation analysis (ORA)\n基因本体论 （Gene Ontology，GO） 基因集\n京都基因与基因组百科全书 （Kyoto Encyclopedia of Genes and Genomes，KEGG）基因集\n\nCode# BiocManager::install('clusterProfiler')\n# BiocManager::install(\"org.Hs.eg.db\")\n\nDEG &lt;- read_csv(\"data/DEGs_Analysis/resOrdered.csv\")\nx &lt;-  na.omit(DEG) \n\n\n对于有参考基因组物种的分析，可以在相关软件包中直接加载该物种的背景基因集。对于常见的模式物种，例如BiocManager::install(\"org.Hs.eg.db\") ，安装人类hg19的注释包 BiocManager::install(\"org.Mm.eg.db\") ，安装小鼠的注释包",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#基因注释",
    "href": "EnrichmentAnalysis.html#基因注释",
    "title": "\n8  富集分析\n",
    "section": "\n8.2 基因注释",
    "text": "8.2 基因注释\n\nCodedeg_df &lt;- x[,c(1,3,7)]\nhead(deg_df)\n\n\n\n\ngene\nlog2FoldChange\npadj\n\n\n\nMGAT3\n-4.320278\n0\n\n\nRTKN2\n-4.640307\n0\n\n\nGPM6A\n-5.145635\n0\n\n\nSERTM1\n-6.886260\n0\n\n\nLIMS2\n-2.660279\n0\n\n\nEMP2\n-2.671839\n0\n\n\n\n\n\nCode\ndeg_df$expression &lt;- factor( \n    ifelse( deg_df$padj&lt; 0.05 & abs(deg_df$log2FoldChange) &gt;= 1,\n            if_else( deg_df$log2FoldChange &gt;= 1 , 'up', 'down' ),\n            'NS'),\n    levels = c(\"up\",\"down\",\"NS\"))\ntable(deg_df$expression)\n#&gt; \n#&gt;    up  down    NS \n#&gt;  2073  1641 15358\n\ngtf_v22_transcripts &lt;- read_delim(\"data/DEGs_Analysis/gencode.v22.annotation.gene.probeMap\")\n\n\n# 之前差异分析可以保留ENSEMBL标识符  \ndeg_df &lt;- deg_df |&gt; \n inner_join(gtf_v22_transcripts, by = c( \"gene\"= \"gene\"))\n\n# 移除ENSEMBL版本号\ndeg_df$ENSEMBL &lt;- str_sub(deg_df$id, start = 1, end = 15)\n\n\nR 语言中 AnnotationDbi 包提供的一个函数名bitr() 代表 “Biological Identifier Translation”，即生物学标识符转换。这个函数用于在不同的基因标识符之间进行转换，例如从基因的 Ensembl ID 转换为 Entrez ID（特定基因产物）)、基因符号（symbol）或基因名称（gene name）。\nEntrez是National Center for Biotechnology Information (NCBI) 提供的一个综合性生物信息数据库查询系统。它允许用户搜索和检索包括基因、蛋白质、核酸序列、3D蛋白质结构、基因表达数据、基因组数据、遗传多态性、生物项目、生物文献等各种生物医学信息。Entrez Gene数据库中的基因ID是唯一的数字标识符，用于在NCBI的Entrez系统内标识特定的基因。\nclusterProfiler\n\nCodelibrary(clusterProfiler)\nconflicts_prefer(GenomicRanges::setdiff)\nlibrary(org.Hs.eg.db)\nAnnotationDbi::keytypes(org.Hs.eg.db)\n#&gt;  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n#&gt;  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n#&gt; [11] \"GENETYPE\"     \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"         \n#&gt; [16] \"OMIM\"         \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"        \n#&gt; [21] \"PMID\"         \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"      \n#&gt; [26] \"UNIPROT\"\nhead(keys(org.Hs.eg.db, \"ENSEMBL\"))\n#&gt; [1] \"ENSG00000121410\" \"ENSG00000175899\" \"ENSG00000291190\" \"ENSG00000171428\"\n#&gt; [5] \"ENSG00000156006\" \"ENSG00000196136\"\nhead(keys(org.Hs.eg.db, \"ENTREZID\"))\n#&gt; [1] \"1\"  \"2\"  \"3\"  \"9\"  \"10\" \"11\"\nhead(keys(org.Hs.eg.db, \"SYMBOL\")) #基因名称缩写\n#&gt; [1] \"A1BG\"  \"A2M\"   \"A2MP1\" \"NAT1\"  \"NAT2\"  \"NATP\"\nhead(keys(org.Hs.eg.db, \"GENENAME\")) # 基因名称全称\n#&gt; [1] \"alpha-1-B glycoprotein\"             \"alpha-2-macroglobulin\"             \n#&gt; [3] \"alpha-2-macroglobulin pseudogene 1\" \"N-acetyltransferase 1\"             \n#&gt; [5] \"N-acetyltransferase 2\"              \"N-acetyltransferase pseudogene\"\n\nvalid_ensembl &lt;- deg_df$ENSEMBL %in% keys(org.Hs.eg.db, \"ENSEMBL\")  \ntable(valid_ensembl)\n#&gt; valid_ensembl\n#&gt; FALSE  TRUE \n#&gt;  2269 16888\n\nvalid_symbol &lt;- deg_df$gene %in% keys(org.Hs.eg.db, \"SYMBOL\")  \ntable(valid_symbol)\n#&gt; valid_symbol\n#&gt; FALSE  TRUE \n#&gt;  3249 15908\n\n\ndeg_df_filtered &lt;- deg_df[valid_ensembl, ]  \n\n# Biological Identifier Translation\ndf &lt;- bitr(\n geneID= deg_df_filtered$ENSEMBL,\n fromType = \"ENSEMBL\", \n toType = c( \"ENTREZID\",\"SYMBOL\",\"GENENAME\" ), \n OrgDb = org.Hs.eg.db )\n\nhead(df)\n\n\n\n\n\n\n\n\n\n\nENSEMBL\nENTREZID\nSYMBOL\nGENENAME\n\n\n\nENSG00000128268\n4248\nMGAT3\nbeta-1,4-mannosyl-glycoprotein 4-beta-N-acetylglucosaminyltransferase\n\n\nENSG00000182010\n219790\nRTKN2\nrhotekin 2\n\n\nENSG00000150625\n2823\nGPM6A\nglycoprotein M6A\n\n\nENSG00000180440\n400120\nSERTM1\nserine rich and transmembrane domain containing 1\n\n\nENSG00000072163\n55679\nLIMS2\nLIM zinc finger domain containing 2\n\n\nENSG00000213853\n2013\nEMP2\nepithelial membrane protein 2\n\n\n\n\n\nCode\ndeg_df &lt;- inner_join(deg_df_filtered, df, by='ENSEMBL' )\n\n\n进行上调和下调基因的分离是为了更精确地识别与特定生物学过程或疾病状态相关的途径。例如，某些途径可能在疾病发生时被激活，导致相关基因上调，而其他途径可能被抑制，导致相关基因下调。\n\nCodegene_up &lt;- deg_df[ deg_df$expression == 'up', \"ENTREZID\" ] \ngene_down &lt;- deg_df[ deg_df$expression == 'down', \"ENTREZID\"]\n\n\ngene_all &lt;- deg_df[ ,\"ENTREZID\"]\n\nlibrary(biomaRt)\n\n# 使用biomaRt映射基因ID\ngene_info &lt;- getBM(attributes = c(\"hgnc_symbol\", \"entrezgene_id\"), \n                     filters = \"entrezgene_id\", \n                     values = gene_up$ENTREZID, \n                     mart = useMart(\"ensembl\", dataset = \"hsapiens_gene_ensembl\"))",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#kegg-通路富集",
    "href": "EnrichmentAnalysis.html#kegg-通路富集",
    "title": "\n8  富集分析\n",
    "section": "\n8.3 KEGG 通路富集",
    "text": "8.3 KEGG 通路富集\n\nCodekegg_up &lt;- clusterProfiler::enrichKEGG(gene = gene_up$ENTREZID ,# entrez gene id\n                    organism=  'hsa',\n                    keyType = \"kegg\",\n                    pvalueCutoff  =  0.05,\n                    pAdjustMethod = \"BH\",  # FDR多重假设检验校正 qvalue\n                    universe=  gene_all$ENTREZID,\n                    minGSSize = 10,\n                    maxGSSize = 500,\n                    qvalueCutoff  =  0.05 )\nkegg_down &lt;- clusterProfiler::enrichKEGG(gene = gene_down$ENTREZID ,\n                    organism=  'hsa',\n                    keyType = \"kegg\",\n                    pvalueCutoff  =  0.05,\n                    pAdjustMethod = \"BH\", \n                    universe=  gene_all$ENTREZID,\n                    qvalueCutoff  =  0.05 )\n\n\n\nCodedf_up&lt;- as.data.frame(kegg_up)\ndf_down&lt;- as.data.frame(kegg_down)\ndf_up\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncategory\nsubcategory\nID\nDescription\nGeneRatio\nBgRatio\npvalue\np.adjust\nqvalue\ngeneID\nCount\n\n\n\nhsa04110\nCellular Processes\nCell growth and death\nhsa04110\nCell cycle\n56/763\n154/6926\n0.0000000\n0.0000000\n0.0000000\n5347/898/990/701/113130/991/151648/9232/9212/9133/891/995/9088/23594/7272/890/4998/9700/57082/1111/10403/157570/8318/4171/1029/80174/699/4173/90381/4175/4085/81620/1870/983/9134/11200/27085/993/3065/4176/1871/5111/5001/10926/9319/5933/7157/26271/10459/1875/5591/1019/1869/8317/1663/4193\n56\n\n\nhsa01230\nMetabolism\nGlobal and overview maps\nhsa01230\nBiosynthesis of amino acids\n19/763\n64/6926\n0.0000356\n0.0045716\n0.0042807\n5831/84706/5832/6472/29968/2597/5214/2023/3418/5091/1373/10993/7167/6888/226/3417/440/4143/384\n19\n\n\nhsa01232\nMetabolism\nGlobal and overview maps\nhsa01232\nNucleotide metabolism\n22/763\n81/6926\n0.0000409\n0.0045716\n0.0042807\n205/6241/978/7083/377841/7298/4830/7498/100/4907/124583/4833/122622/4831/272/3251/56953/1841/9615/7371/5167/954\n22\n\n\nhsa05206\nHuman Diseases\nCancer: overview\nhsa05206\nMicroRNAs in cancer\n34/763\n155/6926\n0.0000549\n0.0046001\n0.0043074\n898/113130/1591/995/1945/2146/5268/1944/1029/9493/8091/1870/5328/9134/7473/1789/1946/672/4318/993/6659/3065/1871/6464/7157/90427/6768/3845/3925/1869/54541/4193/6624/2065\n34\n\n\nhsa00330\nMetabolism\nAmino acid metabolism\nhsa00330\nArginine and proline metabolism\n14/763\n45/6926\n0.0002183\n0.0123365\n0.0115516\n5831/79814/1159/548596/5832/26/283208/6723/54498/6611/2628/219/384/2593\n14\n\n\nhsa03030\nGenetic Information Processing\nReplication and repair\nhsa03030\nDNA replication\n12/763\n35/6926\n0.0002210\n0.0123365\n0.0115516\n1763/4171/4173/2237/5427/4175/5984/5558/10535/4176/5111/6119\n12\n\n\nhsa00480\nMetabolism\nMetabolism of other amino acids\nhsa00480\nGlutathione metabolism\n15/763\n51/6926\n0.0002628\n0.0125753\n0.0117751\n2877/6241/2729/2936/79017/3418/6723/2730/6611/2539/3417/4257/493869/5226/494143\n15\n\n\nhsa01200\nMetabolism\nGlobal and overview maps\nhsa01200\nCarbon metabolism\n23/763\n101/6926\n0.0004909\n0.0193605\n0.0181286\n84706/6472/29968/2597/5214/2023/2731/3418/5091/1373/10993/2821/7167/6888/2539/80201/226/3417/55753/2653/4199/5226/6389\n23\n\n\nhsa00240\nMetabolism\nNucleotide metabolism\nhsa00240\nPyrimidine metabolism\n15/763\n54/6926\n0.0005201\n0.0193605\n0.0181286\n6241/978/7083/377841/7298/4830/4907/124583/4833/4831/790/56953/1841/7371/5167\n15\n\n\nhsa03460\nGenetic Information Processing\nReplication and repair\nhsa03460\nFanconi anemia pathway\n14/763\n50/6926\n0.0007264\n0.0223526\n0.0209303\n29089/83990/116028/55215/641/146956/5888/2189/2177/2175/2187/91442/672/6119\n14\n\n\nhsa05203\nHuman Diseases\nCancer: overview\nhsa05203\nViral carcinogenesis\n33/763\n171/6926\n0.0008538\n0.0223526\n0.0209303\n2648/898/991/890/3017/1111/1029/3718/983/1237/9134/7188/440689/3665/2961/3065/5366/7185/8339/5933/7157/1232/148327/8294/85236/5902/3845/7186/1019/8365/4193/8347/7419\n33\n\n\nhsa04115\nCellular Processes\nCell growth and death\nhsa04115\np53 signaling pathway\n18/763\n74/6926\n0.0008674\n0.0223526\n0.0209303\n898/9133/891/51512/6241/5268/1111/1029/983/9134/11200/64065/5366/84883/7157/1019/3486/4193\n18\n\n\nhsa04974\nOrganismal Systems\nDigestive system\nhsa04974\nProtein digestion and absorption\n18/763\n74/6926\n0.0008674\n0.0223526\n0.0209303\n3783/1301/1300/6564/1281/1294/1308/1290/169044/1289/1277/255631/5646/478/1278/1293/1298/1299\n18\n\n\nhsa01240\nMetabolism\nGlobal and overview maps\nhsa01240\nBiosynthesis of cofactors\n27/763\n135/6926\n0.0014208\n0.0339975\n0.0318343\n205/6999/1728/6472/29968/4830/7358/80308/2729/29926/10797/53630/4833/23475/2730/122622/4831/3145/790/23057/1719/219/8942/8836/4143/54578/93100\n27\n\n\n\n\n\nCodedf_down\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncategory\nsubcategory\nID\nDescription\nGeneRatio\nBgRatio\npvalue\np.adjust\nqvalue\ngeneID\nCount\n\n\n\nhsa04080\nEnvironmental Information Processing\nSignaling molecules and interaction\nhsa04080\nNeuroactive ligand-receptor interaction\n44/635\n181/6926\n0.0000000\n0.0000003\n0.0000002\n1910/154/7433/10316/1901/10203/1129/2890/148/2900/2358/5028/2922/59350/1268/554/8698/5745/1906/22953/122042/6751/53637/9002/117/185/5734/153/728/146/3953/2894/1908/1132/1128/2357/5179/3355/187/2690/2740/796/8862/147\n44\n\n\nhsa04270\nOrganismal Systems\nCirculatory system\nhsa04270\nVascular smooth muscle contraction\n31/635\n116/6926\n0.0000000\n0.0000042\n0.0000036\n10266/10268/255189/10398/2977/10203/196883/50487/148/5581/779/5319/5592/4629/54776/91807/5583/1906/72/4881/108/10242/5588/114/185/146/115/1908/4628/796/147\n31\n\n\nhsa04820\nNA\nNA\nhsa04820\nCytoskeleton in muscle cells\n43/635\n201/6926\n0.0000001\n0.0000081\n0.0000070\n64236/27063/7134/6445/10398/1288/2273/23500/477/171024/88/4629/4620/1285/6442/25802/161176/72/1286/6711/10529/84467/7431/1674/2192/9172/6383/91977/25777/2006/131873/825/7273/8516/58529/56203/8736/4628/7111/29767/7140/4634/23345\n43\n\n\nhsa04610\nOrganismal Systems\nImmune system\nhsa04610\nComplement and coagulation cascades\n21/635\n71/6926\n0.0000008\n0.0000611\n0.0000528\n5648/7056/7450/11326/732/9002/1361/2157/1604/2159/2160/728/5627/3687/10747/722/717/712/2/1675/713\n21\n\n\nhsa05144\nHuman Diseases\nInfectious disease: parasitic\nhsa05144\nMalaria\n16/635\n46/6926\n0.0000015\n0.0000934\n0.0000808\n5175/2995/6403/1440/948/3569/2532/3043/7042/3040/6383/7099/3039/3082/3683/3553\n16\n\n\nhsa04024\nEnvironmental Information Processing\nSignal transduction\nhsa04024\ncAMP signaling pathway\n36/635\n176/6926\n0.0000028\n0.0001455\n0.0001257\n154/10398/196883/1129/2890/477/779/338442/11069/64399/627/1906/5140/4881/108/6751/114/10411/8843/117/2353/153/115/51196/1262/64411/1908/6262/5348/4772/1128/3725/3355/5295/5350/2740\n36\n\n\nhsa04924\nOrganismal Systems\nEndocrine system\nhsa04924\nRenin secretion\n17/635\n60/6926\n0.0000166\n0.0007425\n0.0006417\n154/2977/358/779/5153/1636/5972/1906/5140/4881/117/185/5593/5734/153/1908/5137\n17\n\n\nhsa04015\nEnvironmental Information Processing\nSignal transduction\nhsa04015\nRap1 signaling pathway\n34/635\n185/6926\n0.0000562\n0.0021692\n0.0018748\n7010/51378/196883/2255/2277/9732/5028/11069/10235/8817/1268/5587/5155/260425/2247/108/114/10411/9002/2324/5590/3791/9771/115/9863/51196/64411/284/9223/3082/3683/2357/5295/2264\n34\n\n\nhsa04022\nEnvironmental Information Processing\nSignal transduction\nhsa04022\ncGMP-PKG signaling pathway\n28/635\n141/6926\n0.0000624\n0.0021692\n0.0018748\n1910/154/10398/2977/196883/148/5581/477/779/5592/91807/5140/4881/5138/108/10242/114/185/5593/153/8654/146/115/3764/23533/4772/5350/147\n28\n\n\nhsa04020\nEnvironmental Information Processing\nSignal transduction\nhsa04020\nCalcium signaling pathway\n36/635\n203/6926\n0.0000745\n0.0023306\n0.0020143\n1910/7134/154/845/196883/1129/2255/2277/148/779/5153/8817/91807/22953/5155/2247/108/114/2324/185/153/3791/146/115/51196/6262/3082/4772/1128/2264/4915/5350/5137/2066/4843/147\n36\n\n\nhsa04380\nOrganismal Systems\nDevelopment and regeneration\nhsa04380\nOsteoclast differentiation\n26/635\n131/6926\n0.0001144\n0.0032557\n0.0028139\n7048/126014/10326/9846/54/6688/4286/3552/7042/4688/2353/11025/102725035/107987425/107987462/11027/2354/695/4772/3553/3725/3727/5295/3726/5468/79168\n26\n\n\nhsa04923\nOrganismal Systems\nEndocrine system\nhsa04923\nRegulation of lipolysis in adipocytes\n13/635\n46/6926\n0.0001684\n0.0043932\n0.0037970\n2167/154/196883/5592/5140/4881/108/114/5593/153/115/11343/5295\n13\n\n\nhsa04970\nOrganismal Systems\nDigestive system\nhsa04970\nSalivary secretion\n16/635\n69/6926\n0.0003885\n0.0093543\n0.0080849\n154/2977/196883/148/477/5592/108/114/683/5593/153/820/146/115/1473/147\n16\n\n\nhsa04261\nOrganismal Systems\nCirculatory system\nhsa04261\nAdrenergic signaling in cardiomyocytes\n25/635\n135/6926\n0.0004720\n0.0100425\n0.0086797\n7134/154/196883/148/477/779/9254/11069/6330/108/114/10411/185/153/146/115/23533/6262/3753/785/6332/5350/4634/55799/147\n25\n\n\nhsa05414\nHuman Diseases\nCardiovascular disease\nhsa05414\nDilated cardiomyopathy\n19/635\n91/6926\n0.0004813\n0.0100425\n0.0086797\n7134/6445/196883/779/9254/6442/108/7042/1674/114/153/115/7273/8516/6262/785/5350/4634/55799\n19\n\n\nhsa04933\nHuman Diseases\nEndocrine and metabolic disease\nhsa04933\nAGE-RAGE signaling pathway in diabetic complications\n20/635\n99/6926\n0.0005420\n0.0106032\n0.0091643\n177/7048/1288/2277/5581/7056/3569/1285/1906/1286/3552/7042/5590/185/1958/51196/4772/3553/3725/5295\n20\n\n\nhsa04740\nOrganismal Systems\nSensory system\nhsa04740\nOlfactory transduction\n10/635\n35/6926\n0.0008629\n0.0150651\n0.0130208\n408/123041/57101/5153/5592/5138/83988/5593/1262/5137\n10\n\n\nhsa04060\nEnvironmental Information Processing\nSignaling molecules and interaction\nhsa04060\nCytokine-cytokine receptor interaction\n35/635\n221/6926\n0.0008664\n0.0150651\n0.0130208\n7048/53342/94/6369/1440/55504/3563/3590/3569/2920/51554/6368/3977/6358/653/3552/7042/659/90865/2921/5473/3953/8741/654/9173/1271/3553/650/2662/85480/3575/2690/53832/3577/3579\n35\n\n\nhsa04514\nEnvironmental Information Processing\nSignaling molecules and interaction\nhsa04514\nCell adhesion molecules\n25/635\n143/6926\n0.0011339\n0.0186796\n0.0161448\n23705/5175/1003/58494/6403/51208/64115/7122/6693/947/90952/5797/94030/3133/23114/83700/6383/6404/84631/8516/3683/22865/3384/4099/257194\n25\n\n\nhsa04926\nOrganismal Systems\nEndocrine system\nhsa04926\nRelaxin signaling pathway\n21/635\n116/6926\n0.0017605\n0.0275521\n0.0238133\n1910/7048/408/53358/196883/1288/2277/59350/1285/1906/1286/122042/108/114/5590/2353/115/3725/5295/2791/4843\n21\n\n\nhsa03320\nOrganismal Systems\nEndocrine system\nhsa03320\nPPAR signaling pathway\n13/635\n60/6926\n0.0025795\n0.0384467\n0.0332295\n2167/33/948/4973/4023/10580/6258/1593/2180/2171/79966/5468/28965\n13\n\n\nhsa04927\nOrganismal Systems\nEndocrine system\nhsa04927\nCortisol synthesis and secretion\n12/635\n54/6926\n0.0029828\n0.0409681\n0.0354088\n196883/779/3949/3739/108/114/185/1586/115/3777/8622/3164\n12\n\n\nhsa05150\nHuman Diseases\nInfectious disease: bacterial\nhsa05150\nStaphylococcus aureus infection\n13/635\n61/6926\n0.0030104\n0.0409681\n0.0354088\n5648/6403/2358/6404/820/728/3683/10747/2357/717/712/1675/713\n13\n\n\n\n\n\n\n对于各列内容：\nID和Description，富集到的通路和功能描述；\nGeneRatio和BgRatio，分别为富集到该通路中的基因数目/给定基因的总数目，以及该通路中背景基因总数目/该物种所有已知的KEGG功能基因数目；\npvalue、p.adjust和qvalue，p值、校正后p值和q值信息；\n\n\np值（P-value）：\n\np值是在一个假设检验中，当零假设（null hypothesis）为真时，观察到的统计量或更极端情况出现的概率。\n一个低的p值（如小于0.05）通常表明统计学上的显著性，意味着结果不太可能仅仅是由随机因素引起的。\n不太关心假阳性，而是更关注于发现尽可能多的显著性通路，原始的p值可能足够\n\n\n\n校正后的p值（Adjusted P-value） - Benjamini-Hochberg (BH)方法：\n\n在进行多重检验时，为了控制第一类错误（错误地拒绝零假设）的总体率，需要对p值进行校正。BH方法是一种流行的校正方法，它通过控制假发现率（false discovery rate, FDR）来进行校正。\nBH校正后的p值（padj）是基于原始p值按照一定规则调整后的值，用于评估在多重比较情况下的统计显著性。\n平衡假阳性和假阴性的发现，可以使用BH方法的p.adjust值\n\n\n\nq值（Q-value）：\n\nq值同样是用于评估多重检验中的统计显著性，它直接控制了假发现率。\nq值定义为在最坏的情况下，所接受的假设中错误发现的比例。例如，q=0.05意味着在所有被认为是显著的发现中，最多有5%实际上是假阳性。\n更保守地挑选显著性通路，以减少假阳性的可能性，可能会选择使用q值\nR中使用”BY”表示q值校正\n\n\n\ngeneID和Count，富集到该通路中的基因名称和数目。\n\nCodedf_up &lt;- df_up[df_up$pvalue &lt; 0.05, ]\ndf_down &lt;- df_down[df_down$pvalue &lt; 0.05, ]\nlubridate::intersect(df_up$ID,df_down$ID)\n#&gt; character(0)\n\n\n\nCodedf_up$group &lt;- 1\ndf_down$group &lt;- -1\n\n\n\nCodeup_down &lt;- rbind(df_up,df_down)\nhead(up_down)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ncategory\nsubcategory\nID\nDescription\nGeneRatio\nBgRatio\npvalue\np.adjust\nqvalue\ngeneID\nCount\ngroup\n\n\n\nhsa04110\nCellular Processes\nCell growth and death\nhsa04110\nCell cycle\n56/763\n154/6926\n0.0000000\n0.0000000\n0.0000000\n5347/898/990/701/113130/991/151648/9232/9212/9133/891/995/9088/23594/7272/890/4998/9700/57082/1111/10403/157570/8318/4171/1029/80174/699/4173/90381/4175/4085/81620/1870/983/9134/11200/27085/993/3065/4176/1871/5111/5001/10926/9319/5933/7157/26271/10459/1875/5591/1019/1869/8317/1663/4193\n56\n1\n\n\nhsa01230\nMetabolism\nGlobal and overview maps\nhsa01230\nBiosynthesis of amino acids\n19/763\n64/6926\n0.0000356\n0.0045716\n0.0042807\n5831/84706/5832/6472/29968/2597/5214/2023/3418/5091/1373/10993/7167/6888/226/3417/440/4143/384\n19\n1\n\n\nhsa01232\nMetabolism\nGlobal and overview maps\nhsa01232\nNucleotide metabolism\n22/763\n81/6926\n0.0000409\n0.0045716\n0.0042807\n205/6241/978/7083/377841/7298/4830/7498/100/4907/124583/4833/122622/4831/272/3251/56953/1841/9615/7371/5167/954\n22\n1\n\n\nhsa05206\nHuman Diseases\nCancer: overview\nhsa05206\nMicroRNAs in cancer\n34/763\n155/6926\n0.0000549\n0.0046001\n0.0043074\n898/113130/1591/995/1945/2146/5268/1944/1029/9493/8091/1870/5328/9134/7473/1789/1946/672/4318/993/6659/3065/1871/6464/7157/90427/6768/3845/3925/1869/54541/4193/6624/2065\n34\n1\n\n\nhsa00330\nMetabolism\nAmino acid metabolism\nhsa00330\nArginine and proline metabolism\n14/763\n45/6926\n0.0002183\n0.0123365\n0.0115516\n5831/79814/1159/548596/5832/26/283208/6723/54498/6611/2628/219/384/2593\n14\n1\n\n\nhsa03030\nGenetic Information Processing\nReplication and repair\nhsa03030\nDNA replication\n12/763\n35/6926\n0.0002210\n0.0123365\n0.0115516\n1763/4171/4173/2237/5427/4175/5984/5558/10535/4176/5111/6119\n12\n1\n\n\n\n\n\n\n\n8.3.1 水平条图\n\nCodebarplot(kegg_up, showCategory=20, xlab=\"-log10(pvalue)\", ylab=\"Pathways\") +\n  theme_minimal()\n\n\n\n\n\n\nCodedotplot(kegg_up)\n\n\n\n\n\n\n\n\nCodeup_down$Negative_log10pvalue &lt;- -log10(up_down$pvalue)\n\nup_down$Grouped_Negativelog10pvalue &lt;- up_down$Negative_log10pvalue * up_down$group\n\nup_down &lt;- up_down[order( up_down$Grouped_Negativelog10pvalue), ]\n\nggplot(up_down, aes(\n  x =  reorder(Description, order(Grouped_Negativelog10pvalue, decreasing = F)),\n  y = Grouped_Negativelog10pvalue,\n  fill = group\n)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip()+\n  scale_fill_gradient(low = \"blue\", high = \"red\") +\n  scale_x_discrete(name = \"Pathway names\") +\n  scale_y_continuous(name = \"-log10 pvalue\")+\n  theme(plot.title = element_text(hjust = 0.5) ) +\n  ggtitle(\"KEGG Pathway Enrichment\") \n\n\n\n\n\n\n\n\n8.3.2 点图\n\nCode# GeneRatio 转化成数值型\nGR &lt;- up_down$GeneRatio |&gt; \n    str_split(pattern = \"/\",simplify = TRUE) |&gt; as_tibble(.name_repair=\"unique\")\n\nup_down$GeneRatio &lt;- parse_number(GR$...1)/parse_number(GR$...2)\n\nup_down &lt;- up_down[order(up_down$GeneRatio),]\n\nggplot(data = up_down,aes(x=GeneRatio,\n                      y=reorder(Description,order(GeneRatio)),\n                      color = Grouped_Negativelog10pvalue,\n                      size=Count\n                      )\n       )+\n    geom_point()+\n    scale_x_continuous( name = \"GeneRatio\" ,breaks = seq(0,1.0,0.1))+\n    scale_color_gradient(low = \"blue\", high = \"red\" )+\n    scale_y_discrete( name = \"Pathway names\" ) +\n    theme( plot.title = element_text( hjust = 0.5 )) +\n    ggtitle( \"KEGG Pathway Enrichment \" )+\n    labs(color=\"-log10 pvalue\")",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "EnrichmentAnalysis.html#go富集分析",
    "href": "EnrichmentAnalysis.html#go富集分析",
    "title": "\n8  富集分析\n",
    "section": "\n8.4 GO富集分析",
    "text": "8.4 GO富集分析\nGene Ontology 基因集\n\n\nPackage\nOrganism\n\n\n\norg.Hs.eg.db\nHuman\n\n\norg.Mm.eg.db\nMouse\n\n\n\n对于输出的GO富集结果表格中的各列内容：\nONTOLOGY，GO的BP（生物学过程）、CC（细胞组分）或MF（分子功能）；\nID和Description，富集到的GO term及其描述；\nGeneRatio和BgRatio，分别为富集到该GO term中的基因数目/给定基因的总数目，以及该GO term中背景基因总数目/该物种所有已知GO功能基因数目；\npvalue、p.adjust和qvalue，p值、校正后p值和q值；\ngeneID和Count，富集到该GO term中的基因名称和数目。\n\nCodeGO_EA&lt;- clusterProfiler::enrichGO(gene = gene_all$ENTREZID,\n                                  OrgDb = \"org.Hs.eg.db\",\n                        \n                                  keyType = \"ENTREZID\",\n                                  ont = \"ALL\",\n                                  pvalueCutoff  =  0.05 ,\n                                  qvalueCutoff  =  0.05,\n                                  readable = F)\nGO_EA_tbl &lt;-  as_tibble(GO_EA)\n\n\n\n8.4.1 可视化\n\nCode#clusterProfiler 包里的一些默认作图方法，例如\nbarplot(GO_EA)  #富集柱形图\n\n\n\n\n\n\nCodedotplot(GO_EA)  #富集气泡图\n\n\n\n\n\n\n\n\nCodedat2 &lt;- GO_EA_tbl[GO_EA_tbl$pvalue&lt; 0.05, ]\ndat2$Negative_log10pvalue &lt;-  -log10(dat2$pvalue)\ndat2 = dat2[order( dat2$Negative_log10pvalue, decreasing = F ), ]\n\ndat2 &lt;- dat2 |&gt; \n    group_by(ONTOLOGY) |&gt; \n    slice_max(order_by = Negative_log10pvalue,n=10) |&gt; \n    ungroup()\n\n\nggplot(dat2,aes(x = Negative_log10pvalue, \n                y = reorder(Description,\n                            order(ONTOLOGY,Negative_log10pvalue,decreasing=F)),\n                fill = ONTOLOGY ))+ \n    geom_bar( stat = \"identity\" ) +\n    scale_x_continuous( name = \"-log10 pvalue\" ) +\n    scale_y_discrete( name = \"Pathway names\" ) +\n    theme_bw() + \n    theme( plot.title = element_text( hjust = 0.5 ) ) +\n    ggtitle( \"GO Pathway Enrichment\" )",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>富集分析</span>"
    ]
  },
  {
    "objectID": "PseudotimeAnalysis.html",
    "href": "PseudotimeAnalysis.html",
    "title": "\n9  伪时序分析\n",
    "section": "",
    "text": "monocle2\nhttps://cole-trapnell-lab.github.io/monocle3/\n\nCodeif(!require(monocle)) BiocManager::install(\"monocle\")\n#&gt; package 'graph' successfully unpacked and MD5 sums checked\n#&gt; package 'RBGL' successfully unpacked and MD5 sums checked\n#&gt; package 'RUnit' successfully unpacked and MD5 sums checked\n#&gt; package 'VGAM' successfully unpacked and MD5 sums checked\n#&gt; package 'DDRTree' successfully unpacked and MD5 sums checked\n#&gt; package 'combinat' successfully unpacked and MD5 sums checked\n#&gt; package 'fastICA' successfully unpacked and MD5 sums checked\n#&gt; package 'leidenbase' successfully unpacked and MD5 sums checked\n#&gt; package 'slam' successfully unpacked and MD5 sums checked\n#&gt; package 'biocViews' successfully unpacked and MD5 sums checked\n#&gt; package 'RANN' successfully unpacked and MD5 sums checked\n#&gt; package 'monocle' successfully unpacked and MD5 sums checked\n#&gt; \n#&gt; The downloaded binary packages are in\n#&gt;  C:\\Users\\WANGANLIN\\AppData\\Local\\Temp\\RtmpwXCpHn\\downloaded_packages\n\n\nhttps://lishensuo.github.io/posts/bioinfo/单细胞monocle轨迹分析\nhttps://www.jianshu.com/p/c402b6588e17",
    "crumbs": [
      "下游分析",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>伪时序分析</span>"
    ]
  },
  {
    "objectID": "sca.html",
    "href": "sca.html",
    "title": "单细胞分析",
    "section": "",
    "text": "上游分析\nCell Ranger 10XGenomics/cellranger https://www.nature.com/articles/ncomms14049",
    "crumbs": [
      "单细胞分析"
    ]
  },
  {
    "objectID": "sca.html#rna-seq",
    "href": "sca.html#rna-seq",
    "title": "单细胞分析",
    "section": "RNA-seq",
    "text": "RNA-seq\n\n\nhttps://doi.org/10.1038/nrg3068",
    "crumbs": [
      "单细胞分析"
    ]
  },
  {
    "objectID": "sca.html#packages",
    "href": "sca.html#packages",
    "title": "单细胞分析",
    "section": "Packages",
    "text": "Packages\n\nCode# 按需安装\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"scater\")\nBiocManager::install(\"scuttle\")\nBiocManager::install(\"DropletUtils\")\nBiocManager::install(\"zellkonverter\")\nBiocManager::install(\"LoomExperiment\")\nBiocManager::install(\"SingleCellExperiment\")\nBiocManager::install(\"scran\")\nBiocManager::install(\"scRNAseq\")\nBiocManager::install(\"batchelor\")\nBiocManager::install(\"robustbase\")\nBiocManager::install(\"org.Mm.eg.db\")\nBiocManager::install(\"EnsDb.Hsapiens.v86\")\nBiocManager::install(\"mbkmeans\")\nBiocManager::install(\"SingleR\")",
    "crumbs": [
      "单细胞分析"
    ]
  },
  {
    "objectID": "sca.html#session-information",
    "href": "sca.html#session-information",
    "title": "单细胞分析",
    "section": "Session Information",
    "text": "Session Information\n\nCodeSys.Date()\n#&gt; [1] \"2024-11-21\"\nBiocManager::version()\n#&gt; [1] '3.20'\nBiocManager::valid()\n#&gt; [1] TRUE\ndevtools::session_info()\n#&gt; ─ Session info ───────────────────────────────────────────────────────────────\n#&gt;  setting  value\n#&gt;  version  R version 4.4.1 (2024-06-14 ucrt)\n#&gt;  os       Windows 11 x64 (build 22631)\n#&gt;  system   x86_64, mingw32\n#&gt;  ui       RTerm\n#&gt;  language en\n#&gt;  collate  Chinese (Simplified)_China.utf8\n#&gt;  ctype    Chinese (Simplified)_China.utf8\n#&gt;  tz       Asia/Shanghai\n#&gt;  date     2024-11-21\n#&gt;  pandoc   3.4 @ D:/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)\n#&gt; \n#&gt; ─ Packages ───────────────────────────────────────────────────────────────────\n#&gt;  package     * version  date (UTC) lib source\n#&gt;  BiocManager   1.30.25  2024-08-28 [1] CRAN (R 4.4.1)\n#&gt;  cachem        1.1.0    2024-05-16 [1] CRAN (R 4.4.1)\n#&gt;  cellranger    1.1.0    2016-07-27 [1] CRAN (R 4.4.1)\n#&gt;  cli           3.6.3    2024-06-21 [1] CRAN (R 4.4.1)\n#&gt;  colorspace    2.1-1    2024-07-26 [1] CRAN (R 4.4.1)\n#&gt;  conflicted  * 1.2.0    2023-02-01 [1] CRAN (R 4.4.1)\n#&gt;  devtools      2.4.5    2022-10-11 [1] CRAN (R 4.4.1)\n#&gt;  digest        0.6.37   2024-08-19 [1] CRAN (R 4.4.1)\n#&gt;  dplyr       * 1.1.4    2023-11-17 [1] CRAN (R 4.4.1)\n#&gt;  ellipsis      0.3.2    2021-04-29 [1] CRAN (R 4.4.1)\n#&gt;  evaluate      1.0.1    2024-10-10 [1] CRAN (R 4.4.1)\n#&gt;  fansi         1.0.6    2023-12-08 [1] CRAN (R 4.4.1)\n#&gt;  fastmap       1.2.0    2024-05-15 [1] CRAN (R 4.4.1)\n#&gt;  forcats     * 1.0.0    2023-01-29 [1] CRAN (R 4.4.1)\n#&gt;  fs            1.6.5    2024-10-30 [1] CRAN (R 4.4.1)\n#&gt;  generics      0.1.3    2022-07-05 [1] CRAN (R 4.4.1)\n#&gt;  ggplot2     * 3.5.1    2024-04-23 [1] CRAN (R 4.4.1)\n#&gt;  glue          1.8.0    2024-09-30 [1] CRAN (R 4.4.1)\n#&gt;  gtable        0.3.6    2024-10-25 [1] CRAN (R 4.4.1)\n#&gt;  hms           1.1.3    2023-03-21 [1] CRAN (R 4.4.1)\n#&gt;  htmltools     0.5.8.1  2024-04-04 [1] CRAN (R 4.4.1)\n#&gt;  htmlwidgets   1.6.4    2023-12-06 [1] CRAN (R 4.4.1)\n#&gt;  httpuv        1.6.15   2024-03-26 [1] CRAN (R 4.4.1)\n#&gt;  jsonlite      1.8.9    2024-09-20 [1] CRAN (R 4.4.1)\n#&gt;  knitr         1.49     2024-11-08 [1] CRAN (R 4.4.2)\n#&gt;  later         1.3.2    2023-12-06 [1] CRAN (R 4.4.1)\n#&gt;  lifecycle     1.0.4    2023-11-07 [1] CRAN (R 4.4.1)\n#&gt;  lubridate   * 1.9.3    2023-09-27 [1] CRAN (R 4.4.1)\n#&gt;  magrittr      2.0.3    2022-03-30 [1] CRAN (R 4.4.1)\n#&gt;  memoise       2.0.1    2021-11-26 [1] CRAN (R 4.4.1)\n#&gt;  mime          0.12     2021-09-28 [1] CRAN (R 4.4.0)\n#&gt;  miniUI        0.1.1.1  2018-05-18 [1] CRAN (R 4.4.1)\n#&gt;  munsell       0.5.1    2024-04-01 [1] CRAN (R 4.4.1)\n#&gt;  pillar        1.9.0    2023-03-22 [1] CRAN (R 4.4.1)\n#&gt;  pkgbuild      1.4.5    2024-10-28 [1] CRAN (R 4.4.1)\n#&gt;  pkgconfig     2.0.3    2019-09-22 [1] CRAN (R 4.4.1)\n#&gt;  pkgload       1.4.0    2024-06-28 [1] CRAN (R 4.4.1)\n#&gt;  profvis       0.4.0    2024-09-20 [1] CRAN (R 4.4.1)\n#&gt;  promises      1.3.0    2024-04-05 [1] CRAN (R 4.4.1)\n#&gt;  purrr       * 1.0.2    2023-08-10 [1] CRAN (R 4.4.1)\n#&gt;  R6            2.5.1    2021-08-19 [1] CRAN (R 4.4.1)\n#&gt;  Rcpp          1.0.13-1 2024-11-02 [1] CRAN (R 4.4.1)\n#&gt;  readr       * 2.1.5    2024-01-10 [1] CRAN (R 4.4.1)\n#&gt;  readxl      * 1.4.3    2023-07-06 [1] CRAN (R 4.4.1)\n#&gt;  remotes       2.5.0    2024-03-17 [1] CRAN (R 4.4.1)\n#&gt;  rlang         1.1.4    2024-06-04 [1] CRAN (R 4.4.1)\n#&gt;  rmarkdown     2.29     2024-11-04 [1] CRAN (R 4.4.1)\n#&gt;  rstudioapi    0.17.1   2024-10-22 [1] CRAN (R 4.4.1)\n#&gt;  scales        1.3.0    2023-11-28 [1] CRAN (R 4.4.1)\n#&gt;  sessioninfo   1.2.2    2021-12-06 [1] CRAN (R 4.4.1)\n#&gt;  shiny         1.9.1    2024-08-01 [1] CRAN (R 4.4.1)\n#&gt;  showtext    * 0.9-7    2024-03-02 [1] CRAN (R 4.4.1)\n#&gt;  showtextdb  * 3.0      2020-06-04 [1] CRAN (R 4.4.1)\n#&gt;  stringi       1.8.4    2024-05-06 [1] CRAN (R 4.4.0)\n#&gt;  stringr     * 1.5.1    2023-11-14 [1] CRAN (R 4.4.1)\n#&gt;  sysfonts    * 0.8.9    2024-03-02 [1] CRAN (R 4.4.1)\n#&gt;  tibble      * 3.2.1    2023-03-20 [1] CRAN (R 4.4.1)\n#&gt;  tidyr       * 1.3.1    2024-01-24 [1] CRAN (R 4.4.1)\n#&gt;  tidyselect    1.2.1    2024-03-11 [1] CRAN (R 4.4.1)\n#&gt;  tidyverse   * 2.0.0    2023-02-22 [1] CRAN (R 4.4.1)\n#&gt;  timechange    0.3.0    2024-01-18 [1] CRAN (R 4.4.1)\n#&gt;  tzdb          0.4.0    2023-05-12 [1] CRAN (R 4.4.1)\n#&gt;  urlchecker    1.0.1    2021-11-30 [1] CRAN (R 4.4.1)\n#&gt;  usethis       3.0.0    2024-07-29 [1] CRAN (R 4.4.1)\n#&gt;  utf8          1.2.4    2023-10-22 [1] CRAN (R 4.4.1)\n#&gt;  vctrs         0.6.5    2023-12-01 [1] CRAN (R 4.4.1)\n#&gt;  withr         3.0.2    2024-10-28 [1] CRAN (R 4.4.1)\n#&gt;  writexl     * 1.5.1    2024-10-04 [1] CRAN (R 4.4.1)\n#&gt;  xfun          0.49     2024-10-31 [1] CRAN (R 4.4.1)\n#&gt;  xtable        1.8-4    2019-04-21 [1] CRAN (R 4.4.1)\n#&gt;  yaml          2.3.10   2024-07-26 [1] CRAN (R 4.4.1)\n#&gt; \n#&gt;  [1] D:/R-4.4.1/library\n#&gt; \n#&gt; ──────────────────────────────────────────────────────────────────────────────",
    "crumbs": [
      "单细胞分析"
    ]
  }
]